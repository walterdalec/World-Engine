/*! For license information please see main.8ea19e8b.js.LICENSE.txt */
(()=>{"use strict";var e={43:(e,t,n)=>{e.exports=n(202)},153:(e,t,n)=>{var r=n(43),a=Symbol.for("react.element"),i=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,i={},c=null,d=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)o.call(t,r)&&!l.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:a,type:e,key:c,ref:d,props:i,_owner:s.current}}t.Fragment=i,t.jsx=c,t.jsxs=c},202:(e,t)=>{var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},f=Object.assign,m={};function y(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||g}function v(){}function b(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||g}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=y.prototype;var x=b.prototype=new v;x.constructor=b,f(x,y.prototype),x.isPureReactComponent=!0;var w=Array.isArray,S=Object.prototype.hasOwnProperty,k={current:null},C={key:!0,ref:!0,__self:!0,__source:!0};function j(e,t,r){var a,i={},o=null,s=null;if(null!=t)for(a in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(o=""+t.key),t)S.call(t,a)&&!C.hasOwnProperty(a)&&(i[a]=t[a]);var l=arguments.length-2;if(1===l)i.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];i.children=c}if(e&&e.defaultProps)for(a in l=e.defaultProps)void 0===i[a]&&(i[a]=l[a]);return{$$typeof:n,type:e,key:o,ref:s,props:i,_owner:k.current}}function T(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var E=/\/+/g;function z(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function M(e,t,a,i,o){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l=!1;if(null===e)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return o=o(l=e),e=""===i?"."+z(l,0):i,w(o)?(a="",null!=e&&(a=e.replace(E,"$&/")+"/"),M(o,t,a,"",function(e){return e})):null!=o&&(T(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,a+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(E,"$&/")+"/")+e)),t.push(o)),1;if(l=0,i=""===i?".":i+":",w(e))for(var c=0;c<e.length;c++){var d=i+z(s=e[c],c);l+=M(s,t,a,d,o)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),c=0;!(s=e.next()).done;)l+=M(s=s.value,t,a,d=i+z(s,c++),o);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function I(e,t,n){if(null==e)return e;var r=[],a=0;return M(e,r,"","",function(e){return t.call(n,e,a++)}),r}function _(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var P={current:null},L={transition:null},R={ReactCurrentDispatcher:P,ReactCurrentBatchConfig:L,ReactCurrentOwner:k};function A(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:I,forEach:function(e,t,n){I(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return I(e,function(){t++}),t},toArray:function(e){return I(e,function(e){return e})||[]},only:function(e){if(!T(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=a,t.Profiler=o,t.PureComponent=b,t.StrictMode=i,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R,t.act=A,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=f({},e.props),i=e.key,o=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,s=k.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)S.call(t,c)&&!C.hasOwnProperty(c)&&(a[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)a.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];a.children=l}return{$$typeof:n,type:e.type,key:i,ref:o,props:a,_owner:s}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=j,t.createFactory=function(e){var t=j.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=T,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:_}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=L.transition;L.transition={};try{e()}finally{L.transition=t}},t.unstable_act=A,t.useCallback=function(e,t){return P.current.useCallback(e,t)},t.useContext=function(e){return P.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return P.current.useDeferredValue(e)},t.useEffect=function(e,t){return P.current.useEffect(e,t)},t.useId=function(){return P.current.useId()},t.useImperativeHandle=function(e,t,n){return P.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return P.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return P.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return P.current.useMemo(e,t)},t.useReducer=function(e,t,n){return P.current.useReducer(e,t,n)},t.useRef=function(e){return P.current.useRef(e)},t.useState=function(e){return P.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return P.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return P.current.useTransition()},t.version="18.3.1"},234:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,a=e[r];if(!(0<i(a,t)))break e;e[r]=t,e[n]=a,n=r}}function r(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length,o=a>>>1;r<o;){var s=2*(r+1)-1,l=e[s],c=s+1,d=e[c];if(0>i(l,n))c<a&&0>i(d,l)?(e[r]=d,e[c]=n,r=c):(e[r]=l,e[s]=n,r=s);else{if(!(c<a&&0>i(d,n)))break e;e[r]=d,e[c]=n,r=c}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var c=[],d=[],u=1,h=null,p=3,g=!1,f=!1,m=!1,y="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=r(d);null!==t;){if(null===t.callback)a(d);else{if(!(t.startTime<=e))break;a(d),t.sortIndex=t.expirationTime,n(c,t)}t=r(d)}}function w(e){if(m=!1,x(e),!f)if(null!==r(c))f=!0,L(S);else{var t=r(d);null!==t&&R(w,t.startTime-e)}}function S(e,n){f=!1,m&&(m=!1,v(T),T=-1),g=!0;var i=p;try{for(x(n),h=r(c);null!==h&&(!(h.expirationTime>n)||e&&!M());){var o=h.callback;if("function"===typeof o){h.callback=null,p=h.priorityLevel;var s=o(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?h.callback=s:h===r(c)&&a(c),x(n)}else a(c);h=r(c)}if(null!==h)var l=!0;else{var u=r(d);null!==u&&R(w,u.startTime-n),l=!1}return l}finally{h=null,p=i,g=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var k,C=!1,j=null,T=-1,E=5,z=-1;function M(){return!(t.unstable_now()-z<E)}function I(){if(null!==j){var e=t.unstable_now();z=e;var n=!0;try{n=j(!0,e)}finally{n?k():(C=!1,j=null)}}else C=!1}if("function"===typeof b)k=function(){b(I)};else if("undefined"!==typeof MessageChannel){var _=new MessageChannel,P=_.port2;_.port1.onmessage=I,k=function(){P.postMessage(null)}}else k=function(){y(I,0)};function L(e){j=e,C||(C=!0,k())}function R(e,n){T=y(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){f||g||(f=!0,L(S))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,a,i){var o=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?o+i:o:i=o,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:u++,callback:a,priorityLevel:e,startTime:i,expirationTime:s=i+s,sortIndex:-1},i>o?(e.sortIndex=i,n(d,e),null===r(c)&&e===r(d)&&(m?(v(T),T=-1):m=!0,R(w,i-o))):(e.sortIndex=s,n(c,e),f||g||(f=!0,L(S))),e},t.unstable_shouldYield=M,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},391:(e,t,n)=>{var r=n(950);t.H=r.createRoot,r.hydrateRoot},579:(e,t,n)=>{e.exports=n(153)},730:(e,t,n)=>{var r=n(43),a=n(853);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,s={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(s[e]=t,e=0;e<t.length;e++)o.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},g={};function f(e,t,n,r,a,i,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){m[e]=new f(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];m[t]=new f(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){m[e]=new f(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){m[e]=new f(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){m[e]=new f(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){m[e]=new f(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){m[e]=new f(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){m[e]=new f(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){m[e]=new f(e,5,!1,e.toLowerCase(),null,!1,!1)});var y=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function b(e,t,n,r){var a=m.hasOwnProperty(t)?m[t]:null;(null!==a?0!==a.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,a,r)&&(n=null),r||null===a?function(e){return!!u.call(g,e)||!u.call(p,e)&&(h.test(e)?g[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=null===n?3!==a.type&&"":n:(t=a.attributeName,r=a.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(y,v);m[t]=new f(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(y,v);m[t]=new f(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(y,v);m[t]=new f(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){m[e]=new f(e,1,!1,e.toLowerCase(),null,!1,!1)}),m.xlinkHref=new f("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){m[e]=new f(e,1,!1,e.toLowerCase(),null,!0,!0)});var x=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),S=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),j=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),E=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),_=Symbol.for("react.memo"),P=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var L=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var R=Symbol.iterator;function A(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=R&&e[R]||e["@@iterator"])?e:null}var N,B=Object.assign;function D(e){if(void 0===N)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);N=t&&t[1]||""}return"\n"+N+e}var O=!1;function F(e,t){if(!e||O)return"";O=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var a=c.stack.split("\n"),i=r.stack.split("\n"),o=a.length-1,s=i.length-1;1<=o&&0<=s&&a[o]!==i[s];)s--;for(;1<=o&&0<=s;o--,s--)if(a[o]!==i[s]){if(1!==o||1!==s)do{if(o--,0>--s||a[o]!==i[s]){var l="\n"+a[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=s);break}}}finally{O=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?D(e):""}function W(e){switch(e.tag){case 5:return D(e.type);case 16:return D("Lazy");case 13:return D("Suspense");case 19:return D("SuspenseList");case 0:case 2:case 15:return e=F(e.type,!1);case 11:return e=F(e.type.render,!1);case 1:return e=F(e.type,!0);default:return""}}function H(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case k:return"Fragment";case S:return"Portal";case j:return"Profiler";case C:return"StrictMode";case M:return"Suspense";case I:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case E:return(e.displayName||"Context")+".Consumer";case T:return(e._context.displayName||"Context")+".Provider";case z:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case _:return null!==(t=e.displayName||null)?t:H(e.type)||"Memo";case P:t=e._payload,e=e._init;try{return H(e(t))}catch(n){}}return null}function q(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return H(t);case 8:return t===C?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function U(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function G(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function V(e){e._valueTracker||(e._valueTracker=function(e){var t=G(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function Y(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=G(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function K(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function J(e,t){var n=t.checked;return B({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function X(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=U(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function $(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function Q(e,t){$(e,t);var n=U(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,U(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&K(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+U(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return B({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(i(92));if(te(n)){if(1<n.length)throw Error(i(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:U(n)}}function ie(e,t){var n=U(t.value),r=U(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,de,ue=(de=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction(function(){return de(e,t)})}:de);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ge=["Webkit","ms","Moz","O"];function fe(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function me(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),a=fe(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}Object.keys(pe).forEach(function(e){ge.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]})});var ye=B({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Se=null,ke=null,Ce=null;function je(e){if(e=ba(e)){if("function"!==typeof Se)throw Error(i(280));var t=e.stateNode;t&&(t=wa(t),Se(e.stateNode,e.type,t))}}function Te(e){ke?Ce?Ce.push(e):Ce=[e]:ke=e}function Ee(){if(ke){var e=ke,t=Ce;if(Ce=ke=null,je(e),t)for(e=0;e<t.length;e++)je(t[e])}}function ze(e,t){return e(t)}function Me(){}var Ie=!1;function _e(e,t,n){if(Ie)return e(t,n);Ie=!0;try{return ze(e,t,n)}finally{Ie=!1,(null!==ke||null!==Ce)&&(Me(),Ee())}}function Pe(e,t){var n=e.stateNode;if(null===n)return null;var r=wa(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var Le=!1;if(d)try{var Re={};Object.defineProperty(Re,"passive",{get:function(){Le=!0}}),window.addEventListener("test",Re,Re),window.removeEventListener("test",Re,Re)}catch(de){Le=!1}function Ae(e,t,n,r,a,i,o,s,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(d){this.onError(d)}}var Ne=!1,Be=null,De=!1,Oe=null,Fe={onError:function(e){Ne=!0,Be=e}};function We(e,t,n,r,a,i,o,s,l){Ne=!1,Be=null,Ae.apply(Fe,arguments)}function He(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function qe(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ue(e){if(He(e)!==e)throw Error(i(188))}function Ge(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=He(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var o=a.alternate;if(null===o){if(null!==(r=a.return)){n=r;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===n)return Ue(a),e;if(o===r)return Ue(a),t;o=o.sibling}throw Error(i(188))}if(n.return!==r.return)n=a,r=o;else{for(var s=!1,l=a.child;l;){if(l===n){s=!0,n=a,r=o;break}if(l===r){s=!0,r=a,n=o;break}l=l.sibling}if(!s){for(l=o.child;l;){if(l===n){s=!0,n=o,r=a;break}if(l===r){s=!0,r=o,n=a;break}l=l.sibling}if(!s)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(e))?Ve(e):null}function Ve(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ve(e);if(null!==t)return t;e=e.sibling}return null}var Ye=a.unstable_scheduleCallback,Ke=a.unstable_cancelCallback,Je=a.unstable_shouldYield,Xe=a.unstable_requestPaint,$e=a.unstable_now,Qe=a.unstable_getCurrentPriorityLevel,Ze=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,nt=a.unstable_LowPriority,rt=a.unstable_IdlePriority,at=null,it=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/lt|0)|0},st=Math.log,lt=Math.LN2;var ct=64,dt=4194304;function ut(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,a=e.suspendedLanes,i=e.pingedLanes,o=268435455&n;if(0!==o){var s=o&~a;0!==s?r=ut(s):0!==(i&=o)&&(r=ut(i))}else 0!==(o=n&~a)?r=ut(o):0!==i&&(r=ut(i));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&a)&&((a=r&-r)>=(i=t&-t)||16===a&&0!==(4194240&i)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)a=1<<(n=31-ot(t)),r|=e[n],t&=~a;return r}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function gt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function ft(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function mt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function yt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function vt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ot(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var bt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,St,kt,Ct,jt,Tt=!1,Et=[],zt=null,Mt=null,It=null,_t=new Map,Pt=new Map,Lt=[],Rt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function At(e,t){switch(e){case"focusin":case"focusout":zt=null;break;case"dragenter":case"dragleave":Mt=null;break;case"mouseover":case"mouseout":It=null;break;case"pointerover":case"pointerout":_t.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pt.delete(t.pointerId)}}function Nt(e,t,n,r,a,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},null!==t&&(null!==(t=ba(t))&&St(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Bt(e){var t=va(e.target);if(null!==t){var n=He(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=qe(n)))return e.blockedOn=t,void jt(e.priority,function(){kt(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Dt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Jt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ba(n))&&St(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);xe=r,n.target.dispatchEvent(r),xe=null,t.shift()}return!0}function Ot(e,t,n){Dt(e)&&n.delete(t)}function Ft(){Tt=!1,null!==zt&&Dt(zt)&&(zt=null),null!==Mt&&Dt(Mt)&&(Mt=null),null!==It&&Dt(It)&&(It=null),_t.forEach(Ot),Pt.forEach(Ot)}function Wt(e,t){e.blockedOn===t&&(e.blockedOn=null,Tt||(Tt=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Ft)))}function Ht(e){function t(t){return Wt(t,e)}if(0<Et.length){Wt(Et[0],e);for(var n=1;n<Et.length;n++){var r=Et[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==zt&&Wt(zt,e),null!==Mt&&Wt(Mt,e),null!==It&&Wt(It,e),_t.forEach(t),Pt.forEach(t),n=0;n<Lt.length;n++)(r=Lt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Lt.length&&null===(n=Lt[0]).blockedOn;)Bt(n),null===n.blockedOn&&Lt.shift()}var qt=x.ReactCurrentBatchConfig,Ut=!0;function Gt(e,t,n,r){var a=bt,i=qt.transition;qt.transition=null;try{bt=1,Yt(e,t,n,r)}finally{bt=a,qt.transition=i}}function Vt(e,t,n,r){var a=bt,i=qt.transition;qt.transition=null;try{bt=4,Yt(e,t,n,r)}finally{bt=a,qt.transition=i}}function Yt(e,t,n,r){if(Ut){var a=Jt(e,t,n,r);if(null===a)Ur(e,t,r,Kt,n),At(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return zt=Nt(zt,e,t,n,r,a),!0;case"dragenter":return Mt=Nt(Mt,e,t,n,r,a),!0;case"mouseover":return It=Nt(It,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return _t.set(i,Nt(_t.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,Pt.set(i,Nt(Pt.get(i)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(At(e,r),4&t&&-1<Rt.indexOf(e)){for(;null!==a;){var i=ba(a);if(null!==i&&wt(i),null===(i=Jt(e,t,n,r))&&Ur(e,t,r,Kt,n),i===a)break;a=i}null!==a&&r.stopPropagation()}else Ur(e,t,r,null,n)}}var Kt=null;function Jt(e,t,n,r){if(Kt=null,null!==(e=va(e=we(r))))if(null===(t=He(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=qe(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Kt=e,null}function Xt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qe()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var $t=null,Qt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Qt,r=n.length,a="value"in $t?$t.value:$t.textContent,i=a.length;for(e=0;e<r&&n[e]===a[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===a[i-t];t++);return Zt=a.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,a,i){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(a):a[o]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return B(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,sn,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dn=an(cn),un=B({},cn,{view:0,detail:0}),hn=an(un),pn=B({},un,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:jn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(on=e.screenX-ln.screenX,sn=e.screenY-ln.screenY):sn=on=0,ln=e),on)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),gn=an(pn),fn=an(B({},pn,{dataTransfer:0})),mn=an(B({},un,{relatedTarget:0})),yn=an(B({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),vn=B({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=an(vn),xn=an(B({},cn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Sn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=kn[e])&&!!t[e]}function jn(){return Cn}var Tn=B({},un,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Sn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:jn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),En=an(Tn),zn=an(B({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Mn=an(B({},un,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:jn})),In=an(B({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),_n=B({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Pn=an(_n),Ln=[9,13,27,32],Rn=d&&"CompositionEvent"in window,An=null;d&&"documentMode"in document&&(An=document.documentMode);var Nn=d&&"TextEvent"in window&&!An,Bn=d&&(!Rn||An&&8<An&&11>=An),Dn=String.fromCharCode(32),On=!1;function Fn(e,t){switch(e){case"keyup":return-1!==Ln.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Hn=!1;var qn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Un(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!qn[e.type]:"textarea"===t}function Gn(e,t,n,r){Te(r),0<(t=Vr(t,"onChange")).length&&(n=new dn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Vn=null,Yn=null;function Kn(e){Dr(e,0)}function Jn(e){if(Y(xa(e)))return e}function Xn(e,t){if("change"===e)return t}var $n=!1;if(d){var Qn;if(d){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}Qn=Zn}else Qn=!1;$n=Qn&&(!document.documentMode||9<document.documentMode)}function tr(){Vn&&(Vn.detachEvent("onpropertychange",nr),Yn=Vn=null)}function nr(e){if("value"===e.propertyName&&Jn(Yn)){var t=[];Gn(t,Yn,e,we(e)),_e(Kn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Yn=n,(Vn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ar(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Jn(Yn)}function ir(e,t){if("click"===e)return Jn(t)}function or(e,t){if("input"===e||"change"===e)return Jn(t)}var sr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(sr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!u.call(t,a)||!sr(e[a],t[a]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dr(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function ur(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ur(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=K();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=K((e=t.contentWindow).document)}return t}function pr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function gr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&ur(n.ownerDocument.documentElement,n)){if(null!==r&&pr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=void 0===r.end?i:Math.min(r.end,a),!e.extend&&i>r&&(a=r,r=i,i=a),a=dr(n,i);var o=dr(n,r);a&&o&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var fr=d&&"documentMode"in document&&11>=document.documentMode,mr=null,yr=null,vr=null,br=!1;function xr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==mr||mr!==K(r)||("selectionStart"in(r=mr)&&pr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},vr&&lr(vr,r)||(vr=r,0<(r=Vr(yr,"onSelect")).length&&(t=new dn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=mr)))}function wr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Sr={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},kr={},Cr={};function jr(e){if(kr[e])return kr[e];if(!Sr[e])return e;var t,n=Sr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Cr)return kr[e]=n[t];return e}d&&(Cr=document.createElement("div").style,"AnimationEvent"in window||(delete Sr.animationend.animation,delete Sr.animationiteration.animation,delete Sr.animationstart.animation),"TransitionEvent"in window||delete Sr.transitionend.transition);var Tr=jr("animationend"),Er=jr("animationiteration"),zr=jr("animationstart"),Mr=jr("transitionend"),Ir=new Map,_r="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pr(e,t){Ir.set(e,t),l(t,[e])}for(var Lr=0;Lr<_r.length;Lr++){var Rr=_r[Lr];Pr(Rr.toLowerCase(),"on"+(Rr[0].toUpperCase()+Rr.slice(1)))}Pr(Tr,"onAnimationEnd"),Pr(Er,"onAnimationIteration"),Pr(zr,"onAnimationStart"),Pr("dblclick","onDoubleClick"),Pr("focusin","onFocus"),Pr("focusout","onBlur"),Pr(Mr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ar="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Nr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ar));function Br(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,a,o,s,l,c){if(We.apply(this,arguments),Ne){if(!Ne)throw Error(i(198));var d=Be;Ne=!1,Be=null,De||(De=!0,Oe=d)}}(r,t,void 0,e),e.currentTarget=null}function Dr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var o=r.length-1;0<=o;o--){var s=r[o],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==i&&a.isPropagationStopped())break e;Br(a,s,c),i=l}else for(o=0;o<r.length;o++){if(l=(s=r[o]).instance,c=s.currentTarget,s=s.listener,l!==i&&a.isPropagationStopped())break e;Br(a,s,c),i=l}}}if(De)throw e=Oe,De=!1,Oe=null,e}function Or(e,t){var n=t[fa];void 0===n&&(n=t[fa]=new Set);var r=e+"__bubble";n.has(r)||(qr(t,e,2,!1),n.add(r))}function Fr(e,t,n){var r=0;t&&(r|=4),qr(n,e,r,t)}var Wr="_reactListening"+Math.random().toString(36).slice(2);function Hr(e){if(!e[Wr]){e[Wr]=!0,o.forEach(function(t){"selectionchange"!==t&&(Nr.has(t)||Fr(t,!1,e),Fr(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Wr]||(t[Wr]=!0,Fr("selectionchange",!1,t))}}function qr(e,t,n,r){switch(Xt(t)){case 1:var a=Gt;break;case 4:a=Vt;break;default:a=Yt}n=a.bind(null,t,n,e),a=void 0,!Le||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Ur(e,t,n,r,a){var i=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var s=r.stateNode.containerInfo;if(s===a||8===s.nodeType&&s.parentNode===a)break;if(4===o)for(o=r.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===a||8===l.nodeType&&l.parentNode===a))return;o=o.return}for(;null!==s;){if(null===(o=va(s)))return;if(5===(l=o.tag)||6===l){r=i=o;continue e}s=s.parentNode}}r=r.return}_e(function(){var r=i,a=we(n),o=[];e:{var s=Ir.get(e);if(void 0!==s){var l=dn,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=En;break;case"focusin":c="focus",l=mn;break;case"focusout":c="blur",l=mn;break;case"beforeblur":case"afterblur":l=mn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=gn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=fn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Mn;break;case Tr:case Er:case zr:l=yn;break;case Mr:l=In;break;case"scroll":l=hn;break;case"wheel":l=Pn;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=zn}var d=0!==(4&t),u=!d&&"scroll"===e,h=d?null!==s?s+"Capture":null:s;d=[];for(var p,g=r;null!==g;){var f=(p=g).stateNode;if(5===p.tag&&null!==f&&(p=f,null!==h&&(null!=(f=Pe(g,h))&&d.push(Gr(g,f,p)))),u)break;g=g.return}0<d.length&&(s=new l(s,c,null,n,a),o.push({event:s,listeners:d}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===xe||!(c=n.relatedTarget||n.fromElement)||!va(c)&&!c[ga])&&(l||s)&&(s=a.window===a?a:(s=a.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?va(c):null)&&(c!==(u=He(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(d=gn,f="onMouseLeave",h="onMouseEnter",g="mouse","pointerout"!==e&&"pointerover"!==e||(d=zn,f="onPointerLeave",h="onPointerEnter",g="pointer"),u=null==l?s:xa(l),p=null==c?s:xa(c),(s=new d(f,g+"leave",l,n,a)).target=u,s.relatedTarget=p,f=null,va(a)===r&&((d=new d(h,g+"enter",c,n,a)).target=p,d.relatedTarget=u,f=d),u=f,l&&c)e:{for(h=c,g=0,p=d=l;p;p=Yr(p))g++;for(p=0,f=h;f;f=Yr(f))p++;for(;0<g-p;)d=Yr(d),g--;for(;0<p-g;)h=Yr(h),p--;for(;g--;){if(d===h||null!==h&&d===h.alternate)break e;d=Yr(d),h=Yr(h)}d=null}else d=null;null!==l&&Kr(o,s,l,d,!1),null!==c&&null!==u&&Kr(o,u,c,d,!0)}if("select"===(l=(s=r?xa(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var m=Xn;else if(Un(s))if($n)m=or;else{m=ar;var y=rr}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(m=ir);switch(m&&(m=m(e,r))?Gn(o,m,n,a):(y&&y(e,s,r),"focusout"===e&&(y=s._wrapperState)&&y.controlled&&"number"===s.type&&ee(s,"number",s.value)),y=r?xa(r):window,e){case"focusin":(Un(y)||"true"===y.contentEditable)&&(mr=y,yr=r,vr=null);break;case"focusout":vr=yr=mr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,xr(o,n,a);break;case"selectionchange":if(fr)break;case"keydown":case"keyup":xr(o,n,a)}var v;if(Rn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Hn?Fn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Bn&&"ko"!==n.locale&&(Hn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Hn&&(v=en()):(Qt="value"in($t=a)?$t.value:$t.textContent,Hn=!0)),0<(y=Vr(r,b)).length&&(b=new xn(b,e,null,n,a),o.push({event:b,listeners:y}),v?b.data=v:null!==(v=Wn(n))&&(b.data=v))),(v=Nn?function(e,t){switch(e){case"compositionend":return Wn(t);case"keypress":return 32!==t.which?null:(On=!0,Dn);case"textInput":return(e=t.data)===Dn&&On?null:e;default:return null}}(e,n):function(e,t){if(Hn)return"compositionend"===e||!Rn&&Fn(e,t)?(e=en(),Zt=Qt=$t=null,Hn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Bn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Vr(r,"onBeforeInput")).length&&(a=new xn("onBeforeInput","beforeinput",null,n,a),o.push({event:a,listeners:r}),a.data=v))}Dr(o,t)})}function Gr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Vr(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,i=a.stateNode;5===a.tag&&null!==i&&(a=i,null!=(i=Pe(e,n))&&r.unshift(Gr(e,i,a)),null!=(i=Pe(e,t))&&r.push(Gr(e,i,a))),e=e.return}return r}function Yr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Kr(e,t,n,r,a){for(var i=t._reactName,o=[];null!==n&&n!==r;){var s=n,l=s.alternate,c=s.stateNode;if(null!==l&&l===r)break;5===s.tag&&null!==c&&(s=c,a?null!=(l=Pe(n,i))&&o.unshift(Gr(n,l,s)):a||null!=(l=Pe(n,i))&&o.push(Gr(n,l,s))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Jr=/\r\n?/g,Xr=/\u0000|\uFFFD/g;function $r(e){return("string"===typeof e?e:""+e).replace(Jr,"\n").replace(Xr,"")}function Qr(e,t,n){if(t=$r(t),$r(e)!==t&&n)throw Error(i(425))}function Zr(){}var ea=null,ta=null;function na(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ra="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,ia="function"===typeof Promise?Promise:void 0,oa="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ia?function(e){return ia.resolve(null).then(e).catch(sa)}:ra;function sa(e){setTimeout(function(){throw e})}function la(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0===r)return e.removeChild(a),void Ht(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=a}while(n);Ht(t)}function ca(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function da(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ua=Math.random().toString(36).slice(2),ha="__reactFiber$"+ua,pa="__reactProps$"+ua,ga="__reactContainer$"+ua,fa="__reactEvents$"+ua,ma="__reactListeners$"+ua,ya="__reactHandles$"+ua;function va(e){var t=e[ha];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ga]||n[ha]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=da(e);null!==e;){if(n=e[ha])return n;e=da(e)}return t}n=(e=n).parentNode}return null}function ba(e){return!(e=e[ha]||e[ga])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function xa(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function wa(e){return e[pa]||null}var Sa=[],ka=-1;function Ca(e){return{current:e}}function ja(e){0>ka||(e.current=Sa[ka],Sa[ka]=null,ka--)}function Ta(e,t){ka++,Sa[ka]=e.current,e.current=t}var Ea={},za=Ca(Ea),Ma=Ca(!1),Ia=Ea;function _a(e,t){var n=e.type.contextTypes;if(!n)return Ea;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a,i={};for(a in n)i[a]=t[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Pa(e){return null!==(e=e.childContextTypes)&&void 0!==e}function La(){ja(Ma),ja(za)}function Ra(e,t,n){if(za.current!==Ea)throw Error(i(168));Ta(za,t),Ta(Ma,n)}function Aa(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in t))throw Error(i(108,q(e)||"Unknown",a));return B({},n,r)}function Na(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ea,Ia=za.current,Ta(za,e),Ta(Ma,Ma.current),!0}function Ba(e,t,n){var r=e.stateNode;if(!r)throw Error(i(169));n?(e=Aa(e,t,Ia),r.__reactInternalMemoizedMergedChildContext=e,ja(Ma),ja(za),Ta(za,e)):ja(Ma),Ta(Ma,n)}var Da=null,Oa=!1,Fa=!1;function Wa(e){null===Da?Da=[e]:Da.push(e)}function Ha(){if(!Fa&&null!==Da){Fa=!0;var e=0,t=bt;try{var n=Da;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Da=null,Oa=!1}catch(a){throw null!==Da&&(Da=Da.slice(e+1)),Ye(Ze,Ha),a}finally{bt=t,Fa=!1}}return null}var qa=[],Ua=0,Ga=null,Va=0,Ya=[],Ka=0,Ja=null,Xa=1,$a="";function Qa(e,t){qa[Ua++]=Va,qa[Ua++]=Ga,Ga=e,Va=t}function Za(e,t,n){Ya[Ka++]=Xa,Ya[Ka++]=$a,Ya[Ka++]=Ja,Ja=e;var r=Xa;e=$a;var a=32-ot(r)-1;r&=~(1<<a),n+=1;var i=32-ot(t)+a;if(30<i){var o=a-a%5;i=(r&(1<<o)-1).toString(32),r>>=o,a-=o,Xa=1<<32-ot(t)+a|n<<a|r,$a=i+e}else Xa=1<<i|n<<a|r,$a=e}function ei(e){null!==e.return&&(Qa(e,1),Za(e,1,0))}function ti(e){for(;e===Ga;)Ga=qa[--Ua],qa[Ua]=null,Va=qa[--Ua],qa[Ua]=null;for(;e===Ja;)Ja=Ya[--Ka],Ya[Ka]=null,$a=Ya[--Ka],Ya[Ka]=null,Xa=Ya[--Ka],Ya[Ka]=null}var ni=null,ri=null,ai=!1,ii=null;function oi(e,t){var n=_c(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function si(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ni=e,ri=ca(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ni=e,ri=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Ja?{id:Xa,overflow:$a}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=_c(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ni=e,ri=null,!0);default:return!1}}function li(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ci(e){if(ai){var t=ri;if(t){var n=t;if(!si(e,t)){if(li(e))throw Error(i(418));t=ca(n.nextSibling);var r=ni;t&&si(e,t)?oi(r,n):(e.flags=-4097&e.flags|2,ai=!1,ni=e)}}else{if(li(e))throw Error(i(418));e.flags=-4097&e.flags|2,ai=!1,ni=e}}}function di(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ni=e}function ui(e){if(e!==ni)return!1;if(!ai)return di(e),ai=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!na(e.type,e.memoizedProps)),t&&(t=ri)){if(li(e))throw hi(),Error(i(418));for(;t;)oi(e,t),t=ca(t.nextSibling)}if(di(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ri=ca(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ri=null}}else ri=ni?ca(e.stateNode.nextSibling):null;return!0}function hi(){for(var e=ri;e;)e=ca(e.nextSibling)}function pi(){ri=ni=null,ai=!1}function gi(e){null===ii?ii=[e]:ii.push(e)}var fi=x.ReactCurrentBatchConfig;function mi(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var r=n.stateNode}if(!r)throw Error(i(147,e));var a=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=a.refs;null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function yi(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function vi(e){return(0,e._init)(e._payload)}function bi(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Lc(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Bc(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function c(e,t,n,r){var i=n.type;return i===k?u(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===P&&vi(i)===t.type)?((r=a(t,n.props)).ref=mi(e,t,n),r.return=e,r):((r=Rc(n.type,n.key,n.props,null,e.mode,r)).ref=mi(e,t,n),r.return=e,r)}function d(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Dc(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function u(e,t,n,r,i){return null===t||7!==t.tag?((t=Ac(n,e.mode,r,i)).return=e,t):((t=a(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Bc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Rc(t.type,t.key,t.props,null,e.mode,n)).ref=mi(e,null,t),n.return=e,n;case S:return(t=Dc(t,e.mode,n)).return=e,t;case P:return h(e,(0,t._init)(t._payload),n)}if(te(t)||A(t))return(t=Ac(t,e.mode,n,null)).return=e,t;yi(e,t)}return null}function p(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==a?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===a?c(e,t,n,r):null;case S:return n.key===a?d(e,t,n,r):null;case P:return p(e,t,(a=n._init)(n._payload),r)}if(te(n)||A(n))return null!==a?null:u(e,t,n,r,null);yi(e,n)}return null}function g(e,t,n,r,a){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return c(t,e=e.get(null===r.key?n:r.key)||null,r,a);case S:return d(t,e=e.get(null===r.key?n:r.key)||null,r,a);case P:return g(e,t,n,(0,r._init)(r._payload),a)}if(te(r)||A(r))return u(t,e=e.get(n)||null,r,a,null);yi(t,r)}return null}function f(a,i,s,l){for(var c=null,d=null,u=i,f=i=0,m=null;null!==u&&f<s.length;f++){u.index>f?(m=u,u=null):m=u.sibling;var y=p(a,u,s[f],l);if(null===y){null===u&&(u=m);break}e&&u&&null===y.alternate&&t(a,u),i=o(y,i,f),null===d?c=y:d.sibling=y,d=y,u=m}if(f===s.length)return n(a,u),ai&&Qa(a,f),c;if(null===u){for(;f<s.length;f++)null!==(u=h(a,s[f],l))&&(i=o(u,i,f),null===d?c=u:d.sibling=u,d=u);return ai&&Qa(a,f),c}for(u=r(a,u);f<s.length;f++)null!==(m=g(u,a,f,s[f],l))&&(e&&null!==m.alternate&&u.delete(null===m.key?f:m.key),i=o(m,i,f),null===d?c=m:d.sibling=m,d=m);return e&&u.forEach(function(e){return t(a,e)}),ai&&Qa(a,f),c}function m(a,s,l,c){var d=A(l);if("function"!==typeof d)throw Error(i(150));if(null==(l=d.call(l)))throw Error(i(151));for(var u=d=null,f=s,m=s=0,y=null,v=l.next();null!==f&&!v.done;m++,v=l.next()){f.index>m?(y=f,f=null):y=f.sibling;var b=p(a,f,v.value,c);if(null===b){null===f&&(f=y);break}e&&f&&null===b.alternate&&t(a,f),s=o(b,s,m),null===u?d=b:u.sibling=b,u=b,f=y}if(v.done)return n(a,f),ai&&Qa(a,m),d;if(null===f){for(;!v.done;m++,v=l.next())null!==(v=h(a,v.value,c))&&(s=o(v,s,m),null===u?d=v:u.sibling=v,u=v);return ai&&Qa(a,m),d}for(f=r(a,f);!v.done;m++,v=l.next())null!==(v=g(f,a,m,v.value,c))&&(e&&null!==v.alternate&&f.delete(null===v.key?m:v.key),s=o(v,s,m),null===u?d=v:u.sibling=v,u=v);return e&&f.forEach(function(e){return t(a,e)}),ai&&Qa(a,m),d}return function e(r,i,o,l){if("object"===typeof o&&null!==o&&o.type===k&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case w:e:{for(var c=o.key,d=i;null!==d;){if(d.key===c){if((c=o.type)===k){if(7===d.tag){n(r,d.sibling),(i=a(d,o.props.children)).return=r,r=i;break e}}else if(d.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===P&&vi(c)===d.type){n(r,d.sibling),(i=a(d,o.props)).ref=mi(r,d,o),i.return=r,r=i;break e}n(r,d);break}t(r,d),d=d.sibling}o.type===k?((i=Ac(o.props.children,r.mode,l,o.key)).return=r,r=i):((l=Rc(o.type,o.key,o.props,null,r.mode,l)).ref=mi(r,i,o),l.return=r,r=l)}return s(r);case S:e:{for(d=o.key;null!==i;){if(i.key===d){if(4===i.tag&&i.stateNode.containerInfo===o.containerInfo&&i.stateNode.implementation===o.implementation){n(r,i.sibling),(i=a(i,o.children||[])).return=r,r=i;break e}n(r,i);break}t(r,i),i=i.sibling}(i=Dc(o,r.mode,l)).return=r,r=i}return s(r);case P:return e(r,i,(d=o._init)(o._payload),l)}if(te(o))return f(r,i,o,l);if(A(o))return m(r,i,o,l);yi(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==i&&6===i.tag?(n(r,i.sibling),(i=a(i,o)).return=r,r=i):(n(r,i),(i=Bc(o,r.mode,l)).return=r,r=i),s(r)):n(r,i)}}var xi=bi(!0),wi=bi(!1),Si=Ca(null),ki=null,Ci=null,ji=null;function Ti(){ji=Ci=ki=null}function Ei(e){var t=Si.current;ja(Si),e._currentValue=t}function zi(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Mi(e,t){ki=e,ji=Ci=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(bs=!0),e.firstContext=null)}function Ii(e){var t=e._currentValue;if(ji!==e)if(e={context:e,memoizedValue:t,next:null},null===Ci){if(null===ki)throw Error(i(308));Ci=e,ki.dependencies={lanes:0,firstContext:e}}else Ci=Ci.next=e;return t}var _i=null;function Pi(e){null===_i?_i=[e]:_i.push(e)}function Li(e,t,n,r){var a=t.interleaved;return null===a?(n.next=n,Pi(t)):(n.next=a.next,a.next=n),t.interleaved=n,Ri(e,r)}function Ri(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ai=!1;function Ni(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Bi(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Di(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Oi(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&zl)){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,Ri(e,n)}return null===(a=r.interleaved)?(t.next=t,Pi(r)):(t.next=a.next,a.next=t),r.interleaved=t,Ri(e,n)}function Fi(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}function Wi(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?a=i=o:i=i.next=o,n=n.next}while(null!==n);null===i?a=i=t:i=i.next=t}else a=i=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Hi(e,t,n,r){var a=e.updateQueue;Ai=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,s=a.shared.pending;if(null!==s){a.shared.pending=null;var l=s,c=l.next;l.next=null,null===o?i=c:o.next=c,o=l;var d=e.alternate;null!==d&&((s=(d=d.updateQueue).lastBaseUpdate)!==o&&(null===s?d.firstBaseUpdate=c:s.next=c,d.lastBaseUpdate=l))}if(null!==i){var u=a.baseState;for(o=0,d=c=l=null,s=i;;){var h=s.lane,p=s.eventTime;if((r&h)===h){null!==d&&(d=d.next={eventTime:p,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var g=e,f=s;switch(h=t,p=n,f.tag){case 1:if("function"===typeof(g=f.payload)){u=g.call(p,u,h);break e}u=g;break e;case 3:g.flags=-65537&g.flags|128;case 0:if(null===(h="function"===typeof(g=f.payload)?g.call(p,u,h):g)||void 0===h)break e;u=B({},u,h);break e;case 2:Ai=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(h=a.effects)?a.effects=[s]:h.push(s))}else p={eventTime:p,lane:h,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===d?(c=d=p,l=u):d=d.next=p,o|=h;if(null===(s=s.next)){if(null===(s=a.shared.pending))break;s=(h=s).next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}if(null===d&&(l=u),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=d,null!==(t=a.shared.interleaved)){a=t;do{o|=a.lane,a=a.next}while(a!==t)}else null===i&&(a.shared.lanes=0);Nl|=o,e.lanes=o,e.memoizedState=u}}function qi(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!==typeof a)throw Error(i(191,a));a.call(r)}}}var Ui={},Gi=Ca(Ui),Vi=Ca(Ui),Yi=Ca(Ui);function Ki(e){if(e===Ui)throw Error(i(174));return e}function Ji(e,t){switch(Ta(Yi,t),Ta(Vi,e),Ta(Gi,Ui),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}ja(Gi),Ta(Gi,t)}function Xi(){ja(Gi),ja(Vi),ja(Yi)}function $i(e){Ki(Yi.current);var t=Ki(Gi.current),n=le(t,e.type);t!==n&&(Ta(Vi,e),Ta(Gi,n))}function Qi(e){Vi.current===e&&(ja(Gi),ja(Vi))}var Zi=Ca(0);function eo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var to=[];function no(){for(var e=0;e<to.length;e++)to[e]._workInProgressVersionPrimary=null;to.length=0}var ro=x.ReactCurrentDispatcher,ao=x.ReactCurrentBatchConfig,io=0,oo=null,so=null,lo=null,co=!1,uo=!1,ho=0,po=0;function go(){throw Error(i(321))}function fo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function mo(e,t,n,r,a,o){if(io=o,oo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ro.current=null===e||null===e.memoizedState?Zo:es,e=n(r,a),uo){o=0;do{if(uo=!1,ho=0,25<=o)throw Error(i(301));o+=1,lo=so=null,t.updateQueue=null,ro.current=ts,e=n(r,a)}while(uo)}if(ro.current=Qo,t=null!==so&&null!==so.next,io=0,lo=so=oo=null,co=!1,t)throw Error(i(300));return e}function yo(){var e=0!==ho;return ho=0,e}function vo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===lo?oo.memoizedState=lo=e:lo=lo.next=e,lo}function bo(){if(null===so){var e=oo.alternate;e=null!==e?e.memoizedState:null}else e=so.next;var t=null===lo?oo.memoizedState:lo.next;if(null!==t)lo=t,so=e;else{if(null===e)throw Error(i(310));e={memoizedState:(so=e).memoizedState,baseState:so.baseState,baseQueue:so.baseQueue,queue:so.queue,next:null},null===lo?oo.memoizedState=lo=e:lo=lo.next=e}return lo}function xo(e,t){return"function"===typeof t?t(e):t}function wo(e){var t=bo(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=so,a=r.baseQueue,o=n.pending;if(null!==o){if(null!==a){var s=a.next;a.next=o.next,o.next=s}r.baseQueue=a=o,n.pending=null}if(null!==a){o=a.next,r=r.baseState;var l=s=null,c=null,d=o;do{var u=d.lane;if((io&u)===u)null!==c&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var h={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===c?(l=c=h,s=r):c=c.next=h,oo.lanes|=u,Nl|=u}d=d.next}while(null!==d&&d!==o);null===c?s=r:c.next=l,sr(r,t.memoizedState)||(bs=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){a=e;do{o=a.lane,oo.lanes|=o,Nl|=o,a=a.next}while(a!==e)}else null===a&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function So(e){var t=bo(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,o=t.memoizedState;if(null!==a){n.pending=null;var s=a=a.next;do{o=e(o,s.action),s=s.next}while(s!==a);sr(o,t.memoizedState)||(bs=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function ko(){}function Co(e,t){var n=oo,r=bo(),a=t(),o=!sr(r.memoizedState,a);if(o&&(r.memoizedState=a,bs=!0),r=r.queue,No(Eo.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==lo&&1&lo.memoizedState.tag){if(n.flags|=2048,_o(9,To.bind(null,n,r,a,t),void 0,null),null===Ml)throw Error(i(349));0!==(30&io)||jo(n,t,a)}return a}function jo(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function To(e,t,n,r){t.value=n,t.getSnapshot=r,zo(t)&&Mo(e)}function Eo(e,t,n){return n(function(){zo(t)&&Mo(e)})}function zo(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sr(e,n)}catch(r){return!0}}function Mo(e){var t=Ri(e,1);null!==t&&nc(t,e,1,-1)}function Io(e){var t=vo();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xo,lastRenderedState:e},t.queue=e,e=e.dispatch=Ko.bind(null,oo,e),[t.memoizedState,e]}function _o(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Po(){return bo().memoizedState}function Lo(e,t,n,r){var a=vo();oo.flags|=e,a.memoizedState=_o(1|t,n,void 0,void 0===r?null:r)}function Ro(e,t,n,r){var a=bo();r=void 0===r?null:r;var i=void 0;if(null!==so){var o=so.memoizedState;if(i=o.destroy,null!==r&&fo(r,o.deps))return void(a.memoizedState=_o(t,n,i,r))}oo.flags|=e,a.memoizedState=_o(1|t,n,i,r)}function Ao(e,t){return Lo(8390656,8,e,t)}function No(e,t){return Ro(2048,8,e,t)}function Bo(e,t){return Ro(4,2,e,t)}function Do(e,t){return Ro(4,4,e,t)}function Oo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Fo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ro(4,4,Oo.bind(null,t,e),n)}function Wo(){}function Ho(e,t){var n=bo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&fo(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function qo(e,t){var n=bo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&fo(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Uo(e,t,n){return 0===(21&io)?(e.baseState&&(e.baseState=!1,bs=!0),e.memoizedState=n):(sr(n,t)||(n=ft(),oo.lanes|=n,Nl|=n,e.baseState=!0),t)}function Go(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=ao.transition;ao.transition={};try{e(!1),t()}finally{bt=n,ao.transition=r}}function Vo(){return bo().memoizedState}function Yo(e,t,n){var r=tc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Jo(e))Xo(t,n);else if(null!==(n=Li(e,t,n,r))){nc(n,e,r,ec()),$o(n,t,r)}}function Ko(e,t,n){var r=tc(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Jo(e))Xo(t,a);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var o=t.lastRenderedState,s=i(o,n);if(a.hasEagerState=!0,a.eagerState=s,sr(s,o)){var l=t.interleaved;return null===l?(a.next=a,Pi(t)):(a.next=l.next,l.next=a),void(t.interleaved=a)}}catch(c){}null!==(n=Li(e,t,a,r))&&(nc(n,e,r,a=ec()),$o(n,t,r))}}function Jo(e){var t=e.alternate;return e===oo||null!==t&&t===oo}function Xo(e,t){uo=co=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function $o(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}var Qo={readContext:Ii,useCallback:go,useContext:go,useEffect:go,useImperativeHandle:go,useInsertionEffect:go,useLayoutEffect:go,useMemo:go,useReducer:go,useRef:go,useState:go,useDebugValue:go,useDeferredValue:go,useTransition:go,useMutableSource:go,useSyncExternalStore:go,useId:go,unstable_isNewReconciler:!1},Zo={readContext:Ii,useCallback:function(e,t){return vo().memoizedState=[e,void 0===t?null:t],e},useContext:Ii,useEffect:Ao,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Lo(4194308,4,Oo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Lo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Lo(4,2,e,t)},useMemo:function(e,t){var n=vo();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=vo();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Yo.bind(null,oo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},vo().memoizedState=e},useState:Io,useDebugValue:Wo,useDeferredValue:function(e){return vo().memoizedState=e},useTransition:function(){var e=Io(!1),t=e[0];return e=Go.bind(null,e[1]),vo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=oo,a=vo();if(ai){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===Ml)throw Error(i(349));0!==(30&io)||jo(r,t,n)}a.memoizedState=n;var o={value:n,getSnapshot:t};return a.queue=o,Ao(Eo.bind(null,r,o,e),[e]),r.flags|=2048,_o(9,To.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=vo(),t=Ml.identifierPrefix;if(ai){var n=$a;t=":"+t+"R"+(n=(Xa&~(1<<32-ot(Xa)-1)).toString(32)+n),0<(n=ho++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=po++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},es={readContext:Ii,useCallback:Ho,useContext:Ii,useEffect:No,useImperativeHandle:Fo,useInsertionEffect:Bo,useLayoutEffect:Do,useMemo:qo,useReducer:wo,useRef:Po,useState:function(){return wo(xo)},useDebugValue:Wo,useDeferredValue:function(e){return Uo(bo(),so.memoizedState,e)},useTransition:function(){return[wo(xo)[0],bo().memoizedState]},useMutableSource:ko,useSyncExternalStore:Co,useId:Vo,unstable_isNewReconciler:!1},ts={readContext:Ii,useCallback:Ho,useContext:Ii,useEffect:No,useImperativeHandle:Fo,useInsertionEffect:Bo,useLayoutEffect:Do,useMemo:qo,useReducer:So,useRef:Po,useState:function(){return So(xo)},useDebugValue:Wo,useDeferredValue:function(e){var t=bo();return null===so?t.memoizedState=e:Uo(t,so.memoizedState,e)},useTransition:function(){return[So(xo)[0],bo().memoizedState]},useMutableSource:ko,useSyncExternalStore:Co,useId:Vo,unstable_isNewReconciler:!1};function ns(e,t){if(e&&e.defaultProps){for(var n in t=B({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function rs(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:B({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var as={isMounted:function(e){return!!(e=e._reactInternals)&&He(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ec(),a=tc(e),i=Di(r,a);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Oi(e,i,a))&&(nc(t,e,a,r),Fi(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ec(),a=tc(e),i=Di(r,a);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Oi(e,i,a))&&(nc(t,e,a,r),Fi(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),r=tc(e),a=Di(n,r);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=Oi(e,a,r))&&(nc(t,e,r,n),Fi(t,e,r))}};function is(e,t,n,r,a,i,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,o):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(a,i))}function os(e,t,n){var r=!1,a=Ea,i=t.contextType;return"object"===typeof i&&null!==i?i=Ii(i):(a=Pa(t)?Ia:za.current,i=(r=null!==(r=t.contextTypes)&&void 0!==r)?_a(e,a):Ea),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=as,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function ss(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&as.enqueueReplaceState(t,t.state,null)}function ls(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},Ni(e);var i=t.contextType;"object"===typeof i&&null!==i?a.context=Ii(i):(i=Pa(t)?Ia:za.current,a.context=_a(e,i)),a.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(rs(e,t,i,n),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&as.enqueueReplaceState(a,a.state,null),Hi(e,n,a,r),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}function cs(e,t){try{var n="",r=t;do{n+=W(r),r=r.return}while(r);var a=n}catch(i){a="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:a,digest:null}}function ds(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function us(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var hs="function"===typeof WeakMap?WeakMap:Map;function ps(e,t,n){(n=Di(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Ul||(Ul=!0,Gl=r),us(0,t)},n}function gs(e,t,n){(n=Di(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){us(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){us(0,t),"function"!==typeof r&&(null===Vl?Vl=new Set([this]):Vl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function fs(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new hs;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=jc.bind(null,e,t,n),t.then(e,e))}function ms(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ys(e,t,n,r,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Di(-1,1)).tag=2,Oi(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var vs=x.ReactCurrentOwner,bs=!1;function xs(e,t,n,r){t.child=null===e?wi(t,null,n,r):xi(t,e.child,n,r)}function ws(e,t,n,r,a){n=n.render;var i=t.ref;return Mi(t,a),r=mo(e,t,n,r,i,a),n=yo(),null===e||bs?(ai&&n&&ei(t),t.flags|=1,xs(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Us(e,t,a))}function Ss(e,t,n,r,a){if(null===e){var i=n.type;return"function"!==typeof i||Pc(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Rc(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,ks(e,t,i,r,a))}if(i=e.child,0===(e.lanes&a)){var o=i.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(o,r)&&e.ref===t.ref)return Us(e,t,a)}return t.flags|=1,(e=Lc(i,r)).ref=t.ref,e.return=t,t.child=e}function ks(e,t,n,r,a){if(null!==e){var i=e.memoizedProps;if(lr(i,r)&&e.ref===t.ref){if(bs=!1,t.pendingProps=r=i,0===(e.lanes&a))return t.lanes=e.lanes,Us(e,t,a);0!==(131072&e.flags)&&(bs=!0)}}return Ts(e,t,n,r,a)}function Cs(e,t,n){var r=t.pendingProps,a=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ta(Ll,Pl),Pl|=n;else{if(0===(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ta(Ll,Pl),Pl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==i?i.baseLanes:n,Ta(Ll,Pl),Pl|=r}else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,Ta(Ll,Pl),Pl|=r;return xs(e,t,a,n),t.child}function js(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ts(e,t,n,r,a){var i=Pa(n)?Ia:za.current;return i=_a(t,i),Mi(t,a),n=mo(e,t,n,r,i,a),r=yo(),null===e||bs?(ai&&r&&ei(t),t.flags|=1,xs(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Us(e,t,a))}function Es(e,t,n,r,a){if(Pa(n)){var i=!0;Na(t)}else i=!1;if(Mi(t,a),null===t.stateNode)qs(e,t),os(t,n,r),ls(t,n,r,a),r=!0;else if(null===e){var o=t.stateNode,s=t.memoizedProps;o.props=s;var l=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ii(c):c=_a(t,c=Pa(n)?Ia:za.current);var d=n.getDerivedStateFromProps,u="function"===typeof d||"function"===typeof o.getSnapshotBeforeUpdate;u||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==r||l!==c)&&ss(t,o,r,c),Ai=!1;var h=t.memoizedState;o.state=h,Hi(t,r,o,a),l=t.memoizedState,s!==r||h!==l||Ma.current||Ai?("function"===typeof d&&(rs(t,n,d,r),l=t.memoizedState),(s=Ai||is(t,n,s,r,h,l,c))?(u||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),o.props=r,o.state=l,o.context=c,r=s):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Bi(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:ns(t.type,s),o.props=c,u=t.pendingProps,h=o.context,"object"===typeof(l=n.contextType)&&null!==l?l=Ii(l):l=_a(t,l=Pa(n)?Ia:za.current);var p=n.getDerivedStateFromProps;(d="function"===typeof p||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==u||h!==l)&&ss(t,o,r,l),Ai=!1,h=t.memoizedState,o.state=h,Hi(t,r,o,a);var g=t.memoizedState;s!==u||h!==g||Ma.current||Ai?("function"===typeof p&&(rs(t,n,p,r),g=t.memoizedState),(c=Ai||is(t,n,c,r,h,g,l)||!1)?(d||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,g,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,g,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=g),o.props=r,o.state=g,o.context=l,r=c):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return zs(e,t,n,r,i,a)}function zs(e,t,n,r,a,i){js(e,t);var o=0!==(128&t.flags);if(!r&&!o)return a&&Ba(t,n,!1),Us(e,t,i);r=t.stateNode,vs.current=t;var s=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=xi(t,e.child,null,i),t.child=xi(t,null,s,i)):xs(e,t,s,i),t.memoizedState=r.state,a&&Ba(t,n,!0),t.child}function Ms(e){var t=e.stateNode;t.pendingContext?Ra(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ra(0,t.context,!1),Ji(e,t.containerInfo)}function Is(e,t,n,r,a){return pi(),gi(a),t.flags|=256,xs(e,t,n,r),t.child}var _s,Ps,Ls,Rs,As={dehydrated:null,treeContext:null,retryLane:0};function Ns(e){return{baseLanes:e,cachePool:null,transitions:null}}function Bs(e,t,n){var r,a=t.pendingProps,o=Zi.current,s=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Ta(Zi,1&o),null===e)return ci(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=a.children,e=a.fallback,s?(a=t.mode,s=t.child,l={mode:"hidden",children:l},0===(1&a)&&null!==s?(s.childLanes=0,s.pendingProps=l):s=Nc(l,a,0,null),e=Ac(e,a,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Ns(n),t.memoizedState=As,e):Ds(t,l));if(null!==(o=e.memoizedState)&&null!==(r=o.dehydrated))return function(e,t,n,r,a,o,s){if(n)return 256&t.flags?(t.flags&=-257,Os(e,t,s,r=ds(Error(i(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,a=t.mode,r=Nc({mode:"visible",children:r.children},a,0,null),(o=Ac(o,a,s,null)).flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!==(1&t.mode)&&xi(t,e.child,null,s),t.child.memoizedState=Ns(s),t.memoizedState=As,o);if(0===(1&t.mode))return Os(e,t,s,null);if("$!"===a.data){if(r=a.nextSibling&&a.nextSibling.dataset)var l=r.dgst;return r=l,Os(e,t,s,r=ds(o=Error(i(419)),r,void 0))}if(l=0!==(s&e.childLanes),bs||l){if(null!==(r=Ml)){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(r.suspendedLanes|s))?0:a)&&a!==o.retryLane&&(o.retryLane=a,Ri(e,a),nc(r,e,a,-1))}return fc(),Os(e,t,s,r=ds(Error(i(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=Ec.bind(null,e),a._reactRetry=t,null):(e=o.treeContext,ri=ca(a.nextSibling),ni=t,ai=!0,ii=null,null!==e&&(Ya[Ka++]=Xa,Ya[Ka++]=$a,Ya[Ka++]=Ja,Xa=e.id,$a=e.overflow,Ja=t),t=Ds(t,r.children),t.flags|=4096,t)}(e,t,l,a,r,o,n);if(s){s=a.fallback,l=t.mode,r=(o=e.child).sibling;var c={mode:"hidden",children:a.children};return 0===(1&l)&&t.child!==o?((a=t.child).childLanes=0,a.pendingProps=c,t.deletions=null):(a=Lc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==r?s=Lc(r,s):(s=Ac(s,l,n,null)).flags|=2,s.return=t,a.return=t,a.sibling=s,t.child=a,a=s,s=t.child,l=null===(l=e.child.memoizedState)?Ns(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=e.childLanes&~n,t.memoizedState=As,a}return e=(s=e.child).sibling,a=Lc(s,{mode:"visible",children:a.children}),0===(1&t.mode)&&(a.lanes=n),a.return=t,a.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=a,t.memoizedState=null,a}function Ds(e,t){return(t=Nc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Os(e,t,n,r){return null!==r&&gi(r),xi(t,e.child,null,n),(e=Ds(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Fs(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),zi(e.return,t,n)}function Ws(e,t,n,r,a){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function Hs(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(xs(e,t,r.children,n),0!==(2&(r=Zi.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Fs(e,n,t);else if(19===e.tag)Fs(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ta(Zi,r),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===eo(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Ws(t,!1,a,n,i);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===eo(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Ws(t,!0,n,null,i);break;case"together":Ws(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function qs(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Us(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Nl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Lc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Lc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Gs(e,t){if(!ai)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Vs(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=14680064&a.subtreeFlags,r|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ys(e,t,n){var r=t.pendingProps;switch(ti(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vs(t),null;case 1:case 17:return Pa(t.type)&&La(),Vs(t),null;case 3:return r=t.stateNode,Xi(),ja(Ma),ja(za),no(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ui(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ii&&(oc(ii),ii=null))),Ps(e,t),Vs(t),null;case 5:Qi(t);var a=Ki(Yi.current);if(n=t.type,null!==e&&null!=t.stateNode)Ls(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(i(166));return Vs(t),null}if(e=Ki(Gi.current),ui(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[ha]=t,r[pa]=o,e=0!==(1&t.mode),n){case"dialog":Or("cancel",r),Or("close",r);break;case"iframe":case"object":case"embed":Or("load",r);break;case"video":case"audio":for(a=0;a<Ar.length;a++)Or(Ar[a],r);break;case"source":Or("error",r);break;case"img":case"image":case"link":Or("error",r),Or("load",r);break;case"details":Or("toggle",r);break;case"input":X(r,o),Or("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Or("invalid",r);break;case"textarea":ae(r,o),Or("invalid",r)}for(var l in ve(n,o),a=null,o)if(o.hasOwnProperty(l)){var c=o[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==o.suppressHydrationWarning&&Qr(r.textContent,c,e),a=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Qr(r.textContent,c,e),a=["children",""+c]):s.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Or("scroll",r)}switch(n){case"input":V(r),Z(r,o,!0);break;case"textarea":V(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=Zr)}r=a,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[ha]=t,e[pa]=r,_s(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,r),n){case"dialog":Or("cancel",e),Or("close",e),a=r;break;case"iframe":case"object":case"embed":Or("load",e),a=r;break;case"video":case"audio":for(a=0;a<Ar.length;a++)Or(Ar[a],e);a=r;break;case"source":Or("error",e),a=r;break;case"img":case"image":case"link":Or("error",e),Or("load",e),a=r;break;case"details":Or("toggle",e),a=r;break;case"input":X(e,r),a=J(e,r),Or("invalid",e);break;case"option":default:a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=B({},r,{value:void 0}),Or("invalid",e);break;case"textarea":ae(e,r),a=re(e,r),Or("invalid",e)}for(o in ve(n,a),c=a)if(c.hasOwnProperty(o)){var d=c[o];"style"===o?me(e,d):"dangerouslySetInnerHTML"===o?null!=(d=d?d.__html:void 0)&&ue(e,d):"children"===o?"string"===typeof d?("textarea"!==n||""!==d)&&he(e,d):"number"===typeof d&&he(e,""+d):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(s.hasOwnProperty(o)?null!=d&&"onScroll"===o&&Or("scroll",e):null!=d&&b(e,o,d,l))}switch(n){case"input":V(e),Z(e,r,!1);break;case"textarea":V(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+U(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Vs(t),null;case 6:if(e&&null!=t.stateNode)Rs(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(i(166));if(n=Ki(Yi.current),Ki(Gi.current),ui(t)){if(r=t.stateNode,n=t.memoizedProps,r[ha]=t,(o=r.nodeValue!==n)&&null!==(e=ni))switch(e.tag){case 3:Qr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Qr(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[ha]=t,t.stateNode=r}return Vs(t),null;case 13:if(ja(Zi),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ai&&null!==ri&&0!==(1&t.mode)&&0===(128&t.flags))hi(),pi(),t.flags|=98560,o=!1;else if(o=ui(t),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(i(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(i(317));o[ha]=t}else pi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Vs(t),o=!1}else null!==ii&&(oc(ii),ii=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Zi.current)?0===Rl&&(Rl=3):fc())),null!==t.updateQueue&&(t.flags|=4),Vs(t),null);case 4:return Xi(),Ps(e,t),null===e&&Hr(t.stateNode.containerInfo),Vs(t),null;case 10:return Ei(t.type._context),Vs(t),null;case 19:if(ja(Zi),null===(o=t.memoizedState))return Vs(t),null;if(r=0!==(128&t.flags),null===(l=o.rendering))if(r)Gs(o,!1);else{if(0!==Rl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=eo(e))){for(t.flags|=128,Gs(o,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(l=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ta(Zi,1&Zi.current|2),t.child}e=e.sibling}null!==o.tail&&$e()>Hl&&(t.flags|=128,r=!0,Gs(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=eo(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Gs(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate&&!ai)return Vs(t),null}else 2*$e()-o.renderingStartTime>Hl&&1073741824!==n&&(t.flags|=128,r=!0,Gs(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=o.last)?n.sibling=l:t.child=l,o.last=l)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=$e(),t.sibling=null,n=Zi.current,Ta(Zi,r?1&n|2:1&n),t):(Vs(t),null);case 22:case 23:return uc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Pl)&&(Vs(t),6&t.subtreeFlags&&(t.flags|=8192)):Vs(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function Ks(e,t){switch(ti(t),t.tag){case 1:return Pa(t.type)&&La(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Xi(),ja(Ma),ja(za),no(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Qi(t),null;case 13:if(ja(Zi),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));pi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return ja(Zi),null;case 4:return Xi(),null;case 10:return Ei(t.type._context),null;case 22:case 23:return uc(),null;default:return null}}_s=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ps=function(){},Ls=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,Ki(Gi.current);var i,o=null;switch(n){case"input":a=J(e,a),r=J(e,r),o=[];break;case"select":a=B({},a,{value:void 0}),r=B({},r,{value:void 0}),o=[];break;case"textarea":a=re(e,a),r=re(e,r),o=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(d in ve(n,r),n=null,a)if(!r.hasOwnProperty(d)&&a.hasOwnProperty(d)&&null!=a[d])if("style"===d){var l=a[d];for(i in l)l.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(s.hasOwnProperty(d)?o||(o=[]):(o=o||[]).push(d,null));for(d in r){var c=r[d];if(l=null!=a?a[d]:void 0,r.hasOwnProperty(d)&&c!==l&&(null!=c||null!=l))if("style"===d)if(l){for(i in l)!l.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in c)c.hasOwnProperty(i)&&l[i]!==c[i]&&(n||(n={}),n[i]=c[i])}else n||(o||(o=[]),o.push(d,n)),n=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(o=o||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(s.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&Or("scroll",e),o||l===c||(o=[])):(o=o||[]).push(d,c))}n&&(o=o||[]).push("style",n);var d=o;(t.updateQueue=d)&&(t.flags|=4)}},Rs=function(e,t,n,r){n!==r&&(t.flags|=4)};var Js=!1,Xs=!1,$s="function"===typeof WeakSet?WeakSet:Set,Qs=null;function Zs(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Cc(e,t,r)}else n.current=null}function el(e,t,n){try{n()}catch(r){Cc(e,t,r)}}var tl=!1;function nl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var a=r=r.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,void 0!==i&&el(t,n,i)}a=a.next}while(a!==r)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function al(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function il(e){var t=e.alternate;null!==t&&(e.alternate=null,il(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[ha],delete t[pa],delete t[fa],delete t[ma],delete t[ya])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ol(e){return 5===e.tag||3===e.tag||4===e.tag}function sl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ol(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var dl=null,ul=!1;function hl(e,t,n){for(n=n.child;null!==n;)pl(e,t,n),n=n.sibling}function pl(e,t,n){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(at,n)}catch(s){}switch(n.tag){case 5:Xs||Zs(n,t);case 6:var r=dl,a=ul;dl=null,hl(e,t,n),ul=a,null!==(dl=r)&&(ul?(e=dl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):dl.removeChild(n.stateNode));break;case 18:null!==dl&&(ul?(e=dl,n=n.stateNode,8===e.nodeType?la(e.parentNode,n):1===e.nodeType&&la(e,n),Ht(e)):la(dl,n.stateNode));break;case 4:r=dl,a=ul,dl=n.stateNode.containerInfo,ul=!0,hl(e,t,n),dl=r,ul=a;break;case 0:case 11:case 14:case 15:if(!Xs&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){a=r=r.next;do{var i=a,o=i.destroy;i=i.tag,void 0!==o&&(0!==(2&i)||0!==(4&i))&&el(n,t,o),a=a.next}while(a!==r)}hl(e,t,n);break;case 1:if(!Xs&&(Zs(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){Cc(n,t,s)}hl(e,t,n);break;case 21:hl(e,t,n);break;case 22:1&n.mode?(Xs=(r=Xs)||null!==n.memoizedState,hl(e,t,n),Xs=r):hl(e,t,n);break;default:hl(e,t,n)}}function gl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new $s),t.forEach(function(t){var r=zc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}}function fl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r];try{var o=e,s=t,l=s;e:for(;null!==l;){switch(l.tag){case 5:dl=l.stateNode,ul=!1;break e;case 3:case 4:dl=l.stateNode.containerInfo,ul=!0;break e}l=l.return}if(null===dl)throw Error(i(160));pl(o,s,a),dl=null,ul=!1;var c=a.alternate;null!==c&&(c.return=null),a.return=null}catch(d){Cc(a,t,d)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)ml(t,e),t=t.sibling}function ml(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(fl(t,e),yl(e),4&r){try{nl(3,e,e.return),rl(3,e)}catch(m){Cc(e,e.return,m)}try{nl(5,e,e.return)}catch(m){Cc(e,e.return,m)}}break;case 1:fl(t,e),yl(e),512&r&&null!==n&&Zs(n,n.return);break;case 5:if(fl(t,e),yl(e),512&r&&null!==n&&Zs(n,n.return),32&e.flags){var a=e.stateNode;try{he(a,"")}catch(m){Cc(e,e.return,m)}}if(4&r&&null!=(a=e.stateNode)){var o=e.memoizedProps,s=null!==n?n.memoizedProps:o,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===o.type&&null!=o.name&&$(a,o),be(l,s);var d=be(l,o);for(s=0;s<c.length;s+=2){var u=c[s],h=c[s+1];"style"===u?me(a,h):"dangerouslySetInnerHTML"===u?ue(a,h):"children"===u?he(a,h):b(a,u,h,d)}switch(l){case"input":Q(a,o);break;case"textarea":ie(a,o);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!o.multiple;var g=o.value;null!=g?ne(a,!!o.multiple,g,!1):p!==!!o.multiple&&(null!=o.defaultValue?ne(a,!!o.multiple,o.defaultValue,!0):ne(a,!!o.multiple,o.multiple?[]:"",!1))}a[pa]=o}catch(m){Cc(e,e.return,m)}}break;case 6:if(fl(t,e),yl(e),4&r){if(null===e.stateNode)throw Error(i(162));a=e.stateNode,o=e.memoizedProps;try{a.nodeValue=o}catch(m){Cc(e,e.return,m)}}break;case 3:if(fl(t,e),yl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Ht(t.containerInfo)}catch(m){Cc(e,e.return,m)}break;case 4:default:fl(t,e),yl(e);break;case 13:fl(t,e),yl(e),8192&(a=e.child).flags&&(o=null!==a.memoizedState,a.stateNode.isHidden=o,!o||null!==a.alternate&&null!==a.alternate.memoizedState||(Wl=$e())),4&r&&gl(e);break;case 22:if(u=null!==n&&null!==n.memoizedState,1&e.mode?(Xs=(d=Xs)||u,fl(t,e),Xs=d):fl(t,e),yl(e),8192&r){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!u&&0!==(1&e.mode))for(Qs=e,u=e.child;null!==u;){for(h=Qs=u;null!==Qs;){switch(g=(p=Qs).child,p.tag){case 0:case 11:case 14:case 15:nl(4,p,p.return);break;case 1:Zs(p,p.return);var f=p.stateNode;if("function"===typeof f.componentWillUnmount){r=p,n=p.return;try{t=r,f.props=t.memoizedProps,f.state=t.memoizedState,f.componentWillUnmount()}catch(m){Cc(r,n,m)}}break;case 5:Zs(p,p.return);break;case 22:if(null!==p.memoizedState){wl(h);continue}}null!==g?(g.return=p,Qs=g):wl(h)}u=u.sibling}e:for(u=null,h=e;;){if(5===h.tag){if(null===u){u=h;try{a=h.stateNode,d?"function"===typeof(o=a.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=h.stateNode,s=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=fe("display",s))}catch(m){Cc(e,e.return,m)}}}else if(6===h.tag){if(null===u)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(m){Cc(e,e.return,m)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:fl(t,e),yl(e),4&r&&gl(e);case 21:}}function yl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ol(n)){var r=n;break e}n=n.return}throw Error(i(160))}switch(r.tag){case 5:var a=r.stateNode;32&r.flags&&(he(a,""),r.flags&=-33),cl(e,sl(e),a);break;case 3:case 4:var o=r.stateNode.containerInfo;ll(e,sl(e),o);break;default:throw Error(i(161))}}catch(s){Cc(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vl(e,t,n){Qs=e,bl(e,t,n)}function bl(e,t,n){for(var r=0!==(1&e.mode);null!==Qs;){var a=Qs,i=a.child;if(22===a.tag&&r){var o=null!==a.memoizedState||Js;if(!o){var s=a.alternate,l=null!==s&&null!==s.memoizedState||Xs;s=Js;var c=Xs;if(Js=o,(Xs=l)&&!c)for(Qs=a;null!==Qs;)l=(o=Qs).child,22===o.tag&&null!==o.memoizedState?Sl(a):null!==l?(l.return=o,Qs=l):Sl(a);for(;null!==i;)Qs=i,bl(i,t,n),i=i.sibling;Qs=a,Js=s,Xs=c}xl(e)}else 0!==(8772&a.subtreeFlags)&&null!==i?(i.return=a,Qs=i):xl(e)}}function xl(e){for(;null!==Qs;){var t=Qs;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Xs||rl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Xs)if(null===n)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:ns(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&qi(t,o,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}qi(t,s,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var u=d.memoizedState;if(null!==u){var h=u.dehydrated;null!==h&&Ht(h)}}}break;default:throw Error(i(163))}Xs||512&t.flags&&al(t)}catch(p){Cc(t,t.return,p)}}if(t===e){Qs=null;break}if(null!==(n=t.sibling)){n.return=t.return,Qs=n;break}Qs=t.return}}function wl(e){for(;null!==Qs;){var t=Qs;if(t===e){Qs=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Qs=n;break}Qs=t.return}}function Sl(e){for(;null!==Qs;){var t=Qs;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(l){Cc(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var a=t.return;try{r.componentDidMount()}catch(l){Cc(t,a,l)}}var i=t.return;try{al(t)}catch(l){Cc(t,i,l)}break;case 5:var o=t.return;try{al(t)}catch(l){Cc(t,o,l)}}}catch(l){Cc(t,t.return,l)}if(t===e){Qs=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Qs=s;break}Qs=t.return}}var kl,Cl=Math.ceil,jl=x.ReactCurrentDispatcher,Tl=x.ReactCurrentOwner,El=x.ReactCurrentBatchConfig,zl=0,Ml=null,Il=null,_l=0,Pl=0,Ll=Ca(0),Rl=0,Al=null,Nl=0,Bl=0,Dl=0,Ol=null,Fl=null,Wl=0,Hl=1/0,ql=null,Ul=!1,Gl=null,Vl=null,Yl=!1,Kl=null,Jl=0,Xl=0,$l=null,Ql=-1,Zl=0;function ec(){return 0!==(6&zl)?$e():-1!==Ql?Ql:Ql=$e()}function tc(e){return 0===(1&e.mode)?1:0!==(2&zl)&&0!==_l?_l&-_l:null!==fi.transition?(0===Zl&&(Zl=ft()),Zl):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Xt(e.type)}function nc(e,t,n,r){if(50<Xl)throw Xl=0,$l=null,Error(i(185));yt(e,n,r),0!==(2&zl)&&e===Ml||(e===Ml&&(0===(2&zl)&&(Bl|=n),4===Rl&&sc(e,_l)),rc(e,r),1===n&&0===zl&&0===(1&t.mode)&&(Hl=$e()+500,Oa&&Ha()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-ot(i),s=1<<o,l=a[o];-1===l?0!==(s&n)&&0===(s&r)||(a[o]=pt(s,t)):l<=t&&(e.expiredLanes|=s),i&=~s}}(e,t);var r=ht(e,e===Ml?_l:0);if(0===r)null!==n&&Ke(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ke(n),1===t)0===e.tag?function(e){Oa=!0,Wa(e)}(lc.bind(null,e)):Wa(lc.bind(null,e)),oa(function(){0===(6&zl)&&Ha()}),n=null;else{switch(xt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Mc(n,ac.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ac(e,t){if(Ql=-1,Zl=0,0!==(6&zl))throw Error(i(327));var n=e.callbackNode;if(Sc()&&e.callbackNode!==n)return null;var r=ht(e,e===Ml?_l:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=mc(e,r);else{t=r;var a=zl;zl|=2;var o=gc();for(Ml===e&&_l===t||(ql=null,Hl=$e()+500,hc(e,t));;)try{vc();break}catch(l){pc(e,l)}Ti(),jl.current=o,zl=a,null!==Il?t=0:(Ml=null,_l=0,t=Rl)}if(0!==t){if(2===t&&(0!==(a=gt(e))&&(r=a,t=ic(e,a))),1===t)throw n=Al,hc(e,0),sc(e,r),rc(e,$e()),n;if(6===t)sc(e,r);else{if(a=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!sr(i(),a))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=mc(e,r))&&(0!==(o=gt(e))&&(r=o,t=ic(e,o))),1===t))throw n=Al,hc(e,0),sc(e,r),rc(e,$e()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(i(345));case 2:case 5:wc(e,Fl,ql);break;case 3:if(sc(e,r),(130023424&r)===r&&10<(t=Wl+500-$e())){if(0!==ht(e,0))break;if(((a=e.suspendedLanes)&r)!==r){ec(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ra(wc.bind(null,e,Fl,ql),t);break}wc(e,Fl,ql);break;case 4:if(sc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,a=-1;0<r;){var s=31-ot(r);o=1<<s,(s=t[s])>a&&(a=s),r&=~o}if(r=a,10<(r=(120>(r=$e()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Cl(r/1960))-r)){e.timeoutHandle=ra(wc.bind(null,e,Fl,ql),r);break}wc(e,Fl,ql);break;default:throw Error(i(329))}}}return rc(e,$e()),e.callbackNode===n?ac.bind(null,e):null}function ic(e,t){var n=Ol;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=mc(e,t))&&(t=Fl,Fl=n,null!==t&&oc(t)),e}function oc(e){null===Fl?Fl=e:Fl.push.apply(Fl,e)}function sc(e,t){for(t&=~Dl,t&=~Bl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),r=1<<n;e[n]=-1,t&=~r}}function lc(e){if(0!==(6&zl))throw Error(i(327));Sc();var t=ht(e,0);if(0===(1&t))return rc(e,$e()),null;var n=mc(e,t);if(0!==e.tag&&2===n){var r=gt(e);0!==r&&(t=r,n=ic(e,r))}if(1===n)throw n=Al,hc(e,0),sc(e,t),rc(e,$e()),n;if(6===n)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,Fl,ql),rc(e,$e()),null}function cc(e,t){var n=zl;zl|=1;try{return e(t)}finally{0===(zl=n)&&(Hl=$e()+500,Oa&&Ha())}}function dc(e){null!==Kl&&0===Kl.tag&&0===(6&zl)&&Sc();var t=zl;zl|=1;var n=El.transition,r=bt;try{if(El.transition=null,bt=1,e)return e()}finally{bt=r,El.transition=n,0===(6&(zl=t))&&Ha()}}function uc(){Pl=Ll.current,ja(Ll)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,aa(n)),null!==Il)for(n=Il.return;null!==n;){var r=n;switch(ti(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&La();break;case 3:Xi(),ja(Ma),ja(za),no();break;case 5:Qi(r);break;case 4:Xi();break;case 13:case 19:ja(Zi);break;case 10:Ei(r.type._context);break;case 22:case 23:uc()}n=n.return}if(Ml=e,Il=e=Lc(e.current,null),_l=Pl=t,Rl=0,Al=null,Dl=Bl=Nl=0,Fl=Ol=null,null!==_i){for(t=0;t<_i.length;t++)if(null!==(r=(n=_i[t]).interleaved)){n.interleaved=null;var a=r.next,i=n.pending;if(null!==i){var o=i.next;i.next=a,r.next=o}n.pending=r}_i=null}return e}function pc(e,t){for(;;){var n=Il;try{if(Ti(),ro.current=Qo,co){for(var r=oo.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}co=!1}if(io=0,lo=so=oo=null,uo=!1,ho=0,Tl.current=null,null===n||null===n.return){Rl=1,Al=t,Il=null;break}e:{var o=e,s=n.return,l=n,c=t;if(t=_l,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var d=c,u=l,h=u.tag;if(0===(1&u.mode)&&(0===h||11===h||15===h)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var g=ms(s);if(null!==g){g.flags&=-257,ys(g,s,l,0,t),1&g.mode&&fs(o,d,t),c=d;var f=(t=g).updateQueue;if(null===f){var m=new Set;m.add(c),t.updateQueue=m}else f.add(c);break e}if(0===(1&t)){fs(o,d,t),fc();break e}c=Error(i(426))}else if(ai&&1&l.mode){var y=ms(s);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),ys(y,s,l,0,t),gi(cs(c,l));break e}}o=c=cs(c,l),4!==Rl&&(Rl=2),null===Ol?Ol=[o]:Ol.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Wi(o,ps(0,c,t));break e;case 1:l=c;var v=o.type,b=o.stateNode;if(0===(128&o.flags)&&("function"===typeof v.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Vl||!Vl.has(b)))){o.flags|=65536,t&=-t,o.lanes|=t,Wi(o,gs(o,l,t));break e}}o=o.return}while(null!==o)}xc(n)}catch(x){t=x,Il===n&&null!==n&&(Il=n=n.return);continue}break}}function gc(){var e=jl.current;return jl.current=Qo,null===e?Qo:e}function fc(){0!==Rl&&3!==Rl&&2!==Rl||(Rl=4),null===Ml||0===(268435455&Nl)&&0===(268435455&Bl)||sc(Ml,_l)}function mc(e,t){var n=zl;zl|=2;var r=gc();for(Ml===e&&_l===t||(ql=null,hc(e,t));;)try{yc();break}catch(a){pc(e,a)}if(Ti(),zl=n,jl.current=r,null!==Il)throw Error(i(261));return Ml=null,_l=0,Rl}function yc(){for(;null!==Il;)bc(Il)}function vc(){for(;null!==Il&&!Je();)bc(Il)}function bc(e){var t=kl(e.alternate,e,Pl);e.memoizedProps=e.pendingProps,null===t?xc(e):Il=t,Tl.current=null}function xc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ys(n,t,Pl)))return void(Il=n)}else{if(null!==(n=Ks(n,t)))return n.flags&=32767,void(Il=n);if(null===e)return Rl=6,void(Il=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Il=t);Il=t=e}while(null!==t);0===Rl&&(Rl=5)}function wc(e,t,n){var r=bt,a=El.transition;try{El.transition=null,bt=1,function(e,t,n,r){do{Sc()}while(null!==Kl);if(0!==(6&zl))throw Error(i(327));n=e.finishedWork;var a=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-ot(n),i=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~i}}(e,o),e===Ml&&(Il=Ml=null,_l=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Yl||(Yl=!0,Mc(tt,function(){return Sc(),null})),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=El.transition,El.transition=null;var s=bt;bt=1;var l=zl;zl|=4,Tl.current=null,function(e,t){if(ea=Ut,pr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(w){n=null;break e}var s=0,l=-1,c=-1,d=0,u=0,h=e,p=null;t:for(;;){for(var g;h!==n||0!==a&&3!==h.nodeType||(l=s+a),h!==o||0!==r&&3!==h.nodeType||(c=s+r),3===h.nodeType&&(s+=h.nodeValue.length),null!==(g=h.firstChild);)p=h,h=g;for(;;){if(h===e)break t;if(p===n&&++d===a&&(l=s),p===o&&++u===r&&(c=s),null!==(g=h.nextSibling))break;p=(h=p).parentNode}h=g}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ta={focusedElem:e,selectionRange:n},Ut=!1,Qs=t;null!==Qs;)if(e=(t=Qs).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Qs=e;else for(;null!==Qs;){t=Qs;try{var f=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==f){var m=f.memoizedProps,y=f.memoizedState,v=t.stateNode,b=v.getSnapshotBeforeUpdate(t.elementType===t.type?m:ns(t.type,m),y);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=t.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(i(163))}}catch(w){Cc(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Qs=e;break}Qs=t.return}f=tl,tl=!1}(e,n),ml(n,e),gr(ta),Ut=!!ea,ta=ea=null,e.current=n,vl(n,e,a),Xe(),zl=l,bt=s,El.transition=o}else e.current=n;if(Yl&&(Yl=!1,Kl=e,Jl=a),o=e.pendingLanes,0===o&&(Vl=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rc(e,$e()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(Ul)throw Ul=!1,e=Gl,Gl=null,e;0!==(1&Jl)&&0!==e.tag&&Sc(),o=e.pendingLanes,0!==(1&o)?e===$l?Xl++:(Xl=0,$l=e):Xl=0,Ha()}(e,t,n,r)}finally{El.transition=a,bt=r}return null}function Sc(){if(null!==Kl){var e=xt(Jl),t=El.transition,n=bt;try{if(El.transition=null,bt=16>e?16:e,null===Kl)var r=!1;else{if(e=Kl,Kl=null,Jl=0,0!==(6&zl))throw Error(i(331));var a=zl;for(zl|=4,Qs=e.current;null!==Qs;){var o=Qs,s=o.child;if(0!==(16&Qs.flags)){var l=o.deletions;if(null!==l){for(var c=0;c<l.length;c++){var d=l[c];for(Qs=d;null!==Qs;){var u=Qs;switch(u.tag){case 0:case 11:case 15:nl(8,u,o)}var h=u.child;if(null!==h)h.return=u,Qs=h;else for(;null!==Qs;){var p=(u=Qs).sibling,g=u.return;if(il(u),u===d){Qs=null;break}if(null!==p){p.return=g,Qs=p;break}Qs=g}}}var f=o.alternate;if(null!==f){var m=f.child;if(null!==m){f.child=null;do{var y=m.sibling;m.sibling=null,m=y}while(null!==m)}}Qs=o}}if(0!==(2064&o.subtreeFlags)&&null!==s)s.return=o,Qs=s;else e:for(;null!==Qs;){if(0!==(2048&(o=Qs).flags))switch(o.tag){case 0:case 11:case 15:nl(9,o,o.return)}var v=o.sibling;if(null!==v){v.return=o.return,Qs=v;break e}Qs=o.return}}var b=e.current;for(Qs=b;null!==Qs;){var x=(s=Qs).child;if(0!==(2064&s.subtreeFlags)&&null!==x)x.return=s,Qs=x;else e:for(s=b;null!==Qs;){if(0!==(2048&(l=Qs).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(S){Cc(l,l.return,S)}if(l===s){Qs=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Qs=w;break e}Qs=l.return}}if(zl=a,Ha(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(at,e)}catch(S){}r=!0}return r}finally{bt=n,El.transition=t}}return!1}function kc(e,t,n){e=Oi(e,t=ps(0,t=cs(n,t),1),1),t=ec(),null!==e&&(yt(e,1,t),rc(e,t))}function Cc(e,t,n){if(3===e.tag)kc(e,e,n);else for(;null!==t;){if(3===t.tag){kc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Vl||!Vl.has(r))){t=Oi(t,e=gs(t,e=cs(n,e),1),1),e=ec(),null!==t&&(yt(t,1,e),rc(t,e));break}}t=t.return}}function jc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Ml===e&&(_l&n)===n&&(4===Rl||3===Rl&&(130023424&_l)===_l&&500>$e()-Wl?hc(e,0):Dl|=n),rc(e,t)}function Tc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=dt,0===(130023424&(dt<<=1))&&(dt=4194304)));var n=ec();null!==(e=Ri(e,t))&&(yt(e,t,n),rc(e,n))}function Ec(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Tc(e,n)}function zc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(i(314))}null!==r&&r.delete(t),Tc(e,n)}function Mc(e,t){return Ye(e,t)}function Ic(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function _c(e,t,n,r){return new Ic(e,t,n,r)}function Pc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Lc(e,t){var n=e.alternate;return null===n?((n=_c(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Rc(e,t,n,r,a,o){var s=2;if(r=e,"function"===typeof e)Pc(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case k:return Ac(n.children,a,o,t);case C:s=8,a|=8;break;case j:return(e=_c(12,n,t,2|a)).elementType=j,e.lanes=o,e;case M:return(e=_c(13,n,t,a)).elementType=M,e.lanes=o,e;case I:return(e=_c(19,n,t,a)).elementType=I,e.lanes=o,e;case L:return Nc(n,a,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case T:s=10;break e;case E:s=9;break e;case z:s=11;break e;case _:s=14;break e;case P:s=16,r=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=_c(s,n,t,a)).elementType=e,t.type=r,t.lanes=o,t}function Ac(e,t,n,r){return(e=_c(7,e,r,t)).lanes=n,e}function Nc(e,t,n,r){return(e=_c(22,e,r,t)).elementType=L,e.lanes=n,e.stateNode={isHidden:!1},e}function Bc(e,t,n){return(e=_c(6,e,null,t)).lanes=n,e}function Dc(e,t,n){return(t=_c(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Oc(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Fc(e,t,n,r,a,i,o,s,l){return e=new Oc(e,t,n,s,l),1===t?(t=1,!0===i&&(t|=8)):t=0,i=_c(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ni(i),e}function Wc(e){if(!e)return Ea;e:{if(He(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Pa(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var n=e.type;if(Pa(n))return Aa(e,n,t)}return t}function Hc(e,t,n,r,a,i,o,s,l){return(e=Fc(n,r,!0,e,0,i,0,s,l)).context=Wc(null),n=e.current,(i=Di(r=ec(),a=tc(n))).callback=void 0!==t&&null!==t?t:null,Oi(n,i,a),e.current.lanes=a,yt(e,a,r),rc(e,r),e}function qc(e,t,n,r){var a=t.current,i=ec(),o=tc(a);return n=Wc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Di(i,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Oi(a,t,o))&&(nc(e,a,o,i),Fi(e,a,o)),o}function Uc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Gc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Vc(e,t){Gc(e,t),(e=e.alternate)&&Gc(e,t)}kl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ma.current)bs=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return bs=!1,function(e,t,n){switch(t.tag){case 3:Ms(t),pi();break;case 5:$i(t);break;case 1:Pa(t.type)&&Na(t);break;case 4:Ji(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Ta(Si,r._currentValue),r._currentValue=a;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ta(Zi,1&Zi.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Bs(e,t,n):(Ta(Zi,1&Zi.current),null!==(e=Us(e,t,n))?e.sibling:null);Ta(Zi,1&Zi.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Hs(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Ta(Zi,Zi.current),r)break;return null;case 22:case 23:return t.lanes=0,Cs(e,t,n)}return Us(e,t,n)}(e,t,n);bs=0!==(131072&e.flags)}else bs=!1,ai&&0!==(1048576&t.flags)&&Za(t,Va,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;qs(e,t),e=t.pendingProps;var a=_a(t,za.current);Mi(t,n),a=mo(null,t,r,e,a,n);var o=yo();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Pa(r)?(o=!0,Na(t)):o=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Ni(t),a.updater=as,t.stateNode=a,a._reactInternals=t,ls(t,r,e,n),t=zs(null,t,r,!0,o,n)):(t.tag=0,ai&&o&&ei(t),xs(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(qs(e,t),e=t.pendingProps,r=(a=r._init)(r._payload),t.type=r,a=t.tag=function(e){if("function"===typeof e)return Pc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===z)return 11;if(e===_)return 14}return 2}(r),e=ns(r,e),a){case 0:t=Ts(null,t,r,e,n);break e;case 1:t=Es(null,t,r,e,n);break e;case 11:t=ws(null,t,r,e,n);break e;case 14:t=Ss(null,t,r,ns(r.type,e),n);break e}throw Error(i(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,Ts(e,t,r,a=t.elementType===r?a:ns(r,a),n);case 1:return r=t.type,a=t.pendingProps,Es(e,t,r,a=t.elementType===r?a:ns(r,a),n);case 3:e:{if(Ms(t),null===e)throw Error(i(387));r=t.pendingProps,a=(o=t.memoizedState).element,Bi(e,t),Hi(t,r,null,n);var s=t.memoizedState;if(r=s.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Is(e,t,r,n,a=cs(Error(i(423)),t));break e}if(r!==a){t=Is(e,t,r,n,a=cs(Error(i(424)),t));break e}for(ri=ca(t.stateNode.containerInfo.firstChild),ni=t,ai=!0,ii=null,n=wi(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(pi(),r===a){t=Us(e,t,n);break e}xs(e,t,r,n)}t=t.child}return t;case 5:return $i(t),null===e&&ci(t),r=t.type,a=t.pendingProps,o=null!==e?e.memoizedProps:null,s=a.children,na(r,a)?s=null:null!==o&&na(r,o)&&(t.flags|=32),js(e,t),xs(e,t,s,n),t.child;case 6:return null===e&&ci(t),null;case 13:return Bs(e,t,n);case 4:return Ji(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=xi(t,null,r,n):xs(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,ws(e,t,r,a=t.elementType===r?a:ns(r,a),n);case 7:return xs(e,t,t.pendingProps,n),t.child;case 8:case 12:return xs(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,o=t.memoizedProps,s=a.value,Ta(Si,r._currentValue),r._currentValue=s,null!==o)if(sr(o.value,s)){if(o.children===a.children&&!Ma.current){t=Us(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){s=o.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===o.tag){(c=Di(-1,n&-n)).tag=2;var d=o.updateQueue;if(null!==d){var u=(d=d.shared).pending;null===u?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),zi(o.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===o.tag)s=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(s=o.return))throw Error(i(341));s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),zi(s,n,t),s=o.sibling}else s=o.child;if(null!==s)s.return=o;else for(s=o;null!==s;){if(s===t){s=null;break}if(null!==(o=s.sibling)){o.return=s.return,s=o;break}s=s.return}o=s}xs(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,Mi(t,n),r=r(a=Ii(a)),t.flags|=1,xs(e,t,r,n),t.child;case 14:return a=ns(r=t.type,t.pendingProps),Ss(e,t,r,a=ns(r.type,a),n);case 15:return ks(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:ns(r,a),qs(e,t),t.tag=1,Pa(r)?(e=!0,Na(t)):e=!1,Mi(t,n),os(t,r,a),ls(t,r,a,n),zs(null,t,r,!0,e,n);case 19:return Hs(e,t,n);case 22:return Cs(e,t,n)}throw Error(i(156,t.tag))};var Yc="function"===typeof reportError?reportError:function(e){console.error(e)};function Kc(e){this._internalRoot=e}function Jc(e){this._internalRoot=e}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function $c(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Qc(){}function Zc(e,t,n,r,a){var i=n._reactRootContainer;if(i){var o=i;if("function"===typeof a){var s=a;a=function(){var e=Uc(o);s.call(e)}}qc(t,o,e,a)}else o=function(e,t,n,r,a){if(a){if("function"===typeof r){var i=r;r=function(){var e=Uc(o);i.call(e)}}var o=Hc(t,r,e,0,null,!1,0,"",Qc);return e._reactRootContainer=o,e[ga]=o.current,Hr(8===e.nodeType?e.parentNode:e),dc(),o}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof r){var s=r;r=function(){var e=Uc(l);s.call(e)}}var l=Fc(e,0,!1,null,0,!1,0,"",Qc);return e._reactRootContainer=l,e[ga]=l.current,Hr(8===e.nodeType?e.parentNode:e),dc(function(){qc(t,l,n,r)}),l}(n,t,e,a,r);return Uc(o)}Jc.prototype.render=Kc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));qc(e,t,null,null)},Jc.prototype.unmount=Kc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dc(function(){qc(null,e,null,null)}),t[ga]=null}},Jc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ct();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Lt.length&&0!==t&&t<Lt[n].priority;n++);Lt.splice(n,0,e),0===n&&Bt(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ut(t.pendingLanes);0!==n&&(vt(t,1|n),rc(t,$e()),0===(6&zl)&&(Hl=$e()+500,Ha()))}break;case 13:dc(function(){var t=Ri(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}}),Vc(e,1)}},St=function(e){if(13===e.tag){var t=Ri(e,134217728);if(null!==t)nc(t,e,134217728,ec());Vc(e,134217728)}},kt=function(e){if(13===e.tag){var t=tc(e),n=Ri(e,t);if(null!==n)nc(n,e,t,ec());Vc(e,t)}},Ct=function(){return bt},jt=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},Se=function(e,t,n){switch(t){case"input":if(Q(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=wa(r);if(!a)throw Error(i(90));Y(r),Q(r,a)}}}break;case"textarea":ie(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},ze=cc,Me=dc;var ed={usingClientEntryPoint:!1,Events:[ba,xa,wa,Te,Ee,cc]},td={findFiberByHostInstance:va,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nd={bundleType:td.bundleType,version:td.version,rendererPackageName:td.rendererPackageName,rendererConfig:td.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ge(e))?null:e.stateNode},findFiberByHostInstance:td.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var rd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rd.isDisabled&&rd.supportsFiber)try{at=rd.inject(nd),it=rd}catch(de){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ed,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Xc(t))throw Error(i(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:S,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Xc(e))throw Error(i(299));var n=!1,r="",a=Yc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=Fc(e,1,!1,null,0,n,0,r,a),e[ga]=t.current,Hr(8===e.nodeType?e.parentNode:e),new Kc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=Ge(t))?null:e.stateNode},t.flushSync=function(e){return dc(e)},t.hydrate=function(e,t,n){if(!$c(t))throw Error(i(200));return Zc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Xc(e))throw Error(i(405));var r=null!=n&&n.hydratedSources||null,a=!1,o="",s=Yc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=Hc(t,null,e,1,null!=n?n:null,a,0,o,s),e[ga]=t.current,Hr(e),r)for(e=0;e<r.length;e++)a=(a=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Jc(t)},t.render=function(e,t,n){if(!$c(t))throw Error(i(200));return Zc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!$c(e))throw Error(i(40));return!!e._reactRootContainer&&(dc(function(){Zc(null,null,e,!1,function(){e._reactRootContainer=null,e[ga]=null})}),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!$c(n))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return Zc(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},853:(e,t,n)=>{e.exports=n(234)},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function a(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function i(e,t,n){return(t=a(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach(function(t){i(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var l=n(43),c=n(391);async function d(e){try{const{gender:t,species:n,archetype:r,decorations:a=[],size:i={width:300,height:380}}=e,o=[],s=u("portraits-new/base/".concat(t,"/neutral.png"));o.push({type:"base",src:s,zIndex:1});const l=u("portraits-new/race/".concat(n,".png"));o.push({type:"race",src:l,zIndex:2});const c=u("portraits-new/class/".concat(r,".png"));o.push({type:"class",src:c,zIndex:3}),a.forEach((e,t)=>{const n=u("portraits-new/deco/".concat(e,".png"));o.push({type:"deco",src:n,zIndex:10+t})});const d=await async function(e,t){return new Promise((n,r)=>{const a=document.createElement("canvas"),i=a.getContext("2d");if(!i)return void r(new Error("Canvas context not available"));a.width=t.width,a.height=t.height;const o=e.sort((e,t)=>e.zIndex-t.zIndex).map(e=>function(e,t,n){return new Promise(r=>{const a=new Image;a.onload=()=>{try{const t=Math.min(n.width/a.width,n.height/a.height),i=a.width*t,o=a.height*t,s=(n.width-i)/2,l=(n.height-o)/2;e.drawImage(a,s,l,i,o),r()}catch(t){r()}},a.onerror=()=>{r()},a.src=t.src})}(i,e,t));Promise.all(o).then(()=>{const e=a.toDataURL("image/png");n(e)}).catch(r)})}(o,i);return{success:!0,layers:o,dataUrl:d}}catch(t){return{success:!1,layers:[],error:t instanceof Error?t.message:"Unknown error"}}}function u(e){return"".concat("/World-Engine","/assets/").concat(e)}const h=new Map;var p=n(579);const g={small:{width:120,height:152},medium:{width:200,height:253},large:{width:300,height:380}},f=e=>{let{gender:t,species:n,archetype:r,decorations:a=[],size:i="medium",className:o="",showDebug:s=!1}=e;const[c,u]=(0,l.useState)(null),[f,m]=(0,l.useState)(!1),[y,v]=(0,l.useState)(!1),b=g[i],x=(0,l.useCallback)(async()=>{m(!0);const e={gender:t,species:n,archetype:r,decorations:a,size:b},i=function(e){const t=JSON.stringify(e);return h.get(t)||null}(e);if(i)return u({success:!0,layers:[],dataUrl:i}),void m(!1);try{const t=await d(e);t.success&&t.dataUrl&&function(e,t){const n=JSON.stringify(e);h.set(n,t)}(e,t.dataUrl),u(t)}catch(o){console.error("\ud83c\udfad Portrait generation error:",o),u({success:!1,layers:[],error:o instanceof Error?o.message:"Unknown error"})}finally{m(!1)}},[t,n,r,a,b]);(0,l.useEffect)(()=>{x()},[x]);return(0,p.jsxs)("div",{className:"relative inline-block ".concat(o),children:[f?(0,p.jsx)("div",{className:"flex items-center justify-center bg-gray-200 rounded",style:{width:b.width,height:b.height},children:(0,p.jsx)("div",{className:"text-gray-500",children:"Loading..."})}):c&&c.success&&c.dataUrl?(0,p.jsx)("img",{src:c.dataUrl,alt:"".concat(n," ").concat(r," portrait"),className:"rounded border border-gray-300",style:{width:b.width,height:b.height},onError:e=>{console.error("\ud83c\udfad Portrait image failed to display")}}):(0,p.jsx)("div",{className:"flex items-center justify-center bg-gray-200 rounded border-2 border-dashed border-gray-400",style:{width:b.width,height:b.height},children:(0,p.jsxs)("div",{className:"text-gray-500 text-center p-2",children:[(0,p.jsx)("div",{children:"Portrait Failed"}),(null===c||void 0===c?void 0:c.error)&&(0,p.jsx)("div",{className:"text-xs mt-1",children:c.error})]})}),s&&(0,p.jsx)("button",{onClick:()=>{v(!y)},className:"absolute top-1 right-1 w-6 h-6 bg-blue-500 text-white rounded-full text-xs hover:bg-blue-600 transition-colors",title:"Toggle debug info",children:"\ud83d\udc1e"}),y&&c?(0,p.jsxs)("div",{className:"absolute top-0 left-0 w-full h-full bg-black bg-opacity-75 text-white text-xs p-2 overflow-auto",children:[(0,p.jsx)("div",{className:"font-bold mb-2",children:"\ud83d\udc1e Portrait Debug"}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Status:"})," ",c.success?"\u2705 Success":"\u274c Failed"]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Gender:"})," ",t]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Species:"})," ",n]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Archetype:"})," ",r]}),a.length>0&&(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Decorations:"})," ",a.join(", ")]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Size:"})," ",b.width,"\xd7",b.height]}),c.success&&c.layers&&(0,p.jsxs)("div",{className:"mt-2",children:[(0,p.jsxs)("strong",{children:["Layers (",c.layers.length,"):"]}),c.layers.map((e,t)=>(0,p.jsxs)("div",{className:"ml-2 text-xs",children:["\u2022 ",e.type," (z:",e.zIndex,")"]},t))]}),c.error&&(0,p.jsxs)("div",{className:"mt-2 text-red-300",children:[(0,p.jsx)("strong",{children:"Error:"})," ",c.error]})]}):null]})};const m=new class{constructor(){this.assets=new Map,this.manifest=null,this.loadingPromise=null}async initialize(){return this.loadingPromise||(this.loadingPromise=this.loadManifest()),this.loadingPromise}async loadManifest(){try{const e="/World-Engine".replace(/\/+$/,""),t=new URL("".concat(e,"/assets/portraits/manifest.json"),window.location.origin).toString();console.log("Loading portrait manifest from:",t);const n=await fetch(t,{cache:"no-store"});if(!n.ok)return console.warn("Portrait manifest not found, using empty asset system"),void this.initializeEmptyManifest();this.manifest=await n.json(),console.log("Portrait manifest loaded:",this.manifest),this.indexAssets()}catch(e){console.warn("Failed to load portrait manifest:",e),this.initializeEmptyManifest()}}initializeEmptyManifest(){this.manifest={version:"1.0.0",lastUpdated:(new Date).toISOString(),assets:[],categories:["base","hair","eyes","clothing","accessories"],species:["Human","Sylvanborn","Nightborn","Stormcaller","Crystalborn","Draketh","Alloy","Voidkin"],archetypes:["Warrior","Scout","Mage","Guardian","Ranger","Rogue","Artificer","Thorn Knight","Ashblade","Ironclad","Stormbreaker","Voidhunter","Crystal Guardian","Greenwarden"]}}indexAssets(){if(this.manifest){this.assets.clear();for(const e of this.manifest.assets)this.assets.set(e.id,e)}}getAssetsByCategory(e){return Array.from(this.assets.values()).filter(t=>t.category===e)}getAssetsForSpecies(e){return Array.from(this.assets.values()).filter(t=>!t.species||t.species.includes(e))}getAssetsForArchetype(e){return Array.from(this.assets.values()).filter(t=>!t.archetype||t.archetype.includes(e))}getFilteredAssets(e){return Array.from(this.assets.values()).filter(t=>{if(e.category&&t.category!==e.category)return!1;if(e.species&&t.species&&!t.species.includes(e.species))return!1;if(e.archetype&&t.archetype&&!t.archetype.includes(e.archetype))return!1;if(e.tags&&t.tags){if(!e.tags.some(e=>t.tags.includes(e)))return!1}return!0})}getAsset(e){return this.assets.get(e)}assetUrl(e){const t=window.location.origin,n="/World-Engine".replace(/\/+$/,""),r="".concat(n,"/assets/portraits/"),a=e.replace(/^\/+/,"");return new URL("".concat(r).concat(a),t).toString()}getAssetUrl(e){return this.assetUrl(e.path)}async loadAssetContent(e){try{const t=this.getAssetUrl(e);console.log("\ud83d\udd0d ASSET MANAGER: Loading asset content from:",t);const n=await fetch(t,{cache:"no-store"});if(!n.ok)throw new Error("".concat(n.status," ").concat(n.statusText," - ").concat(t));const r=await n.text();if(!/^<svg[\s>]/i.test(r.trim()))throw new Error("Not an SVG at ".concat(t,": ").concat(r.slice(0,80),"\u2026"));return r}catch(t){return console.error("\ud83d\udca5 ASSET MANAGER: Failed to load asset ".concat(e.id,":"),t),""}}getCategories(){var e;return(null===(e=this.manifest)||void 0===e?void 0:e.categories)||[]}getSupportedSpecies(){var e;return(null===(e=this.manifest)||void 0===e?void 0:e.species)||[]}getSupportedArchetypes(){var e;return(null===(e=this.manifest)||void 0===e?void 0:e.archetypes)||[]}isLoaded(){return null!==this.manifest}getStats(){var e;return{totalAssets:this.assets.size,categories:this.getCategories().length,species:this.getSupportedSpecies().length,archetypes:this.getSupportedArchetypes().length,version:(null===(e=this.manifest)||void 0===e?void 0:e.version)||"unknown"}}};async function y(){await m.initialize()}const v={Warrior:{archetype:"Warrior",colorPalette:{primary:"#8B4513",secondary:"#C0C0C0",accent:"#DAA520",metal:"#C0C0C0"},preferredAssets:{armor:["leather","chainmail","plate"],weapons:["sword","axe","mace"],accessories:["belt","bracers","cloak"]},visualTraits:{build:"muscular",stance:"alert",aura:"none"},description:"Sturdy and practical, with well-worn equipment"},Scout:{archetype:"Scout",colorPalette:{primary:"#228B22",secondary:"#8B4513",accent:"#2F4F4F",metal:"#696969"},preferredAssets:{armor:["leather","studded"],weapons:["bow","dagger","shortbow"],accessories:["quiver","pouch","cloak"]},visualTraits:{build:"slim",stance:"alert",aura:"none"},description:"Practical outdoor gear in earth tones"},Mage:{archetype:"Mage",colorPalette:{primary:"#4B0082",secondary:"#191970",accent:"#FFD700",metal:"#DAA520"},preferredAssets:{armor:["robes","light"],weapons:["staff","wand","tome"],accessories:["amulet","ring","sash"]},visualTraits:{build:"average",stance:"scholarly",aura:"magical"},description:"Flowing robes with mystical accessories"},Guardian:{archetype:"Guardian",colorPalette:{primary:"#4682B4",secondary:"#C0C0C0",accent:"#FFD700",metal:"#C0C0C0"},preferredAssets:{armor:["plate","scale","chainmail"],weapons:["shield","sword","mace"],accessories:["cloak","symbol","bracers"]},visualTraits:{build:"stocky",stance:"alert",aura:"divine"},description:"Heavy armor with protective symbols"},Ranger:{archetype:"Ranger",colorPalette:{primary:"#8FBC8F",secondary:"#8B4513",accent:"#2E8B57",metal:"#696969"},preferredAssets:{armor:["leather","hide"],weapons:["bow","sword","knife"],accessories:["quiver","pack","cloak"]},visualTraits:{build:"average",stance:"relaxed",aura:"primal"},description:"Nature-themed gear with practical design"},Rogue:{archetype:"Rogue",colorPalette:{primary:"#2F2F2F",secondary:"#000000",accent:"#8B0000",metal:"#696969"},preferredAssets:{armor:["leather","light"],weapons:["dagger","shortsword","crossbow"],accessories:["belt","gloves","hood"]},visualTraits:{build:"slim",stance:"alert",aura:"none"},description:"Dark, practical clothing for stealth"},Artificer:{archetype:"Artificer",colorPalette:{primary:"#CD853F",secondary:"#B8860B",accent:"#00CED1",metal:"#B87333"},preferredAssets:{armor:["leather","studded","scale"],weapons:["crossbow","hammer","gadget"],accessories:["goggles","tools","pouches"]},visualTraits:{build:"average",stance:"scholarly",aura:"technological"},description:"Practical gear with technological enhancements"}};function b(e){return v[e]||null}class x{constructor(e){this.seed=void 0,this.current=void 0,this.seed="string"===typeof e?this.hashString(e):e,this.current=this.seed}hashString(e){let t=0;for(let n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t&=t}return Math.abs(t)}random(){const e=Math.pow(2,32);return this.current=(1664525*this.current+1013904223)%e,this.current/e}randomInt(e,t){return Math.floor(this.random()*(t-e))+e}choose(e){if(0===e.length)throw new Error("Cannot choose from empty array");return e[this.randomInt(0,e.length)]}shuffle(e){const t=[...e];for(let n=t.length-1;n>0;n--){const e=this.randomInt(0,n+1);[t[n],t[e]]=[t[e],t[n]]}return t}weightedChoose(e){const t=e.reduce((e,t)=>e+t.weight,0);let n=this.random()*t;for(const{item:r,weight:a}of e)if(n-=a,n<=0)return r;return e[e.length-1].item}reset(){this.current=this.seed}}function w(e){return"".concat(e.name,"_").concat(e.species,"_").concat(e.archetype,"_").concat(e.level||1)}function S(e){const t=w(e);return new x(t)}const k={forSpecies(e,t){const n={Human:{skinTone:t.choose(["fair","light","medium","olive","tan","dark"]),hairColor:t.choose(["blonde","brown","black","red","auburn"]),eyeColor:t.choose(["blue","brown","green","hazel","gray"])},Sylvanborn:{skinTone:t.choose(["fair","pale-green","bark-brown","olive"]),hairColor:t.choose(["green","brown","autumn-red","silver"]),eyeColor:t.choose(["green","gold","amber","forest-green"])},Nightborn:{skinTone:t.choose(["pale","ashen","moonlight","silver-pale"]),hairColor:t.choose(["black","silver","white","midnight-blue"]),eyeColor:t.choose(["violet","silver","pale-blue","starlight"])},Stormcaller:{skinTone:t.choose(["bronzed","storm-gray","sky-blue","medium"]),hairColor:t.choose(["white","silver","storm-gray","lightning-blue"]),eyeColor:t.choose(["blue","electric-blue","storm-gray","silver"])},Crystalborn:{skinTone:t.choose(["crystalline","translucent","prismatic","gem-like"]),hairColor:t.choose(["crystal","prismatic","diamond","sapphire"]),eyeColor:t.choose(["prismatic","crystal-blue","emerald","diamond"])},Draketh:{skinTone:t.choose(["scaled-red","scaled-green","scaled-blue","scaled-gold"]),hairColor:t.choose(["red","gold","copper","bronze"]),eyeColor:t.choose(["gold","amber","red","copper"])},Alloy:{skinTone:t.choose(["metallic","bronze","copper","steel-gray"]),hairColor:t.choose(["copper","bronze","steel","chrome"]),eyeColor:t.choose(["silver","copper","steel-blue","chrome"])},Voidkin:{skinTone:t.choose(["void-black","starlight","nebula","cosmic"]),hairColor:t.choose(["void-black","starlight","nebula","cosmic"]),eyeColor:t.choose(["starlight","void-black","nebula","cosmic"])}};return n[e]||n.Human}},C={Human:{Greenwarden:[{category:"base",path:"base/human.svg",zIndex:1},{category:"face/eyes",path:"face/eyes/eyes_sharp.svg",zIndex:15,optional:!0},{category:"face/brows",path:"face/brows/brows_thick.svg",zIndex:16,optional:!0},{category:"face/mouth",path:"face/mouth/mouth_neutral.svg",zIndex:17,optional:!0},{category:"hair",path:"hair/short_straight.svg",zIndex:30,variants:["hair/short_straight.svg","hair/topknot.svg","hair/undercut.svg"]},{category:"clothing/verdance",path:"clothing/verdance/greenwarden.svg",zIndex:20},{category:"weapons",path:"weapons/greenwarden_spear.svg",zIndex:50,optional:!0},{category:"accessories",path:"accessories/leaf_circlet.svg",zIndex:35,optional:!0}],"Thorn Knight":[{category:"base",path:"base/human.svg",zIndex:1},{category:"face/eyes",path:"face/eyes/eyes_heavy.svg",zIndex:15,optional:!0},{category:"face/brows",path:"face/brows/brows_thick.svg",zIndex:16,optional:!0},{category:"hair",path:"hair/short_straight.svg",zIndex:30,variants:["hair/short_straight.svg","hair/undercut.svg"]},{category:"clothing/verdance",path:"clothing/verdance/thorn_knight.svg",zIndex:20},{category:"weapons",path:"weapons/thorn_knight_morningstar.svg",zIndex:50,optional:!0}],"Sapling Adept":[{category:"base",path:"base/human.svg",zIndex:1},{category:"face/eyes",path:"face/eyes/eyes_round.svg",zIndex:15,optional:!0},{category:"hair",path:"hair/long_wavy.svg",zIndex:30,variants:["hair/long_wavy.svg","hair/curly.svg"]},{category:"clothing/verdance",path:"clothing/verdance/sapling_adept.svg",zIndex:20},{category:"weapons",path:"weapons/sapling_adept_staff.svg",zIndex:50,optional:!0},{category:"effects",path:"effects/aura_verdance.svg",zIndex:60,optional:!0}],Bloomcaller:[{category:"base",path:"base/human.svg",zIndex:1},{category:"face/eyes",path:"face/eyes/eyes_glow.svg",zIndex:15,optional:!0},{category:"hair",path:"hair/long_wavy.svg",zIndex:30,variants:["hair/long_wavy.svg","hair/curly.svg"]},{category:"clothing/verdance",path:"clothing/verdance/bloomcaller.svg",zIndex:20},{category:"weapons",path:"weapons/bloomcaller_rod.svg",zIndex:50,optional:!0},{category:"effects",path:"effects/aura_verdance.svg",zIndex:60,optional:!0}],Ashblade:[{category:"base",path:"base/human.svg",zIndex:1},{category:"face/eyes",path:"face/eyes/eyes_sharp.svg",zIndex:15,optional:!0},{category:"hair",path:"hair/short_straight.svg",zIndex:30,variants:["hair/short_straight.svg","hair/undercut.svg"]},{category:"clothing/ashenreach",path:"clothing/ashenreach/ashblade.svg",zIndex:20},{category:"weapons",path:"weapons/ashblade_sword.svg",zIndex:50,optional:!0},{category:"effects",path:"effects/aura_ashenreach.svg",zIndex:60,optional:!0}],"Cinder Mystic":[{category:"base",path:"base/human.svg",zIndex:1},{category:"face/eyes",path:"face/eyes/eyes_glow.svg",zIndex:15,optional:!0},{category:"hair",path:"hair/long_wavy.svg",zIndex:30,variants:["hair/long_wavy.svg","hair/curly.svg"]},{category:"clothing/ashenreach",path:"clothing/ashenreach/cinder_mystic.svg",zIndex:20},{category:"weapons",path:"weapons/cinder_mystic_staff.svg",zIndex:50,optional:!0},{category:"effects",path:"effects/aura_ashenreach.svg",zIndex:60,optional:!0}],"Dust Ranger":[{category:"base",path:"base/human.svg",zIndex:1},{category:"face/eyes",path:"face/eyes/eyes_sharp.svg",zIndex:15,optional:!0},{category:"hair",path:"hair/short_straight.svg",zIndex:30,variants:["hair/short_straight.svg","hair/shaved.svg"]},{category:"clothing/ashenreach",path:"clothing/ashenreach/dust_ranger.svg",zIndex:20},{category:"weapons",path:"weapons/dust_ranger_bow.svg",zIndex:50,optional:!0}],Bonechanter:[{category:"base",path:"base/human.svg",zIndex:1},{category:"face/eyes",path:"face/eyes/eyes_glow.svg",zIndex:15,optional:!0},{category:"hair",path:"hair/locs.svg",zIndex:30,variants:["hair/locs.svg","hair/long_wavy.svg"]},{category:"clothing/ashenreach",path:"clothing/ashenreach/bonechanter.svg",zIndex:20},{category:"weapons",path:"weapons/bonechanter_totem.svg",zIndex:50,optional:!0},{category:"accessories",path:"accessories/bone_charm.svg",zIndex:35,optional:!0}],Stormcaller:[{category:"base",path:"base/human.svg",zIndex:1},{category:"face/eyes",path:"face/eyes/eyes_glow.svg",zIndex:15,optional:!0},{category:"hair",path:"hair/long_wavy.svg",zIndex:30,variants:["hair/long_wavy.svg","hair/curly.svg"]},{category:"clothing/skyvault",path:"clothing/skyvault/stormcaller_cls.svg",zIndex:20},{category:"weapons",path:"weapons/stormcaller_cls_staff.svg",zIndex:50,optional:!0},{category:"accessories",path:"accessories/storm_goggles.svg",zIndex:35,optional:!0},{category:"effects",path:"effects/aura_storm.svg",zIndex:60,optional:!0}],Voidwing:[{category:"base",path:"base/human.svg",zIndex:1},{category:"face/eyes",path:"face/eyes/eyes_sharp.svg",zIndex:15,optional:!0},{category:"hair",path:"hair/undercut.svg",zIndex:30,variants:["hair/undercut.svg","hair/short_straight.svg"]},{category:"clothing/skyvault",path:"clothing/skyvault/voidwing.svg",zIndex:20},{category:"weapons",path:"weapons/voidwing_daggers.svg",zIndex:50,optional:!0},{category:"accessories",path:"accessories/feather_cloak.svg",zIndex:25,optional:!0},{category:"effects",path:"effects/aura_void.svg",zIndex:60,optional:!0}],"Sky Knight":[{category:"base",path:"base/human.svg",zIndex:1},{category:"face/eyes",path:"face/eyes/eyes_heavy.svg",zIndex:15,optional:!0},{category:"hair",path:"hair/short_straight.svg",zIndex:30,variants:["hair/short_straight.svg","hair/topknot.svg"]},{category:"clothing/skyvault",path:"clothing/skyvault/sky_knight.svg",zIndex:20},{category:"weapons",path:"weapons/sky_knight_lance.svg",zIndex:50,optional:!0},{category:"effects",path:"effects/aura_skyvault.svg",zIndex:60,optional:!0}],"Wind Sage":[{category:"base",path:"base/human.svg",zIndex:1},{category:"face/eyes",path:"face/eyes/eyes_round.svg",zIndex:15,optional:!0},{category:"hair",path:"hair/long_wavy.svg",zIndex:30,variants:["hair/long_wavy.svg","hair/topknot.svg"]},{category:"clothing/skyvault",path:"clothing/skyvault/wind_sage.svg",zIndex:20},{category:"weapons",path:"weapons/wind_sage_fan.svg",zIndex:50,optional:!0},{category:"effects",path:"effects/aura_skyvault.svg",zIndex:60,optional:!0}]},Draketh:{Greenwarden:[{category:"base",path:"base/draketh.svg",zIndex:1},{category:"clothing/verdance",path:"clothing/verdance/greenwarden.svg",zIndex:20},{category:"weapons",path:"weapons/greenwarden_spear.svg",zIndex:50,optional:!0}],"Thorn Knight":[{category:"base",path:"base/draketh.svg",zIndex:1},{category:"clothing/verdance",path:"clothing/verdance/thorn_knight.svg",zIndex:20},{category:"weapons",path:"weapons/thorn_knight_morningstar.svg",zIndex:50,optional:!0}]},Sylvanborn:{Greenwarden:[{category:"base",path:"base/sylvanborn.svg",zIndex:1},{category:"clothing/verdance",path:"clothing/verdance/greenwarden.svg",zIndex:20},{category:"weapons",path:"weapons/greenwarden_spear.svg",zIndex:50,optional:!0},{category:"effects",path:"effects/aura_verdance.svg",zIndex:60,optional:!0}],"Thorn Knight":[{category:"base",path:"base/sylvanborn.svg",zIndex:1},{category:"clothing/verdance",path:"clothing/verdance/thorn_knight.svg",zIndex:20},{category:"weapons",path:"weapons/thorn_knight_morningstar.svg",zIndex:50,optional:!0}]}};function j(e,t){const n=C[e];if(!n){const n=[{category:"base",path:"base/".concat((e||"human").toLowerCase(),".svg"),zIndex:1}],r=["Ashblade","Cinder Mystic","Dust Ranger","Bonechanter"],a=["Stormcaller","Voidwing","Sky Knight","Wind Sage"];let i="";return["Greenwarden","Thorn Knight","Sapling Adept","Bloomcaller"].includes(t)?i="verdance":r.includes(t)?i="ashenreach":a.includes(t)&&(i="skyvault"),i&&n.push({category:"clothing/".concat(i),path:"clothing/".concat(i,"/").concat((t||"warrior").toLowerCase().replace(/ /g,"_"),".svg"),zIndex:20}),n}const r=n[t];return r||(n.Greenwarden||n["Thorn Knight"]||[])}async function T(e,t,n){console.log("\ud83c\udfa8 MANIFEST: loadLayeredPortrait called for ".concat(e," ").concat(t," (").concat(n,")"));const r=j(e,t);if(console.log("\ud83c\udfa8 MANIFEST: Found ".concat(r.length," layers:"),r),0===r.length)return console.warn("\u26a0\ufe0f MANIFEST: No layers found for ".concat(e," ").concat(t,", using fallback")),'<svg width="300" height="380" viewBox="0 0 300 380" xmlns="http://www.w3.org/2000/svg"><rect width="100%" height="100%" fill="#374151"/><text x="150" y="190" text-anchor="middle" fill="#9ca3af" font-size="14">No Portrait</text></svg>';try{const i=[...r].sort((e,t)=>e.zIndex-t.zIndex),o=[];for(const r of i)try{let a=r.path;if(r.variants&&r.variants.length>0)if(n){const e=n.split("").reduce((e,t)=>e+t.charCodeAt(0),0);a=r.variants[e%r.variants.length]}else a=r.variants[Math.floor(Math.random()*r.variants.length)];const i=await m.loadAssetContent({path:a,category:r.category,id:"".concat(e,"_").concat(t,"_").concat(r.category)});i?o.push(i):r.optional||console.warn("Failed to load required layer: ".concat(a))}catch(a){r.optional||console.error("Error loading layer ".concat(r.path,":"),a)}const s=function(e){const t=[];for(const n of e){if(!n.trim())continue;const e=n.match(/<svg[^>]*>([\s\S]*?)<\/svg>/);e&&e[1]&&t.push(e[1].trim())}return'<svg width="300" height="380" viewBox="0 0 300 380" xmlns="http://www.w3.org/2000/svg">\n        '.concat(t.join("\n"),"\n    </svg>")}(o);return s}catch(a){return console.error("Error creating layered portrait:",a),'<svg width="300" height="380" viewBox="0 0 300 380" xmlns="http://www.w3.org/2000/svg"><rect width="100%" height="100%" fill="#ef4444" opacity="0.2"/><text x="150" y="190" text-anchor="middle" fill="#dc2626" font-size="14">Error Loading</text></svg>'}}async function E(e,t){try{var n;console.log("\ud83c\udfa8 Loading portrait from external manifest: ".concat(e," ").concat(t));const r=await async function(){try{const e="/World-Engine".replace(/\/+$/,""),t=new URL("".concat(e,"/assets/portraits/manifest.json"),window.location.origin).toString();console.log("\ufffd Fetching external manifest from:",t);const n=await fetch(t,{cache:"no-store"});if(console.log("\ud83d\udce1 Response status:",n.status,n.statusText),!n.ok)throw new Error("HTTP ".concat(n.status,": ").concat(n.statusText));const r=await n.text();if(console.log("\ud83d\udcc4 Response preview:",r.substring(0,100)),r.startsWith("<!DOCTYPE")||r.startsWith("<html"))throw new Error("Received HTML instead of JSON - possible routing issue");const a=JSON.parse(r);return console.log("\u2705 External manifest loaded successfully:",a.version),a}catch(e){return null}}();if(!r)return console.log("External manifest not available, falling back to internal"),T(e,t);const a=null===(n=r.species)||void 0===n?void 0:n.find(t=>{var n;return(null===t||void 0===t||null===(n=t.name)||void 0===n?void 0:n.toLowerCase())===(null===e||void 0===e?void 0:e.toLowerCase())});if(!a)return console.warn("Species ".concat(e," not found in external manifest")),T(e,t);const i=[];i.push({category:"base",path:"base/".concat((a.name||e).toLowerCase(),".svg"),zIndex:1}),r.categories.face&&Object.keys(r.categories.face).forEach((e,t)=>{const n=r.categories.face[e];n.length>0&&i.push({category:"face/".concat(e),path:n[0],zIndex:15+t,optional:!0})}),r.categories.hair&&r.categories.hair.length>0&&i.push({category:"hair",path:r.categories.hair[0],zIndex:30,variants:r.categories.hair});const o=function(e,t){const n=["Ashblade","Cinder Mystic","Dust Ranger","Bonechanter"],r=["Stormcaller","Voidwing","Sky Knight","Wind Sage"];let a="";["Greenwarden","Thorn Knight","Sapling Adept","Bloomcaller"].includes(e)?a="verdance":n.includes(e)?a="ashenreach":r.includes(e)&&(a="skyvault");if(!a)return null;const i="clothing/".concat(a);if(t.categories.clothing&&t.categories.clothing[a]){const n=t.categories.clothing[a].find(t=>t.includes((e||"warrior").toLowerCase().replace(" ","_")));if(n)return{category:i,path:n}}return null}(t,r);o&&i.push({category:o.category,path:o.path,zIndex:20});const s=function(e,t){const n=[];if(t.categories.weapons){const r=t.categories.weapons.find(t=>t.includes((e||"warrior").toLowerCase().replace(" ","_")));r&&n.push({category:"weapons",path:r,zIndex:50,optional:!0})}if(t.categories.accessories){const r=t.categories.accessories.find(t=>t.includes((e||"warrior").toLowerCase().replace(" ","_")));r&&n.push({category:"accessories",path:r,zIndex:35,optional:!0})}if(t.categories.effects){const r=t.categories.effects.find(t=>t.includes((e||"warrior").toLowerCase().replace(" ","_")));r&&n.push({category:"effects",path:r,zIndex:60,optional:!0})}return n}(t,r);i.push(...s);const l=i.sort((e,t)=>e.zIndex-t.zIndex);return await z(l)}catch(r){return console.error("Error loading from external manifest:",r),T(e,t)}}async function z(e){let t="";for(const r of e)try{const e="/World-Engine".replace(/\/+$/,""),n=new URL("".concat(e,"/assets/portraits/").concat(r.path),window.location.origin).toString(),a=await fetch(n,{cache:"no-store"});if(!a.ok){console.warn("Failed to load asset: ".concat(n));continue}const i=(await a.text()).match(/<svg[^>]*>([\s\S]*)<\/svg>/);i&&(t+=i[1])}catch(n){console.warn("Error loading layer ".concat(r.path,":"),n)}return'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 400" width="300" height="400">\n        '.concat(t,"\n    </svg>")}async function M(){try{const e="/World-Engine".replace(/\/+$/,""),t=new URL("".concat(e,"/assets/portraits/presets.json"),window.location.origin).toString();console.log("\ufffd Fetching presets from:",t);const n=await fetch(t,{cache:"no-store"});if(console.log("\ud83d\udce1 Presets response status:",n.status,n.statusText),!n.ok)throw new Error("HTTP ".concat(n.status,": ").concat(n.statusText));const r=await n.text();if(console.log("\ud83d\udcc4 Presets response preview:",r.substring(0,100)),r.startsWith("<!DOCTYPE")||r.startsWith("<html"))throw new Error("Received HTML instead of JSON - possible routing issue");return JSON.parse(r).presets||[]}catch(e){return[]}}async function I(e){try{const t=await async function(e){return(await M()).find(t=>t.id===e)||null}(e);if(!t)throw new Error("Preset not found: ".concat(e));console.log("\ud83c\udfad Loading portrait from preset: ".concat(t.label));const n=function(e){const t={base:1,"face/eyes":15,"face/brows":16,"face/mouth":17,hair:30,facial_hair:25,clothing:20,accessories:35,weapons:50,effects:60};return e.layers.map((e,n)=>{const r=e.split("/")[0];return{category:e.includes("/")?e.split("/").slice(0,2).join("/"):r,path:e,zIndex:t[r]||10+n,optional:!["base"].includes(r)}}).sort((e,t)=>e.zIndex-t.zIndex)}(t);return await z(n)}catch(t){return console.error("Error loading preset:",t),E(e.split("_")[0]||"Human",e.split("_")[2]||"Greenwarden")}}const _=new class{constructor(){this.layers=[],this.setupDefaultLayers()}setupDefaultLayers(){this.layers=[{name:"background",zIndex:0,render:this.renderBackground.bind(this)},{name:"body",zIndex:10,render:this.renderBody.bind(this)},{name:"clothing",zIndex:20,render:this.renderClothing.bind(this)},{name:"hair",zIndex:30,render:this.renderHair.bind(this)},{name:"face",zIndex:40,render:this.renderFace.bind(this)},{name:"accessories",zIndex:50,render:this.renderAccessories.bind(this)},{name:"effects",zIndex:60,render:this.renderEffects.bind(this)}],this.layers.sort((e,t)=>e.zIndex-t.zIndex)}async renderToCanvas(e,t,n){const r=n.getContext("2d");if(!r)throw new Error("Cannot get 2D context from canvas");this.setupCanvas(n,r,t);for(const i of this.layers)try{i.render(r,e)}catch(a){console.warn("Failed to render layer ".concat(i.name,":"),a)}return n}async renderToSVG(e,t){const n=this.getDimensions(t.size),r=await this.tryAssetBasedSVG(e,n);if(r)return r;let a='<svg width="'.concat(n.width,'" height="').concat(n.height,'" viewBox="0 0 ').concat(n.width," ").concat(n.height,'" xmlns="http://www.w3.org/2000/svg">');for(const o of this.layers)try{a+=this.renderLayerToSVG(o,e,n)}catch(i){console.warn("Failed to render SVG layer ".concat(o.name,":"),i)}return a+="</svg>",a}async tryAssetBasedSVG(e,t){const n=[e.species],r=function(e){const t={Sylvanborn:["Human"],Nightborn:["Human"],Stormcaller:["Human"],Crystalborn:["Human"],Draketh:["Human"],Alloy:["Human"],Voidkin:["Nightborn","Human"]};if(e in t)for(const n of t[e])return n;return"Human"}(e.species);r&&r!==e.species&&n.push(r),n.includes("Human")||n.push("Human");for(const i of n)try{const n=await this.trySpeciesAssets(i,e.archetype,e.gender);if(n){const r=b(e.archetype);let a=n;return r&&(a=this.applyThemeColors(a,r)),a=a.replace(/<svg([^>]*?)width=["'][^"']*["']([^>]*?)height=["'][^"']*["']/i,'<svg$1width="'.concat(t.width,'"$2height="').concat(t.height,'"')),a.includes("viewBox")||(a=a.replace(/<svg([^>]*?)>/i,'<svg$1 viewBox="0 0 '.concat(t.width," ").concat(t.height,'">'))),a}}catch(a){continue}return null}async trySpeciesAssets(e,t,n){try{const a={species:e,archetype:t,gender:n||"Female"},i=await async function(e){return(await M()).filter(t=>(!e.species||t.species===e.species)&&(!e.world||t.world===e.world)&&(!e.archetype||t.archetype===e.archetype)&&(!e.gender||t.gender===e.gender))}(a);if(i.length>0)return await I(i[0].id);try{return await E(e,t)}catch(r){return await T(e,t,"".concat(e," ").concat(t))}}catch(a){return null}}applyThemeColors(e,t){let n=e;return n=n.replace(/#4c1d95/g,t.colorPalette.primary),n=n.replace(/#6d28d9/g,t.colorPalette.secondary),n=n.replace(/#fbbf24/g,t.colorPalette.accent||t.colorPalette.primary),n}setupCanvas(e,t,n){const r=this.getDimensions(n.size);e.width=r.width,e.height=r.height,t.imageSmoothingEnabled="low"!==n.quality,t.imageSmoothingQuality="high"===n.quality?"high":"medium",t.clearRect(0,0,r.width,r.height)}getDimensions(e){const t={small:{width:64,height:64},medium:{width:128,height:128},large:{width:256,height:256}};return t[e]||t.medium}renderLayerToSVG(e,t,n){const r={innerHTML:"",appendChild:e=>{r.innerHTML+=e.outerHTML||e.toString()}};try{return e.render(r,t),r.innerHTML}catch(a){return console.warn("Error rendering ".concat(e.name," to SVG:"),a),""}}renderBackground(e,t){const n=b(t.archetype),r=(null===n||void 0===n?void 0:n.colorPalette.secondary)||"#f0f0f0";if(e instanceof CanvasRenderingContext2D){const t=e.canvas;e.fillStyle=r,e.fillRect(0,0,t.width,t.height)}else"innerHTML"in e&&(e.innerHTML+='<rect width="100%" height="100%" fill="'.concat(r,'" opacity="0.1"/>'))}renderBody(e,t){var n;b(t.archetype);const r=this.getSkinColor((null===(n=t.appearance)||void 0===n?void 0:n.skinTone)||"medium");if(e instanceof CanvasRenderingContext2D){const t=e.canvas,n=t.width/2,a=t.height/2,i=Math.min(t.width,t.height)/6;e.fillStyle=r,e.beginPath(),e.arc(n,a-i,i,0,2*Math.PI),e.fill(),e.fillRect(n-i/2,a,i,1.5*i)}else if("innerHTML"in e){var a;const n=this.getSkinColor((null===(a=t.appearance)||void 0===a?void 0:a.skinTone)||"medium");e.innerHTML+='\n          <circle cx="50%" cy="35%" r="15%" fill="'.concat(n,'"/>\n          <rect x="42.5%" y="50%" width="15%" height="25%" fill="').concat(n,'"/>\n        ')}}renderClothing(e,t){const n=b(t.archetype),r=(null===n||void 0===n?void 0:n.colorPalette.primary)||"#666";if(e instanceof CanvasRenderingContext2D){const t=e.canvas,n=t.width/2,a=t.height/2,i=t.width/3,o=t.height/4;e.fillStyle=r,e.fillRect(n-i/2,a+10,i,o)}else"innerHTML"in e&&(e.innerHTML+='<rect x="37.5%" y="55%" width="25%" height="30%" fill="'.concat(r,'"/>'))}renderHair(e,t){var n;const r=this.getHairColor((null===(n=t.appearance)||void 0===n?void 0:n.hairColor)||"brown");if(e instanceof CanvasRenderingContext2D){const t=e.canvas,n=t.width/2,a=t.height/2,i=Math.min(t.width,t.height)/5;e.fillStyle=r,e.beginPath(),e.arc(n,a-i-5,.8*i,0,Math.PI),e.fill()}else"innerHTML"in e&&(e.innerHTML+='\n          <path d="M 35% 25% Q 50% 15% 65% 25% Q 60% 30% 50% 30% Q 40% 30% 35% 25%" fill="'.concat(r,'"/>\n        '))}renderFace(e,t){var n;const r=this.getEyeColor((null===(n=t.appearance)||void 0===n?void 0:n.eyeColor)||"brown");if(e instanceof CanvasRenderingContext2D){const t=e.canvas,n=t.width/2,a=t.height/2,i=3,o=8;e.fillStyle=r,e.beginPath(),e.arc(n-o,a-20,i,0,2*Math.PI),e.arc(n+o,a-20,i,0,2*Math.PI),e.fill()}else"innerHTML"in e&&(e.innerHTML+='\n          <circle cx="45%" cy="32%" r="2%" fill="'.concat(r,'"/>\n          <circle cx="55%" cy="32%" r="2%" fill="').concat(r,'"/>\n          <path d="M 47% 38% Q 50% 40% 53% 38%" stroke="#333" stroke-width="1" fill="none"/>\n        '))}renderAccessories(e,t){}renderEffects(e,t){const n=b(t.archetype),r=null===n||void 0===n?void 0:n.visualTraits.aura;if("magical"===r||"divine"===r){const t="magical"===r?"#4B0082":"#DAA520";if(e instanceof CanvasRenderingContext2D){const n=e.canvas,r=n.width/2,a=n.height/2;e.strokeStyle=t,e.globalAlpha=.3,e.lineWidth=2,e.beginPath(),e.arc(r,a,n.width/3,0,2*Math.PI),e.stroke(),e.globalAlpha=1}else"innerHTML"in e&&(e.innerHTML+='\n            <circle cx="50%" cy="50%" r="35%" stroke="'.concat(t,'" stroke-width="2" fill="none" opacity="0.3"/>\n          '))}}getSkinColor(e){const t={fair:"#FDBCB4",light:"#EDB98A",medium:"#C68642",olive:"#A0785A",tan:"#8D5524",dark:"#654321",pale:"#F5DEB3",crystalline:"#E6E6FA",metallic:"#C0C0C0",scaled:"#8B4513"};return t[e]||t.medium}getHairColor(e){const t={blonde:"#FAD5A5",brown:"#8B4513",black:"#000000",red:"#B22222",auburn:"#A52A2A",green:"#228B22",silver:"#C0C0C0",white:"#F5F5F5",crystal:"#E6E6FA",copper:"#B87333"};return t[e]||t.brown}getEyeColor(e){const t={blue:"#4169E1",brown:"#8B4513",green:"#228B22",hazel:"#8E7618",gray:"#708090",violet:"#8B008B",gold:"#DAA520",amber:"#FFBF00",silver:"#C0C0C0"};return t[e]||t.brown}};new class{constructor(){this.plugins=new Map,this.initialized=!1}async initialize(){if(!this.initialized)try{await y(),this.registerDefaultPlugins(),this.initialized=!0,console.log("Visual service initialized")}catch(e){throw console.error("Failed to initialize visual service:",e),e}}registerDefaultPlugins(){this.registerPlugin({name:"2d-svg-renderer",version:"1.0.0",render:this.render2DSVGPortrait.bind(this),supports:()=>!0}),this.registerPlugin({name:"text-placeholder",version:"1.0.0",render:this.renderTextPlaceholder.bind(this),supports:()=>!0})}registerPlugin(e){this.plugins.set(e.name,e)}async generatePortrait(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{size:"medium",format:"svg"};const n=performance.now();try{this.initialized||await this.initialize();const r=this.enhanceCharacterData(e),a=this.findBestPlugin(r.species,r.archetype);if(!a)throw new Error("No suitable visual plugin found");const i=this.createRenderContext(t),o=await a.render(r,i);console.log("\ud83c\udfa8 VisualService: Plugin render result:",{resultType:typeof o,isString:"string"===typeof o,length:"string"===typeof o?o.length:"N/A",preview:"string"===typeof o?o.substring(0,100)+"...":o,isSVG:"string"===typeof o&&o.includes("<svg")});const s={success:!0,data:o,metadata:{renderTime:performance.now()-n,cacheKey:this.generateCacheKey(e,t),assets:this.getUsedAssets(r)}};return console.log("\ud83d\udce4 VisualService: Final result being returned:",{success:s.success,hasData:!!s.data,dataType:typeof s.data,renderTime:s.metadata.renderTime}),s}catch(r){const e=performance.now()-n;return{success:!1,error:r instanceof Error?r.message:"Unknown error",metadata:{renderTime:e,assets:[]}}}}enhanceCharacterData(e){const t=S(e),n=e.appearance||{},r=function(e,t){const n=b(t),r={Human:{skinTone:"medium",hairColor:"brown",eyeColor:"brown"},Sylvanborn:{skinTone:"fair",hairColor:"green",eyeColor:"green"},Nightborn:{skinTone:"pale",hairColor:"black",eyeColor:"violet"},Stormcaller:{skinTone:"medium",hairColor:"silver",eyeColor:"blue"},Crystalborn:{skinTone:"crystalline",hairColor:"crystal",eyeColor:"prismatic"},Draketh:{skinTone:"scaled",hairColor:"red",eyeColor:"gold"},Alloy:{skinTone:"metallic",hairColor:"copper",eyeColor:"silver"},Voidkin:{skinTone:"dark",hairColor:"void",eyeColor:"starlight"}};return s(s({},r[e]||r.Human),{},{build:(null===n||void 0===n?void 0:n.visualTraits.build)||"average",height:"average"})}(e.species,e.archetype),a=k.forSpecies(e.species,t);return s(s({},e),{},{appearance:s(s(s({},r),n),{},{skinTone:n.skinTone||a.skinTone,hairColor:n.hairColor||a.hairColor,eyeColor:n.eyeColor||a.eyeColor}),style:e.style||{artStyle:"stylized",colorScheme:"natural"}})}findBestPlugin(e,t){const n=Array.from(this.plugins.values());for(const r of n)if(r.supports(e,t))return r;return null}createRenderContext(e){return{options:e}}generateCacheKey(e,t){const n={name:e.name,species:e.species,archetype:e.archetype,level:e.level,appearance:e.appearance,size:t.size,format:t.format};return btoa(JSON.stringify(n))}getUsedAssets(e){const t=[],n=b(e.archetype);return null!==n&&void 0!==n&&n.preferredAssets&&Object.values(n.preferredAssets).flat().forEach(e=>{t.push(e)}),t}async render2DSVGPortrait(e,t){try{return await async function(e,t){return _.renderToSVG(e,t)}(e,t.options)}catch(n){return console.warn("2D SVG renderer failed, falling back to placeholder:",n),this.renderTextPlaceholder(e,t)}}async renderTextPlaceholder(e,t){const{size:n}=t.options,r={small:64,medium:128,large:256}[n]||128,a=b(e.archetype),i=(null===a||void 0===a?void 0:a.colorPalette.primary)||"#4a5568",o=(null===a||void 0===a?void 0:a.colorPalette.secondary)||"#718096";let s=i;return"Crystalborn"===e.species?s="#9f7aea":"Sylvanborn"===e.species?s="#38a169":"Nightborn"===e.species?s="#553c9a":"Stormcaller"===e.species?s="#3182ce":"Draketh"===e.species?s="#e53e3e":"Alloy"===e.species?s="#718096":"Voidkin"===e.species&&(s="#2d3748"),'\n      <svg width="'.concat(r,'" height="').concat(r,'" viewBox="0 0 ').concat(r," ").concat(r,'" xmlns="http://www.w3.org/2000/svg">\n        <defs>\n          <linearGradient id="bgGrad" x1="0%" y1="0%" x2="100%" y2="100%">\n            <stop offset="0%" style="stop-color:').concat(s,';stop-opacity:0.1"/>\n            <stop offset="100%" style="stop-color:').concat(o,';stop-opacity:0.2"/>\n          </linearGradient>\n        </defs>\n        <rect width="').concat(r,'" height="').concat(r,'" fill="url(#bgGrad)"/>\n        <circle cx="').concat(r/2,'" cy="').concat(.35*r,'" r="').concat(.12*r,'" fill="').concat(s,'" opacity="0.6"/>\n        <rect x="').concat(.3*r,'" y="').concat(.5*r,'" width="').concat(.4*r,'" height="').concat(.35*r,'" fill="').concat(s,'" opacity="0.4" rx="4"/>\n        <text x="').concat(r/2,'" y="').concat(.85*r,'" text-anchor="middle" font-family="Arial, sans-serif" font-size="').concat(.08*r,'" font-weight="bold" fill="').concat(s,'">\n          ').concat(e.name||"Character",'\n        </text>\n        <text x="').concat(r/2,'" y="').concat(.93*r,'" text-anchor="middle" font-family="Arial, sans-serif" font-size="').concat(.06*r,'" fill="').concat(o,'" opacity="0.8">\n          ').concat(e.species," ").concat(e.archetype,"\n        </text>\n      </svg>\n    ").trim()}getStats(){return{initialized:this.initialized,plugins:this.plugins.size,pluginNames:Array.from(this.plugins.keys()),assetStats:m.getStats()}}isReady(){return this.initialized&&m.isLoaded()}};const P=()=>["human","sylvanborn","alloy","draketh","voidkin","crystalborn","stormcaller_species"],L=()=>["greenwarden","thornknight","saplingadept","bloomcaller","ashblade","cindermystic","dustranger","bonechanter","stormcaller_class","voidwing","skyknight","windsage"],R=async()=>(console.log("\ud83c\udfad Testing simple portrait generation..."),d({gender:"male",species:"human",archetype:"greenwarden"})),A=async()=>{const e=P(),t=L(),n=["male","female"];console.log("\ud83c\udfad Testing ".concat(e.length,"\xd7").concat(t.length,"\xd7").concat(n.length," = ").concat(e.length*t.length*n.length," combinations..."));const r=[];for(const a of e.slice(0,2))for(const e of t.slice(0,2))for(const t of n){const n=await d({gender:t,species:a,archetype:e});r.push({species:a,archetype:e,gender:t,success:n.success})}return console.log("\ud83c\udfad Test results:",r),r};function N(e){let{onNewCampaign:t,onLoadCampaign:n,onNameGenerator:r,onSpellGenerator:a,onSpellAssignment:i,onHealingSystem:o,onCharacterCreate:c,onPortraitTest:d}=e;const[u,h]=(0,l.useState)([]),[g,m]=(0,l.useState)([]),[y,v]=(0,l.useState)("campaigns"),[b,x]=(0,l.useState)(null);(0,l.useEffect)(()=>{w(),k()},[]);const w=()=>{try{let e=S();h(e);const t=localStorage.getItem("world-engine-campaigns"),n=localStorage.getItem("world-engine-campaigns-backup");!t&&n&&e.length>0&&alert("\u26a0\ufe0f Primary save was missing, but your campaigns were recovered from backup!")}catch(e){console.error("Error loading campaigns:",e),h([])}},S=()=>{try{let e=JSON.parse(localStorage.getItem("world-engine-campaigns")||"[]");if(0===e.length){const t=JSON.parse(localStorage.getItem("world-engine-campaigns-backup")||"{}");t.campaigns&&t.campaigns.length>0&&(e=t.campaigns,localStorage.setItem("world-engine-campaigns",JSON.stringify(e)),console.log("Recovered campaigns from backup storage"))}if(0===e.length){const t=JSON.parse(sessionStorage.getItem("world-engine-campaigns-session")||"[]");t.length>0&&(e=t,localStorage.setItem("world-engine-campaigns",JSON.stringify(e)),console.log("Recovered campaigns from session storage"))}return e}catch(e){return console.error("Error recovering campaigns:",e),[]}},k=()=>{try{const e=localStorage.getItem("world-engine-characters");e&&m(JSON.parse(e))}catch(e){console.error("Error loading characters:",e)}},C=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),j=e=>({padding:"12px 24px",background:"none",border:"none",color:e?"#3b82f6":"#94a3b8",fontSize:"1.1rem",fontWeight:e?"600":"400",cursor:"pointer",borderBottom:e?"2px solid #3b82f6":"2px solid transparent",transition:"all 0.2s ease"}),T={display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"20px",marginBottom:"30px"},E={background:"#1e293b",border:"1px solid #334155",borderRadius:"12px",padding:"20px",transition:"all 0.2s ease",cursor:"pointer"},z=s(s({},E),{},{background:"linear-gradient(135deg, #059669 0%, #047857 100%)",border:"1px solid #10b981",textAlign:"center",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",minHeight:"120px"}),M={background:"#3b82f6",color:"white",border:"none",borderRadius:"8px",padding:"8px 16px",cursor:"pointer",fontSize:"0.9rem",transition:"background 0.2s ease"},I=s(s({},M),{},{background:"#dc2626",marginLeft:"8px"}),_=e=>{var t,n,r,a;let{character:i,onClose:o}=e;const l={background:"#0f172a",padding:"12px",borderRadius:"8px",textAlign:"center",border:"1px solid #334155"};return(0,p.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.8)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3,padding:"20px"},onClick:o,children:(0,p.jsxs)("div",{style:{background:"#1e293b",border:"1px solid #334155",borderRadius:"12px",padding:"30px",maxWidth:"600px",maxHeight:"80vh",width:"100%",overflowY:"auto",color:"#f8fafc"},onClick:e=>e.stopPropagation(),children:[(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[(0,p.jsx)("h2",{style:{margin:0,color:"#3b82f6"},children:i.name}),(0,p.jsx)("button",{onClick:o,style:{background:"#374151",color:"#f8fafc",border:"none",borderRadius:"6px",padding:"8px 12px",cursor:"pointer",fontSize:"16px"},children:"\u2715"})]}),(0,p.jsxs)("div",{style:{display:"flex",gap:"20px",marginBottom:"20px"},children:[null!==(t=i.data)&&void 0!==t&&t.name&&null!==(n=i.data)&&void 0!==n&&n.species&&null!==(r=i.data)&&void 0!==r&&r.archetype&&null!==(a=i.data)&&void 0!==a&&a.gender?(0,p.jsx)(f,{gender:i.data.gender.toLowerCase(),species:i.data.species.toLowerCase(),archetype:i.data.archetype.toLowerCase(),size:"small"}):(0,p.jsx)("div",{style:{width:120,height:120,background:"#374151",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",color:"#9ca3af",fontSize:"24px",flexShrink:0},children:"\ud83d\udc64"}),(0,p.jsxs)("div",{style:{flex:1},children:[(0,p.jsx)("p",{style:{margin:"5px 0",fontSize:"18px"},children:(0,p.jsxs)("strong",{children:[i.race," ",i.characterClass]})}),(0,p.jsxs)("p",{style:{margin:"5px 0",color:"#94a3b8"},children:["Level ",i.level]}),(0,p.jsxs)("p",{style:{margin:"5px 0",color:"#64748b",fontSize:"14px"},children:["Created: ",C(i.createdAt)]})]})]}),i.data&&(0,p.jsxs)(p.Fragment,{children:[i.data.gender&&(0,p.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,p.jsx)("h4",{style:{margin:"0 0 8px 0",color:"#8b5cf6"},children:"Gender"}),(0,p.jsx)("p",{style:{margin:0,color:"#e2e8f0"},children:i.data.gender})]}),i.data.background&&(0,p.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,p.jsx)("h4",{style:{margin:"0 0 8px 0",color:"#8b5cf6"},children:"Background"}),(0,p.jsx)("p",{style:{margin:0,color:"#e2e8f0"},children:i.data.background})]}),i.data.stats&&(0,p.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,p.jsx)("h4",{style:{margin:"0 0 12px 0",color:"#8b5cf6"},children:"Ability Scores"}),(0,p.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:"15px",margin:"20px 0"},children:Object.entries(i.data.stats).map(e=>{let[t,n]=e;const r=Number(n);return(0,p.jsxs)("div",{style:l,children:[(0,p.jsx)("div",{style:{fontWeight:"bold",fontSize:"14px",color:"#94a3b8",marginBottom:"4px"},children:t.toUpperCase()}),(0,p.jsx)("div",{style:{fontSize:"20px",fontWeight:"bold",color:"#f1f5f9"},children:r}),(0,p.jsxs)("div",{style:{fontSize:"12px",color:"#64748b"},children:[r>=10?"+":"",Math.floor((r-10)/2)]})]},t)})})]}),i.data.traits&&i.data.traits.length>0&&(0,p.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,p.jsx)("h4",{style:{margin:"0 0 12px 0",color:"#8b5cf6"},children:"Traits"}),(0,p.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:i.data.traits.map((e,t)=>(0,p.jsx)("span",{style:{background:"#0f172a",color:"#e2e8f0",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",border:"1px solid #334155"},children:e},t))})]}),(i.data.knownCantrips&&i.data.knownCantrips.length>0||i.data.knownSpells&&i.data.knownSpells.length>0)&&(0,p.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,p.jsx)("h4",{style:{margin:"0 0 12px 0",color:"#8b5cf6"},children:"Spells & Magic"}),i.data.level&&(0,p.jsxs)("p",{style:{margin:"0 0 8px 0",color:"#94a3b8",fontSize:"14px"},children:["Level ",i.data.level," Character"]}),i.data.knownCantrips&&i.data.knownCantrips.length>0&&(0,p.jsxs)("div",{style:{marginBottom:"12px"},children:[(0,p.jsx)("h5",{style:{margin:"0 0 6px 0",color:"#ec4899"},children:"Known Cantrips:"}),(0,p.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px"},children:i.data.knownCantrips.map((e,t)=>(0,p.jsx)("span",{style:{background:"#ec4899",color:"white",padding:"3px 8px",borderRadius:"4px",fontSize:"11px",fontWeight:"bold"},children:e},t))})]}),i.data.knownSpells&&i.data.knownSpells.length>0&&(0,p.jsxs)("div",{children:[(0,p.jsx)("h5",{style:{margin:"0 0 6px 0",color:"#3b82f6"},children:"Known Spells:"}),(0,p.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px"},children:i.data.knownSpells.map((e,t)=>(0,p.jsx)("span",{style:{background:"#3b82f6",color:"white",padding:"3px 8px",borderRadius:"4px",fontSize:"11px",fontWeight:"bold"},children:e},t))})]})]}),i.data.mode&&(0,p.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,p.jsx)("h4",{style:{margin:"0 0 8px 0",color:"#8b5cf6"},children:"Creation Method"}),(0,p.jsx)("p",{style:{margin:0,color:"#e2e8f0"},children:"POINT_BUY"===i.data.mode?"Point Buy System":"Dice Roll"})]})]}),(0,p.jsx)("div",{style:{marginTop:"20px",textAlign:"center"},children:(0,p.jsx)("button",{onClick:o,style:s(s({},M),{},{background:"#059669",padding:"10px 20px",fontSize:"16px"}),children:"Close"})})]})})};return(0,p.jsxs)("div",{style:{background:"linear-gradient(135deg, #0c1426 0%, #1e293b 100%)",minHeight:"100vh",color:"#f8fafc",fontFamily:"system-ui, -apple-system, sans-serif"},children:[(0,p.jsxs)("div",{style:{textAlign:"center",padding:"40px 20px",borderBottom:"1px solid #334155"},children:[(0,p.jsx)("h1",{style:{fontSize:"3rem",fontWeight:"bold",margin:"0 0 10px 0",background:"linear-gradient(45deg, #3b82f6, #8b5cf6)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:"World Engine"}),(0,p.jsx)("p",{style:{fontSize:"1.2rem",color:"#94a3b8",margin:0},children:"Campaign & Character Management"}),(0,p.jsxs)("div",{style:{marginTop:"20px",display:"flex",gap:"12px",justifyContent:"center",flexWrap:"wrap"},children:[(0,p.jsx)("button",{onClick:()=>{try{const e={campaigns:u,characters:g,exportDate:(new Date).toISOString(),version:"2.0",worldEngineVersion:"v1.0.0"},t=JSON.stringify(e,null,2),n=new Blob([t],{type:"application/json"}),r=URL.createObjectURL(n),a=document.createElement("a");a.href=r,a.download="world-engine-backup-".concat((new Date).toISOString().split("T")[0],".json"),document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(r),alert("\u2705 Backup downloaded successfully!")}catch(e){console.error("Error downloading backup:",e),alert("\u274c Failed to download backup")}},style:s(s({},M),{},{background:"#059669",display:"flex",alignItems:"center",gap:"6px"}),children:"\ud83d\udcbe Download Backup"}),(0,p.jsxs)("label",{style:s(s({},M),{},{background:"#7c3aed",display:"flex",alignItems:"center",gap:"6px",cursor:"pointer"}),children:["\ud83d\udcc2 Import Backup",(0,p.jsx)("input",{type:"file",accept:".json",onChange:e=>{var t;const n=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!n)return;const r=new FileReader;r.onload=e=>{try{var t,n,r;const a=JSON.parse(null===(t=e.target)||void 0===t?void 0:t.result);a.campaigns&&Array.isArray(a.campaigns)&&(localStorage.setItem("world-engine-campaigns",JSON.stringify(a.campaigns)),localStorage.setItem("world-engine-campaigns-backup",JSON.stringify(a)),h(a.campaigns)),a.characters&&Array.isArray(a.characters)&&(localStorage.setItem("world-engine-characters",JSON.stringify(a.characters)),localStorage.setItem("world-engine-characters-backup",JSON.stringify(a.characters)),m(a.characters)),alert("\u2705 Backup imported successfully!\nCampaigns: ".concat((null===(n=a.campaigns)||void 0===n?void 0:n.length)||0,"\nCharacters: ").concat((null===(r=a.characters)||void 0===r?void 0:r.length)||0))}catch(a){console.error("Error importing backup:",a),alert("\u274c Invalid backup file format")}},r.readAsText(n),e.target.value=""},style:{display:"none"}})]}),(0,p.jsx)("button",{onClick:()=>{try{const e=S();h(e);const t=localStorage.getItem("world-engine-characters-backup");if(t){const e=JSON.parse(t);Array.isArray(e)&&(localStorage.setItem("world-engine-characters",JSON.stringify(e)),m(e))}alert("\ud83d\udd04 Recovery attempt completed!\nRecovered ".concat(e.length," campaigns"))}catch(e){console.error("Error during recovery:",e),alert("\u274c Recovery failed")}},style:s(s({},M),{},{background:"#dc2626",display:"flex",alignItems:"center",gap:"6px"}),children:"\ud83d\udd04 Force Recovery"})]}),(0,p.jsx)("p",{style:{fontSize:"0.85rem",color:"#64748b",marginTop:"12px",fontStyle:"italic"},children:"\ud83d\udca1 Auto-saves every 10 campaign saves \u2022 Backup before major changes"})]}),(0,p.jsxs)("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"40px 20px"},children:[(0,p.jsxs)("div",{style:{display:"flex",marginBottom:"30px",borderBottom:"1px solid #334155"},children:[(0,p.jsx)("button",{style:j("campaigns"===y),onClick:()=>v("campaigns"),children:"Campaigns"}),(0,p.jsx)("button",{style:j("characters"===y),onClick:()=>v("characters"),children:"Character Library"})]}),"campaigns"===y&&(0,p.jsxs)("div",{children:[(0,p.jsxs)("div",{style:T,children:[(0,p.jsxs)("div",{style:z,onClick:t,children:[(0,p.jsx)("div",{style:{fontSize:"3rem",marginBottom:"10px"},children:"+"}),(0,p.jsx)("h3",{style:{margin:"0 0 5px 0"},children:"New Campaign"}),(0,p.jsx)("p",{style:{margin:0,opacity:.9},children:"Start a new adventure"})]}),u.map(e=>(0,p.jsxs)("div",{style:E,children:[(0,p.jsx)("h3",{style:{margin:"0 0 10px 0",color:"#f1f5f9"},children:e.name}),(0,p.jsxs)("p",{style:{margin:"0 0 5px 0",color:"#94a3b8",fontSize:"0.9rem"},children:["World: ",e.worldPreset||"Custom"]}),(0,p.jsxs)("p",{style:{margin:"0 0 5px 0",color:"#94a3b8",fontSize:"0.9rem"},children:["Seed: ",e.seed.substring(0,20),"..."]}),(0,p.jsxs)("p",{style:{margin:"0 0 15px 0",color:"#64748b",fontSize:"0.8rem"},children:["Last played: ",C(e.lastPlayed)]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("button",{style:M,onClick:()=>n(e),children:"Load Campaign"}),(0,p.jsx)("button",{style:I,onClick:t=>{t.stopPropagation(),confirm("Delete this campaign?")&&(e=>{const t=u.filter(t=>t.id!==e);h(t),localStorage.setItem("world-engine-campaigns",JSON.stringify(t))})(e.id)},children:"Delete"})]})]},e.id))]}),0===u.length&&(0,p.jsx)("div",{style:{textAlign:"center",color:"#64748b",fontSize:"1.1rem",marginTop:"60px"},children:(0,p.jsx)("p",{children:"No campaigns yet. Create your first campaign to begin!"})})]}),"characters"===y&&(0,p.jsxs)("div",{children:[(0,p.jsxs)("div",{style:T,children:[(0,p.jsxs)("div",{style:z,onClick:c,children:[(0,p.jsx)("div",{style:{fontSize:"3rem",marginBottom:"10px"},children:"\u2694\ufe0f"}),(0,p.jsx)("h3",{style:{margin:"0 0 5px 0"},children:"Character Creator"}),(0,p.jsx)("p",{style:{margin:0,opacity:.9},children:"Create new characters"})]}),(0,p.jsxs)("div",{style:z,onClick:r,children:[(0,p.jsx)("div",{style:{fontSize:"3rem",marginBottom:"10px"},children:"\ud83d\udcdc"}),(0,p.jsx)("h3",{style:{margin:"0 0 5px 0"},children:"Name Generator"}),(0,p.jsx)("p",{style:{margin:0,opacity:.9},children:"Generate fantasy names"})]}),(0,p.jsxs)("div",{style:z,onClick:a,children:[(0,p.jsx)("div",{style:{fontSize:"3rem",marginBottom:"10px"},children:"\u2728"}),(0,p.jsx)("h3",{style:{margin:"0 0 5px 0"},children:"Spell Generator"}),(0,p.jsx)("p",{style:{margin:0,opacity:.9},children:"Create custom spells"})]}),(0,p.jsxs)("div",{style:z,onClick:i,children:[(0,p.jsx)("div",{style:{fontSize:"3rem",marginBottom:"10px"},children:"\ud83d\udcdc"}),(0,p.jsx)("h3",{style:{margin:"0 0 5px 0"},children:"Assign Spells"}),(0,p.jsx)("p",{style:{margin:0,opacity:.9},children:"Give spells to characters"})]}),(0,p.jsxs)("div",{style:z,onClick:o,children:[(0,p.jsx)("div",{style:{fontSize:"3rem",marginBottom:"10px"},children:"\u2695\ufe0f"}),(0,p.jsx)("h3",{style:{margin:"0 0 5px 0"},children:"Healing System"}),(0,p.jsx)("p",{style:{margin:0,opacity:.9},children:"Manage party health & healing"})]}),(0,p.jsxs)("div",{style:z,onClick:d,children:[(0,p.jsx)("div",{style:{fontSize:"3rem",marginBottom:"10px"},children:"\ud83c\udfad"}),(0,p.jsx)("h3",{style:{margin:"0 0 5px 0"},children:"Portrait Test"}),(0,p.jsx)("p",{style:{margin:0,opacity:.9},children:"Test all portrait combinations"})]}),g.map(e=>{var t,n,r,a;return(0,p.jsxs)("div",{style:E,children:[(0,p.jsxs)("div",{style:{display:"flex",gap:"12px",marginBottom:"12px"},children:[null!==(t=e.data)&&void 0!==t&&t.name&&null!==(n=e.data)&&void 0!==n&&n.species&&null!==(r=e.data)&&void 0!==r&&r.archetype&&null!==(a=e.data)&&void 0!==a&&a.gender?(0,p.jsx)(f,{gender:e.data.gender.toLowerCase(),species:e.data.species.toLowerCase(),archetype:e.data.archetype.toLowerCase(),size:"small"}):(0,p.jsx)("div",{style:{width:60,height:60,background:"#374151",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",color:"#9ca3af",fontSize:"16px",flexShrink:0},children:"\ud83d\udc64"}),(0,p.jsxs)("div",{style:{flex:1},children:[(0,p.jsx)("h3",{style:{margin:"0 0 8px 0",color:"#f1f5f9"},children:e.name}),(0,p.jsxs)("p",{style:{margin:"0 0 4px 0",color:"#94a3b8",fontSize:"0.9rem"},children:[e.race," ",e.characterClass]}),(0,p.jsxs)("p",{style:{margin:"0",color:"#94a3b8",fontSize:"0.9rem"},children:["Level ",e.level]})]})]}),(0,p.jsxs)("p",{style:{margin:"0 0 15px 0",color:"#64748b",fontSize:"0.8rem"},children:["Created: ",C(e.createdAt)]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("button",{style:M,onClick:()=>x(e),children:"View Character"}),(0,p.jsx)("button",{style:I,onClick:t=>{t.stopPropagation(),confirm("Delete this character?")&&(e=>{const t=g.filter(t=>t.id!==e);m(t),localStorage.setItem("world-engine-characters",JSON.stringify(t))})(e.id)},children:"Delete"})]})]},e.id)})]}),0===g.length&&(0,p.jsx)("div",{style:{textAlign:"center",color:"#64748b",fontSize:"1.1rem",marginTop:"60px"},children:(0,p.jsx)("p",{children:"No saved characters yet. Create your first character!"})})]})]}),b&&(0,p.jsx)(_,{character:b,onClose:()=>x(null)})]})}function B(e){var t,n,r,a,i;let{eng:o,onNext:s}=e;const[c,d]=(0,l.useState)([]),[u,h]=(0,l.useState)(""),[g,f]=(0,l.useState)(""),[m,y]=(0,l.useState)((null===o||void 0===o||null===(t=o.state)||void 0===t||null===(n=t.meta)||void 0===n?void 0:n.seed)||"");console.log("WorldSetupScreen render:",{presets:c,chosen:u}),(0,l.useEffect)(()=>{!async function(){try{var e,t,n,r;console.log("Loading presets..."),await(null===o||void 0===o||null===(e=o.loadWorldPresets)||void 0===e?void 0:e.call(o));const a=(null===o||void 0===o||null===(t=o.state)||void 0===t||null===(n=t.meta)||void 0===n||null===(r=n.presets)||void 0===r?void 0:r.list)||[];d(a),console.log("Loaded presets:",a)}catch(a){console.error("Failed to load presets",a),f("Could not load world presets.")}}()},[o]),(0,l.useEffect)(()=>{var e,t;const n=(null===o||void 0===o||null===(e=o.state)||void 0===e||null===(t=e.meta)||void 0===t?void 0:t.seed)||"";n&&n!==m&&y(n)},[null===o||void 0===o||null===(r=o.state)||void 0===r||null===(a=r.meta)||void 0===a?void 0:a.seed]),(0,l.useEffect)(()=>{var e;const t=null===(e=c.find(e=>e.name===u))||void 0===e?void 0:e.seed;var n;!m&&t&&(y(t),null===o||void 0===o||null===(n=o.setSeed)||void 0===n||n.call(o,t))},[u,c]);const v=(0,l.useMemo)(()=>()=>{var e;const t=Date.now().toString(36),n=Math.random().toString(36).slice(2,8),r="".concat(t,"-").concat(n);y(r),null===o||void 0===o||null===(e=o.setSeed)||void 0===e||e.call(o,r)},[o]),b=c.find(e=>(null===e||void 0===e?void 0:e.name)===u);return(0,p.jsxs)("div",{children:[(0,p.jsx)("h2",{children:"World Setup"}),g&&(0,p.jsx)("div",{style:{color:"red"},children:g}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{children:"Choose a preset world: "}),(0,p.jsxs)("select",{value:u,onChange:e=>{var t;const n=e.target.value;h(n),null===o||void 0===o||null===(t=o.applyPresetByName)||void 0===t||t.call(o,n)},children:[(0,p.jsx)("option",{value:"",children:"-- none --"}),c.map(e=>(0,p.jsx)("option",{value:e.name,children:e.name},e.name))]}),(0,p.jsxs)("div",{style:{marginTop:12},children:[(0,p.jsx)("label",{htmlFor:"seed",children:"World seed: "}),(0,p.jsx)("input",{id:"seed",type:"text",value:m,onChange:e=>{var t;y(e.target.value),null===o||void 0===o||null===(t=o.setSeed)||void 0===t||t.call(o,e.target.value)},placeholder:"random-seed",style:{width:260}}),(0,p.jsx)("button",{type:"button",style:{marginLeft:8},onClick:v,children:"Randomize"})]}),(null===b||void 0===b?void 0:b.description)&&(0,p.jsx)("p",{style:{marginTop:8,opacity:.8},children:b.description}),null!==b&&void 0!==b&&null!==(i=b.factions)&&void 0!==i&&i.length?(0,p.jsxs)("div",{style:{marginTop:6,fontSize:12},children:["Factions: ",b.factions.join(" \u2022 ")]}):null]}),(0,p.jsx)("button",{onClick:s,disabled:!u&&!m,children:"Next: Create Characters"})]})}const D=[{name:"Kira Stormwind",gender:"Female",species:"Stormcaller",archetype:"Storm Herald",background:"A former temple acolyte who left their old life behind after a mystical awakening. Now they seek knowledge in the wider world, wielding storm magic passed down through generations.",stats:{STR:10,DEX:14,CON:12,INT:15,WIS:13,CHA:11},traits:["Observant","Silver Tongue","Swift"],portraitUrl:"https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=300&h=300&fit=crop&crop=face",mode:"POINT_BUY"},{name:"Marcus Ironforge",gender:"Male",species:"Alloy",archetype:"Dust Warden",background:"Born in the crystal caves, they were raised by wise elders and learned the ways of crafting. Their greatest challenge was mastering the fusion of magic and metal that defines their people.",stats:{STR:13,DEX:11,CON:15,INT:14,WIS:12,CHA:8},traits:["Clever","Iron Will","Stoic"],portraitUrl:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=300&h=300&fit=crop&crop=face",mode:"POINT_BUY"},{name:"Zara Nightwhisper",gender:"Female",species:"Voidkin",archetype:"Wind Sage",background:"A wandering soul from the shadow realm who fought in great battles against the encroaching darkness. Their destiny was forever changed when they discovered their connection to the void grants them unique abilities.",stats:{STR:9,DEX:15,CON:11,INT:12,WIS:14,CHA:13},traits:["Cunning","Lucky","Observant"],portraitUrl:"https://images.unsplash.com/photo-1494790108755-2616c4b43e69?w=300&h=300&fit=crop&crop=face",mode:"POINT_BUY"},{name:"Theron Greenbough",gender:"Male",species:"Sylvanborn",archetype:"Greenwarden",background:"A guardian of the ancient forests who communes with the spirits of nature. After witnessing the corruption of his homeland, he seeks allies to restore the natural balance.",stats:{STR:12,DEX:13,CON:14,INT:10,WIS:16,CHA:9},traits:["Nature's Friend","Keen Senses","Patient"],portraitUrl:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=300&h=300&fit=crop&crop=face",mode:"POINT_BUY"}];const O=function(e){var t;let{eng:n,party:r,setParty:a,onStart:i,onCreateNew:o}=e;const[s,c]=(0,l.useState)([]),[d,u]=(0,l.useState)("saved"),[h,g]=(0,l.useState)(null);(0,l.useEffect)(()=>{console.log("CharacterLibrary: Loading saved characters...");try{let e=JSON.parse(localStorage.getItem("world-engine-characters")||"[]");if(0===e.length){const t=JSON.parse(localStorage.getItem("world-engine-characters-backup")||"[]");t.length>0&&(console.log("Restoring from backup:",t.length,"characters"),e=t,localStorage.setItem("world-engine-characters",JSON.stringify(e)))}console.log("CharacterLibrary: Loaded characters:",e.length,"total"),c(e),e.length>0&&localStorage.setItem("world-engine-characters-backup",JSON.stringify(e))}catch(e){console.error("Error loading saved characters:",e),c([])}},[]);const f=e=>{r.length>=4?alert("Party is full! Maximum 4 characters."):r.some(t=>t.name===e.name)?alert("Character already in party!"):a([...r,e])},m="string"===typeof n.state.meta.presets.loaded?n.state.meta.presets.loaded:null===(t=n.state.meta.presets.loaded)||void 0===t?void 0:t.name,y=e=>{let{character:t,onClose:n}=e;return(0,p.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:(0,p.jsxs)("div",{style:{background:"linear-gradient(135deg, #1e293b 0%, #334155 100%)",borderRadius:"12px",padding:"2rem",maxWidth:"600px",width:"90%",maxHeight:"80vh",overflowY:"auto",color:"#e2e8f0",position:"relative"},children:[(0,p.jsx)("button",{onClick:n,style:{position:"absolute",top:"1rem",right:"1rem",background:"transparent",border:"none",color:"#94a3b8",fontSize:"1.5rem",cursor:"pointer",padding:"0.5rem"},children:"\xd7"}),(0,p.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,p.jsx)("h2",{style:{margin:"0 0 0.5rem",color:"#f1f5f9",fontSize:"2rem",fontWeight:"bold"},children:t.name}),(0,p.jsxs)("div",{style:{color:"#94a3b8",fontSize:"1.1rem"},children:[t.data.gender," \u2022 ",t.race," ",t.characterClass]}),(0,p.jsxs)("div",{style:{color:"#64748b",fontSize:"0.9rem",marginTop:"0.5rem"},children:["Created: ",new Date(t.createdAt).toLocaleDateString()]})]}),(0,p.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,p.jsx)("h3",{style:{color:"#e2e8f0",marginBottom:"1rem"},children:"Ability Scores"}),(0,p.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"1rem"},children:Object.entries(t.data.stats).map(e=>{let[t,n]=e;return(0,p.jsxs)("div",{style:{textAlign:"center",padding:"1rem",background:"rgba(15, 23, 42, 0.5)",borderRadius:"8px",border:"1px solid #334155"},children:[(0,p.jsx)("div",{style:{fontSize:"0.9rem",color:"#94a3b8",marginBottom:"0.5rem"},children:t}),(0,p.jsx)("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#f1f5f9"},children:n})]},t)})})]}),t.data.traits&&t.data.traits.length>0&&(0,p.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,p.jsx)("h3",{style:{color:"#e2e8f0",marginBottom:"1rem"},children:"Traits"}),(0,p.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem"},children:t.data.traits.map((e,t)=>(0,p.jsx)("span",{style:{padding:"0.5rem 1rem",background:"#3b82f6",color:"white",borderRadius:"20px",fontSize:"0.9rem"},children:e},t))})]}),t.data.background&&(0,p.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,p.jsx)("h3",{style:{color:"#e2e8f0",marginBottom:"1rem"},children:"Background"}),(0,p.jsx)("div",{style:{padding:"1rem",background:"rgba(15, 23, 42, 0.5)",borderRadius:"8px",border:"1px solid #334155",color:"#94a3b8",lineHeight:"1.6"},children:t.data.background})]}),(0,p.jsxs)("div",{style:{display:"flex",gap:"1rem",justifyContent:"flex-end"},children:[(0,p.jsx)("button",{onClick:()=>{f(t.data),n()},style:{padding:"0.75rem 1.5rem",background:"#10b981",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"bold"},children:"Add to Party"}),(0,p.jsx)("button",{onClick:()=>{window.confirm("Are you sure you want to delete this character? This cannot be undone.")&&((e=>{if(!window.confirm("Are you sure you want to delete this character? This cannot be undone."))return;const t=s.filter(t=>t.id!==e);c(t),localStorage.setItem("world-engine-characters",JSON.stringify(t)),localStorage.setItem("world-engine-characters-backup",JSON.stringify(t)),console.log("Deleted character ".concat(e,", remaining:"),t.length)})(t.id),n())},style:{padding:"0.75rem 1.5rem",background:"#ef4444",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"bold"},children:"Delete Character"})]})]})})};return(0,p.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"100vh",background:"linear-gradient(135deg, #0f172a 0%, #1e293b 100%)",color:"#e2e8f0"},children:[(0,p.jsxs)("div",{style:{padding:"1.5rem",borderBottom:"1px solid #334155",background:"rgba(15, 23, 42, 0.8)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("h1",{style:{margin:0,fontSize:"2rem",fontWeight:"bold"},children:"Character Library"}),(0,p.jsxs)("p",{style:{margin:"0.5rem 0 0",opacity:.8},children:["Selected World: ",(0,p.jsx)("span",{style:{color:"#60a5fa",fontWeight:"bold"},children:m||"None"})]})]}),(0,p.jsxs)("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[(0,p.jsx)("button",{onClick:()=>{const e=JSON.stringify(s,null,2),t=new Blob([e],{type:"application/json"}),n=URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download="world-engine-characters-".concat((new Date).toISOString().split("T")[0],".json"),r.click(),URL.revokeObjectURL(n)},disabled:0===s.length,style:{padding:"0.5rem 1rem",background:0===s.length?"#374151":"#059669",color:"white",border:"none",borderRadius:"4px",cursor:0===s.length?"not-allowed":"pointer",fontSize:"0.9rem"},children:"Export Characters"}),(0,p.jsxs)("label",{style:{padding:"0.5rem 1rem",background:"#3b82f6",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"0.9rem"},children:["Import Characters",(0,p.jsx)("input",{type:"file",accept:".json",onChange:e=>{var t;const n=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!n)return;const r=new FileReader;r.onload=e=>{try{var t;const n=JSON.parse(null===(t=e.target)||void 0===t?void 0:t.result);Array.isArray(n)?(c(n),localStorage.setItem("world-engine-characters",JSON.stringify(n)),localStorage.setItem("world-engine-characters-backup",JSON.stringify(n)),alert("Successfully imported ".concat(n.length," characters!"))):alert("Invalid file format. Please select a valid character export file.")}catch(n){console.error("Import error:",n),alert("Error importing characters. Please check the file format.")}},r.readAsText(n),e.target.value=""},style:{display:"none"}})]})]})]}),(0,p.jsxs)("div",{style:{display:"flex",flex:1},children:[(0,p.jsxs)("div",{style:{flex:2,padding:"1.5rem",borderRight:"1px solid #334155",overflowY:"auto"},children:[(0,p.jsxs)("div",{style:{display:"flex",marginBottom:"1.5rem",borderBottom:"1px solid #334155"},children:[(0,p.jsxs)("button",{onClick:()=>u("saved"),style:{padding:"0.75rem 1.5rem",background:"saved"===d?"#3b82f6":"transparent",color:"saved"===d?"white":"#94a3b8",border:"none",borderBottom:"saved"===d?"2px solid #3b82f6":"2px solid transparent",cursor:"pointer",fontSize:"1rem"},children:["Saved Characters (",s.length,")"]}),(0,p.jsxs)("button",{onClick:()=>u("presets"),style:{padding:"0.75rem 1.5rem",background:"presets"===d?"#3b82f6":"transparent",color:"presets"===d?"white":"#94a3b8",border:"none",borderBottom:"presets"===d?"2px solid #3b82f6":"2px solid transparent",cursor:"pointer",fontSize:"1rem"},children:["Preset Characters (",D.length,")"]})]}),(0,p.jsx)("button",{onClick:o,style:{width:"100%",padding:"0.75rem",marginBottom:"1.5rem",background:"#10b981",color:"white",border:"none",borderRadius:"6px",fontSize:"1rem",cursor:"pointer",fontWeight:"bold"},children:"Create New Character"}),(0,p.jsx)("div",{style:{display:"grid",gap:"1rem"},children:"saved"===d?0===s.length?(0,p.jsx)("div",{style:{textAlign:"center",padding:"2rem",color:"#64748b",fontStyle:"italic"},children:"No saved characters yet. Create your first character!"}):s.map(e=>(0,p.jsx)("div",{style:{background:"#1e293b",border:"1px solid #334155",borderRadius:"8px",padding:"1rem"},children:(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("h3",{style:{margin:"0 0 0.5rem",color:"#f1f5f9"},children:e.name}),(0,p.jsxs)("p",{style:{margin:"0.25rem 0",color:"#94a3b8",fontSize:"0.9rem"},children:[e.race," ",e.characterClass]}),(0,p.jsxs)("p",{style:{margin:"0.25rem 0",color:"#64748b",fontSize:"0.8rem"},children:["Created: ",new Date(e.createdAt).toLocaleDateString()]})]}),(0,p.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},children:[(0,p.jsx)("button",{onClick:()=>f(e.data),style:{padding:"0.5rem 1rem",background:"#3b82f6",color:"white",border:"none",borderRadius:"4px",fontSize:"0.8rem",cursor:"pointer"},children:"Add to Party"}),(0,p.jsx)("button",{onClick:()=>g(e),style:{padding:"0.5rem 1rem",background:"#64748b",color:"white",border:"none",borderRadius:"4px",fontSize:"0.8rem",cursor:"pointer"},children:"View Details"})]})]})},e.id)):D.map((e,t)=>(0,p.jsx)("div",{style:{background:"#1e293b",border:"1px solid #334155",borderRadius:"8px",padding:"1rem"},children:(0,p.jsxs)("div",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:[e.portraitUrl&&(0,p.jsx)("img",{src:e.portraitUrl,alt:e.name,style:{width:"60px",height:"60px",borderRadius:"50%",objectFit:"cover"}}),(0,p.jsxs)("div",{style:{flex:1},children:[(0,p.jsx)("h3",{style:{margin:"0 0 0.5rem",color:"#f1f5f9"},children:e.name}),(0,p.jsxs)("p",{style:{margin:"0.25rem 0",color:"#94a3b8",fontSize:"0.9rem"},children:[e.species," ",e.archetype]}),(0,p.jsx)("p",{style:{margin:"0.5rem 0 0",color:"#64748b",fontSize:"0.8rem",maxWidth:"300px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.background})]}),(0,p.jsx)("button",{onClick:()=>f(e),style:{padding:"0.5rem 1rem",background:"#3b82f6",color:"white",border:"none",borderRadius:"4px",fontSize:"0.8rem",cursor:"pointer"},children:"Add to Party"})]})},t))})]}),(0,p.jsxs)("div",{style:{flex:1,padding:"1.5rem",background:"rgba(15, 23, 42, 0.5)"},children:[(0,p.jsxs)("h2",{style:{marginBottom:"1rem"},children:["Current Party (",r.length,"/4)"]}),0===r.length?(0,p.jsx)("div",{style:{textAlign:"center",padding:"2rem",color:"#64748b",fontStyle:"italic"},children:"No characters in party. Add characters to get started!"}):(0,p.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:r.map((e,t)=>(0,p.jsx)("div",{style:{background:"#1e293b",border:"1px solid #334155",borderRadius:"8px",padding:"1rem"},children:(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("h4",{style:{margin:"0 0 0.25rem",color:"#f1f5f9"},children:e.name}),(0,p.jsxs)("p",{style:{margin:"0",color:"#94a3b8",fontSize:"0.8rem"},children:[e.species," ",e.archetype]})]}),(0,p.jsx)("button",{onClick:()=>(e=>{a(r.filter((t,n)=>n!==e))})(t),style:{padding:"0.25rem 0.5rem",background:"#ef4444",color:"white",border:"none",borderRadius:"4px",fontSize:"0.7rem",cursor:"pointer"},children:"Remove"})]})},t))}),(0,p.jsx)("button",{onClick:i,disabled:0===r.length,style:{width:"100%",padding:"1rem",marginTop:"1.5rem",background:0===r.length?"#374151":"#059669",color:0===r.length?"#6b7280":"white",border:"none",borderRadius:"6px",fontSize:"1.1rem",fontWeight:"bold",cursor:0===r.length?"not-allowed":"pointer"},children:0===r.length?"Add Characters to Start":"Start Adventure"})]})]}),h&&(0,p.jsx)(y,{character:h,onClose:()=>g(null)})]})},F={Greenwarden:{name:"Greenwarden",description:"Protectors of the sacred groves, wielding nature magic and plant allies.",statModifiers:{strength:2,constitution:3,wisdom:4,intelligence:2,dexterity:1,charisma:2},primaryStats:["Wisdom","Constitution"],abilities:["Commune with Plants","Nature's Shield","Healing Touch"],equipment:["Ironwood Staff","Living Armor","Seed Pouch"],faction:"The Rootspeakers"},"Thorn Knight":{name:"Thorn Knight",description:"Warriors who bond with thorned plants, masters of aggressive defense.",statModifiers:{strength:4,constitution:4,wisdom:1,intelligence:1,dexterity:2,charisma:2},primaryStats:["Strength","Constitution"],abilities:["Thorn Armor","Spike Strike","Guardian's Stance"],equipment:["Thorn Blade","Barkskin Mail","Shield of Briars"],faction:"Thornweave Syndicate"},"Sapling Adept":{name:"Sapling Adept",description:"Young mages learning to channel the growth energies of spirit plants.",statModifiers:{strength:1,constitution:2,wisdom:3,intelligence:4,dexterity:3,charisma:1},primaryStats:["Intelligence","Wisdom"],abilities:["Growth Burst","Plant Familiar","Verdant Bolt"],equipment:["Sapling Wand","Apprentice Robes","Botanical Tome"],faction:"The Rootspeakers"},Bloomcaller:{name:"Bloomcaller",description:"Diplomatic negotiators who can speak with all forms of plant life.",statModifiers:{strength:1,constitution:2,wisdom:3,intelligence:2,dexterity:2,charisma:4},primaryStats:["Charisma","Wisdom"],abilities:["Plant Speech","Soothing Pollen","Bloom Command"],equipment:["Flower Crown","Silk Robes","Diplomatic Sash"],faction:"Valebright Court"},Ashblade:{name:"Ashblade",description:"Warriors who forge weapons from the bones and ash of the wasteland.",statModifiers:{strength:4,constitution:3,wisdom:1,intelligence:1,dexterity:3,charisma:2},primaryStats:["Strength","Dexterity"],abilities:["Ash Strike","Heat Resistance","Bone Weapon"],equipment:["Ashforged Blade","Bone Mail","Ember Cloak"],faction:"The Cindermarch"},"Cinder Mystic":{name:"Cinder Mystic",description:"Spellcasters who draw power from the remnant fires of the Great Burning.",statModifiers:{strength:1,constitution:2,wisdom:4,intelligence:4,dexterity:2,charisma:1},primaryStats:["Intelligence","Wisdom"],abilities:["Cinder Bolt","Flame Ward","Ash Scrying"],equipment:["Ember Staff","Cinderwoven Robes","Fire Gem"],faction:"Ember Cult"},"Dust Ranger":{name:"Dust Ranger",description:"Scouts and survivors who know every secret of the wasteland.",statModifiers:{strength:2,constitution:3,wisdom:3,intelligence:2,dexterity:4,charisma:1},primaryStats:["Dexterity","Wisdom"],abilities:["Track in Ash","Sandstorm Cloak","Desert Navigation"],equipment:["Recurved Bow","Desert Garb","Survival Pack"],faction:"Duskward Nomads"},Bonechanter:{name:"Bonechanter",description:"Necromantic priests who sing to the bones of the ancient dead.",statModifiers:{strength:1,constitution:2,wisdom:3,intelligence:3,dexterity:1,charisma:4},primaryStats:["Charisma","Wisdom"],abilities:["Bone Song","Speak with Dead","Ossify"],equipment:["Bone Flute","Death Shroud","Skull Talisman"],faction:"Bonechanters"},Stormcaller:{name:"Stormcaller",description:"Elemental mages who command lightning and wind magic.",statModifiers:{strength:1,constitution:2,wisdom:3,intelligence:4,dexterity:3,charisma:1},primaryStats:["Intelligence","Dexterity"],abilities:["Lightning Bolt","Wind Walk","Storm Shield"],equipment:["Storm Rod","Sky Silk Robes","Weather Compass"],faction:"Stormcaller Guild"},Voidwing:{name:"Voidwing",description:"Sky pirates who master aerial combat and void magic.",statModifiers:{strength:3,constitution:2,wisdom:1,intelligence:2,dexterity:4,charisma:2},primaryStats:["Dexterity","Strength"],abilities:["Void Step","Sky Strike","Gravity Defiance"],equipment:["Void Cutlass","Flight Harness","Pirate's Coat"],faction:"Voidwing Pirates"},"Sky Knight":{name:"Sky Knight",description:"Noble warriors who ride winged mounts and uphold celestial codes.",statModifiers:{strength:4,constitution:3,wisdom:2,intelligence:2,dexterity:2,charisma:3},primaryStats:["Strength","Charisma"],abilities:["Mount Bond","Celestial Strike","Knight's Valor"],equipment:["Sky Lance","Celestial Plate","Noble Seal"],faction:"Celestial Observatory"},"Wind Sage":{name:"Wind Sage",description:"Scholarly monks who study the patterns of air and aether.",statModifiers:{strength:1,constitution:2,wisdom:4,intelligence:3,dexterity:3,charisma:1},primaryStats:["Wisdom","Intelligence"],abilities:["Aether Sight","Wind Meditation","Air Walk"],equipment:["Meditation Staff","Wind Robes","Aether Crystal"],faction:"The Windwright Consortium"}},W=[{name:"Verdance",seed:"verdance-seed-001",description:"A lush frontier of spirit plants, deep roots, and hidden sects.",factions:["Hollowshade Clan","Valebright Court","Thornweave Syndicate","The Rootspeakers"],classes:["Greenwarden","Thorn Knight","Sapling Adept","Bloomcaller"],lore:"In the heart of the Verdance, ancient spirit plants pulse with ethereal light, their roots forming vast networks beneath the forest floor that whisper secrets across continents. The Hollowshade Clan has learned to walk between shadow and root, using umbral magic to commune with the deepest, oldest growths. They believe the plants hold memories of the world's first age, when magic flowed freely through all living things."},{name:"Ashenreach",seed:"ashenreach-seed-002",description:"A scorched expanse of ash dunes, ember cults, and bone singers.",factions:["Ember Cult","Bonechanters","Duskward Nomads","The Cindermarch"],classes:["Ashblade","Cinder Mystic","Dust Ranger","Bonechanter"],lore:"The Ashenreach was not always a wasteland. Once, it was the Golden Empire of Solmere, a realm of crystal spires and sun-blessed fields. But the Great Burning came without warning\u2014whether by dragon fire, fallen star, or the Empire's own hubris, none can say for certain."},{name:"Skyvault",seed:"skyvault-seed-003",description:"Floating citadels and shattered islands drifting in endless skies.",factions:["Stormcaller Guild","Voidwing Pirates","Celestial Observatory","The Windwright Consortium"],classes:["Stormcaller","Voidwing","Sky Knight","Wind Sage"],lore:"When the ancient world shattered in the Sundering, entire continents were cast into the sky, held aloft by veins of raw aetheric force. Now the Skyvault stretches across three layers of heaven."}];function H(e){let t=0;for(let n=9;n<=e;n++)t+=n<=14?1:n<=16?2:3;return t}const q={STR:8,DEX:8,CON:8,INT:8,WIS:8,CHA:8};function U(e,t,n){const r=Math.floor(e/2)+1,a=Math.floor((Math.max(t,n)-10)/2);return Math.max(1,r+Math.max(0,a))}function G(e,t,n){if(e<2)return 0;const r=Math.max(0,e-1),a=Math.floor((Math.max(t,n)-12)/2);return Math.max(0,r+Math.max(0,a))}function V(e){return e<2?0:e<4?1:e<6?2:e<8?3:e<10?4:e<12?5:e<14?6:e<16?7:e<18?8:9}function Y(e){return["wizard","sorcerer","warlock"].includes(e.toLowerCase())?"wizard":["cleric","druid","ranger","paladin"].includes(e.toLowerCase())?"cleric":["bard"].includes(e.toLowerCase())?"mixed":"none"}const K={Brave:{name:"Brave",description:"Resistant to fear and intimidation effects. +2 bonus to courage-based checks.",mechanicalEffect:"fear_resistance",bonus:{type:"courage",value:2}},Clever:{name:"Clever",description:"Quick thinking in complex situations. +2 bonus to puzzle-solving and investigation.",mechanicalEffect:"intelligence_bonus",bonus:{type:"investigation",value:2}},Cunning:{name:"Cunning",description:"Skilled at deception and misdirection. +2 bonus to stealth and deception checks.",mechanicalEffect:"deception_bonus",bonus:{type:"stealth",value:2}},Empathic:{name:"Empathic",description:"Deeply understands others' emotions. +2 bonus to persuasion and healing checks.",mechanicalEffect:"social_bonus",bonus:{type:"persuasion",value:2}},Stoic:{name:"Stoic",description:"Unshaken by pain or hardship. +2 bonus to endurance and resistance checks.",mechanicalEffect:"endurance_bonus",bonus:{type:"endurance",value:2}},Lucky:{name:"Lucky",description:"Fortune favors you. Once per encounter, reroll any failed check.",mechanicalEffect:"reroll_ability",bonus:{type:"reroll",value:1}},Observant:{name:"Observant",description:"Notice details others miss. +2 bonus to perception and awareness checks.",mechanicalEffect:"perception_bonus",bonus:{type:"perception",value:2}},"Silver Tongue":{name:"Silver Tongue",description:"Naturally persuasive speaker. +2 bonus to all social interaction checks.",mechanicalEffect:"social_master",bonus:{type:"social",value:2}},"Iron Will":{name:"Iron Will",description:"Mental fortitude against magical effects. +2 bonus to resist mental magic.",mechanicalEffect:"mental_resistance",bonus:{type:"mental_defense",value:2}},Swift:{name:"Swift",description:"Faster movement and reflexes. +2 bonus to speed and reaction checks.",mechanicalEffect:"speed_bonus",bonus:{type:"speed",value:2}},"Nature's Friend":{name:"Nature's Friend",description:"Animals and plants respond favorably. +2 bonus to nature-based interactions.",mechanicalEffect:"nature_bonus",bonus:{type:"nature",value:2}},"Keen Senses":{name:"Keen Senses",description:"Enhanced sensory perception. +2 bonus to detect hidden things or dangers.",mechanicalEffect:"detection_bonus",bonus:{type:"detection",value:2}},Patient:{name:"Patient",description:"Calm and methodical approach. +2 bonus to sustained concentration tasks.",mechanicalEffect:"concentration_bonus",bonus:{type:"concentration",value:2}},Resilient:{name:"Resilient",description:"Exceptionally tough constitution. +2 HP per level beyond normal.",mechanicalEffect:"hp_bonus",bonus:{type:"hp_per_level",value:2}},Hardy:{name:"Hardy",description:"Natural toughness and endurance. +1 HP per level beyond normal.",mechanicalEffect:"hp_bonus_small",bonus:{type:"hp_per_level",value:1}},Frail:{name:"Frail",description:"Delicate constitution, but often comes with other gifts. -2 HP per level.",mechanicalEffect:"hp_penalty",bonus:{type:"hp_per_level",value:-2}}},J=Object.keys(K),X={Human:{automatic:[],forbidden:[],preferred:["Brave","Clever","Silver Tongue"],description:"Adaptable and versatile, humans can develop any traits through experience."},Sylvanborn:{automatic:["Nature's Friend"],forbidden:["Cunning"],preferred:["Observant","Keen Senses","Patient"],description:"Forest dwellers with an innate connection to nature."},Alloy:{automatic:["Iron Will"],forbidden:["Empathic","Silver Tongue"],preferred:["Stoic","Patient","Clever"],description:"Mechanical beings with logical minds but limited emotional range."},Draketh:{automatic:["Brave"],forbidden:["Patient"],preferred:["Swift","Silver Tongue","Stoic"],description:"Proud dragon-descendants who rarely back down from challenges."},Voidkin:{automatic:["Observant"],forbidden:["Nature's Friend"],preferred:["Clever","Iron Will","Cunning"],description:"Shadow-touched beings with enhanced perception but unnatural aura."},Crystalborn:{automatic:["Stoic"],forbidden:["Swift"],preferred:["Iron Will","Patient","Keen Senses"],description:"Living crystal beings with incredible mental fortitude."},Stormcaller:{automatic:["Swift"],forbidden:["Patient"],preferred:["Brave","Observant","Silver Tongue"],description:"Sky-born people infused with elemental storm energy."}},$={Greenwarden:{automatic:["Nature's Friend"],forbidden:[],preferred:["Patient","Observant","Empathic"],description:"Nature's guardians with deep environmental connections."},"Thorn Knight":{automatic:["Brave"],forbidden:["Cunning"],preferred:["Stoic","Iron Will","Swift"],description:"Honorable warriors who face threats head-on."},"Sapling Adept":{automatic:["Patient"],forbidden:[],preferred:["Clever","Observant","Nature's Friend"],description:"Scholarly nature mages who study growth and renewal."},"Bloom Caller":{automatic:["Empathic"],forbidden:[],preferred:["Silver Tongue","Nature's Friend","Patient"],description:"Charismatic druids who inspire growth and healing."},"Dust Warden":{automatic:["Stoic"],forbidden:["Empathic"],preferred:["Brave","Iron Will","Observant"],description:"Ash-realm guardians hardened by harsh environments."},Cindermage:{automatic:["Clever"],forbidden:[],preferred:["Iron Will","Patient","Observant"],description:"Fire scholars who manipulate destructive forces."},"Ash Walker":{automatic:["Swift"],forbidden:["Patient"],preferred:["Observant","Cunning","Keen Senses"],description:"Desert scouts who move quickly through dangerous terrain."},"Ember Knight":{automatic:["Brave"],forbidden:["Cunning"],preferred:["Silver Tongue","Stoic","Iron Will"],description:"Noble flame warriors with strong moral codes."},"Storm Herald":{automatic:["Silver Tongue"],forbidden:[],preferred:["Swift","Brave","Observant"],description:"Sky leaders who command through charisma and storm power."},"Wind Sage":{automatic:["Keen Senses"],forbidden:[],preferred:["Clever","Patient","Iron Will"],description:"Aerial mystics with enhanced perception and wisdom."},"Cloud Walker":{automatic:["Swift"],forbidden:["Stoic"],preferred:["Observant","Lucky","Silver Tongue"],description:"Agile sky dancers who embrace freedom and movement."},"Sky Guardian":{automatic:["Brave"],forbidden:[],preferred:["Iron Will","Stoic","Observant"],description:"Stalwart defenders of the aerial realms."}},Q=["Human","Sylvanborn","Alloy","Draketh","Voidkin","Crystalborn","Stormcaller"],Z=["Female","Male"],ee=Object.keys(F),te={Human:{STR:1,CHA:1,CON:-1,WIS:-1},Sylvanborn:{DEX:2,WIS:1,STR:-2,CON:-1},Alloy:{CON:2,INT:1,DEX:-2,CHA:-1},Draketh:{STR:2,CHA:1,DEX:-1,WIS:-2},Voidkin:{INT:2,WIS:1,STR:-1,CHA:-2},Crystalborn:{CON:1,INT:2,DEX:-1,CHA:-2},Stormcaller:{DEX:1,CHA:2,CON:-1,STR:-2}},ne={};Object.entries(F).forEach(e=>{let[t,n]=e;ne[t]={STR:n.statModifiers.strength||0,DEX:n.statModifiers.dexterity||0,CON:n.statModifiers.constitution||0,INT:n.statModifiers.intelligence||0,WIS:n.statModifiers.wisdom||0,CHA:n.statModifiers.charisma||0}});const re=["A former {profession} who left their old life behind after {event}. Now they seek {goal} in the wider world.","Born in {location}, they were raised by {guardian} and learned the ways of {skill}. Their greatest challenge was {challenge}.","Once served as {role} until {tragedy} changed everything. Now they wander, carrying {burden} and seeking {redemption}.","Discovered their {talent} at a young age in {homeland}. After {incident}, they must now {quest}.","A {descriptor} soul from {origin} who {past_action}. Their destiny was forever changed when {turning_point}."],ae={profession:["merchant","soldier","scholar","artisan","noble","farmer","sailor","miner"],event:["a great betrayal","a mystical awakening","a terrible loss","a divine vision","a forbidden discovery"],goal:["redemption","knowledge","vengeance","peace","power","understanding","justice"],location:["the mountains","the deep forests","a bustling city","a remote village","the desert wastes","coastal towns"],guardian:["wise elders","a mysterious mentor","ancient spirits","temple priests","nomadic tribes"],skill:["combat","magic","diplomacy","survival","crafting","healing"],challenge:["surviving in the wilderness","uncovering dark secrets","protecting their community","mastering their abilities"],role:["a royal guard","a temple acolyte","a guild member","a traveling performer","a court advisor"],tragedy:["war came to their lands","a plague struck","they were falsely accused","dark forces emerged"],burden:["ancient knowledge","a family secret","a cursed artifact","the weight of prophecy"],redemption:["to right past wrongs","to prove their worth","to save their people","to break an ancient curse"],talent:["gift for magic","exceptional strength","keen insight","natural charisma","connection to nature"],homeland:["the crystal caves","the floating islands","the shadow realm","the golden plains"],incident:["the great storm","a dragon's attack","political upheaval","a mystical convergence"],quest:["find their true purpose","restore balance","uncover their heritage","save their homeland"],descriptor:["wandering","noble","mysterious","brave","cunning","wise","fierce"],origin:["distant lands","humble beginnings","royal bloodline","ancient lineage","forgotten realms"],past_action:["fought in great battles","studied forbidden lore","communed with spirits","crafted legendary items"],turning_point:["they discovered their true nature","fate intervened","they made a fateful choice","destiny called"]},ie=[{name:"Kira Stormwind",gender:"Female",species:"Stormcaller",archetype:"Mystic",background:"A former temple acolyte who left their old life behind after a mystical awakening. Now they seek knowledge in the wider world, wielding storm magic passed down through generations.",stats:{STR:10,DEX:14,CON:12,INT:15,WIS:13,CHA:11},traits:["Observant","Silver Tongue","Swift"],portraitUrl:"https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=300&h=300&fit=crop&crop=face",mode:"POINT_BUY"},{name:"Marcus Ironforge",gender:"Male",species:"Alloy",archetype:"Artificer",background:"Born in the crystal caves, he was raised by wise elders and learned the ways of crafting. His greatest challenge was mastering the fusion of magic and metal that defines his people.",stats:{STR:13,DEX:11,CON:15,INT:14,WIS:12,CHA:8},traits:["Clever","Iron Will","Stoic"],portraitUrl:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=300&h=300&fit=crop&crop=face",mode:"POINT_BUY"},{name:"Zara Nightwhisper",gender:"Female",species:"Voidkin",archetype:"Rogue",background:"A wandering soul from the shadow realm who fought in great battles against the encroaching darkness. Her destiny was forever changed when she discovered her connection to the void grants her unique abilities.",stats:{STR:9,DEX:15,CON:11,INT:12,WIS:14,CHA:13},traits:["Cunning","Lucky","Observant"],portraitUrl:"https://images.unsplash.com/photo-1494790108755-2616c4b43e69?w=300&h=300&fit=crop&crop=face",mode:"POINT_BUY"}];function oe(e,t){if(e>=ge)return!1;const n=e+1,r=H(e);return t>=H(n)-r}const se={display:"grid",gap:16,gridTemplateColumns:"1fr 420px",padding:24,alignItems:"start"},le={border:"1px solid #cbd5e1",borderRadius:12,padding:16,background:"#0b0e12",color:"#e5e7eb"},ce={margin:"8px 0 4px",opacity:.9};function de(e,t){return Math.floor(Math.random()*(t-e+1))+e}function ue(e,t){const n=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),r=URL.createObjectURL(n),a=document.createElement("a");a.href=r,a.download=e,a.click(),URL.revokeObjectURL(r)}function he(e){return Math.floor((e-8)/2)}function pe(e,t,n,r){var a,i;let o=e;o+=(null===(a=te[n])||void 0===a?void 0:a[t])||0;return o+=(null===(i=ne[r])||void 0===i?void 0:i[t])||0,Math.max(3,Math.min(o,22))}const ge=20;function fe(){var e,t;const[n,r]=(0,l.useState)({name:"",gender:"",species:"",archetype:"",background:"",stats:s({},q),traits:[],portraitUrl:"",mode:"POINT_BUY",level:1,knownSpells:[],knownCantrips:[]}),a=27-(0,l.useMemo)(()=>{let e=0;return Object.keys(n.stats).forEach(t=>{e+=H(n.stats[t])}),e},[n.stats]);function i(e,t){r(n=>s(s({},n),{},{[e]:t}))}function o(){const e=new Set;if(n.species){const t=X[n.species];t&&t.automatic.forEach(t=>e.add(t))}if(n.archetype){const t=$[n.archetype];t&&t.automatic.forEach(t=>e.add(t))}return Array.from(e)}function c(e){if(n.species){const t=X[n.species];if(null!==t&&void 0!==t&&t.forbidden&&t.forbidden.includes(e))return!0}if(n.archetype){const t=$[n.archetype];if(null!==t&&void 0!==t&&t.forbidden&&t.forbidden.includes(e))return!0}return!1}l.useEffect(()=>{const e=o(),t=new Set(n.traits);let a=!1;e.forEach(e=>{t.has(e)||(t.add(e),a=!0)}),Array.from(t).forEach(e=>{c(e)&&(t.delete(e),a=!0)}),a&&r(e=>s(s({},e),{},{traits:Array.from(t)}))},[n.species,n.archetype]);const d=(0,l.useMemo)(()=>{const e=n.level||1,t=pe(n.stats.CON,"CON",n.species,n.archetype),r=pe(n.stats.STR,"STR",n.species,n.archetype),a=pe(n.stats.DEX,"DEX",n.species,n.archetype);let i=he(t),o=0;o="Thorn Knight"===n.archetype||"Crystal Guardian"===n.archetype||"Ironclad"===n.archetype?3:"Ashblade"===n.archetype||"Stormbreaker"===n.archetype||"Voidhunter"===n.archetype||"Greenwarden"===n.archetype||"Guardian"===n.archetype||"Warrior"===n.archetype?2:"Ranger"===n.archetype||"Rogue"===n.archetype||"Artificer"===n.archetype||"Healer"===n.archetype||"Bloomcaller"===n.archetype||"Mystic"===n.archetype?1:0;let s=0;"Alloy"===n.species||"Draketh"===n.species?s=2:"Crystalborn"===n.species||"Human"===n.species?s=1:"Voidkin"===n.species?s=0:"Sylvanborn"===n.species?s=-1:"Stormcaller"===n.species&&(s=0);let l=0;n.traits.includes("Resilient")&&(l+=2),n.traits.includes("Hardy")&&(l+=1),n.traits.includes("Frail")&&(l-=2);const c=Math.max(1,i+o+s+l),d=10+c*(e-1);let u=0;e>=16?u+=2:e>=8&&(u+=1);const h=n.archetype;"Thorn Knight"===h||"Ashblade"===h||"Ironclad"===h||"Stormbreaker"===h||"Voidhunter"===h||"Crystal Guardian"===h?e>=15?u+=2:e>=7&&(u+=1):"Greenwarden"===h||"Guardian"===h||"Warrior"===h?e>=10&&(u+=1):"Ranger"!==h&&"Rogue"!==h&&"Artificer"!==h||e>=15&&(u+=1),"Alloy"===n.species?e>=12&&(u+=1):"Draketh"===n.species?e>=15&&(u+=1):"Crystalborn"===n.species&&e>=15&&(u+=1),u=Math.min(u,5);return{level:e,hp:d,ac:10+he(a)+u,carry:15*r,naturalACBonus:u,totalHPPerLevel:c,classHPBonus:o,raceHPBonus:s,traitHPBonus:l}},[n.stats,n.species,n.archetype,n.level,n.traits]);return(0,p.jsxs)("div",{style:se,children:[(0,p.jsxs)("div",{style:{display:"grid",gap:16},children:[(0,p.jsxs)("div",{style:le,children:[(0,p.jsx)("h2",{style:ce,children:"Identity"}),(0,p.jsxs)("div",{style:{display:"grid",gap:8},children:[(0,p.jsx)(me,{label:"Name",value:n.name,onChange:e=>i("name",e)}),(0,p.jsx)(ye,{label:"Gender",value:n.gender,onChange:e=>i("gender",e),options:Z}),(0,p.jsx)(ye,{label:"Species",value:n.species,onChange:e=>i("species",e),options:Q}),n.species&&te[n.species]&&(0,p.jsxs)("div",{style:{fontSize:12,opacity:.7,marginTop:-4},children:["Racial modifiers: ",Object.entries(te[n.species]).map(e=>{let[t,n]=e;return"".concat(t," ").concat(n>0?"+":"").concat(n)}).join(", ")]}),(0,p.jsx)(ye,{label:"Class",value:n.archetype,onChange:e=>i("archetype",e),options:ee}),(0,p.jsxs)("div",{style:{display:"grid",gap:4},children:[(0,p.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:(0,p.jsx)("span",{children:"Level"})}),(0,p.jsx)("input",{type:"number",min:"1",max:"20",value:n.level||1,onChange:e=>i("level",parseInt(e.target.value)||1),style:{padding:"8px",border:"1px solid #374151",borderRadius:"4px",background:"#1f2937",color:"#f9fafb",fontSize:"14px"}})]}),(0,p.jsxs)("div",{style:{display:"grid",gap:4},children:[(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,p.jsx)("span",{children:"Background"}),(0,p.jsx)("button",{onClick:()=>i("background",re[Math.floor(Math.random()*re.length)].replace(/\{(\w+)\}/g,(e,t)=>{const n=ae[t];return n?n[Math.floor(Math.random()*n.length)]:e})),style:{padding:"4px 8px",fontSize:"12px",background:"#374151",color:"#e5e7eb",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Generate Random"})]}),(0,p.jsx)("textarea",{value:n.background,onChange:e=>i("background",e.target.value),placeholder:"One-paragraph origin story...",rows:4,style:{padding:8,borderRadius:8,border:"1px solid #334155",background:"#0f172a",color:"#e5e7eb",resize:"vertical"}})]}),(0,p.jsxs)("div",{style:{display:"grid",gap:4},children:[(0,p.jsx)("span",{children:"Portrait"}),(0,p.jsxs)("div",{style:{padding:"12px",background:"#1e293b",borderRadius:"8px",border:"1px solid #475569"},children:[(0,p.jsx)("div",{style:{fontSize:"14px",color:"#e5e7eb",fontWeight:"bold",marginBottom:"8px"},children:"\ufffd Live Portrait Preview"}),(0,p.jsx)("div",{style:{fontSize:"12px",color:"#94a3b8",marginBottom:"8px"},children:"Your character portrait is generated automatically and displayed in the preview panel \u2192"}),(0,p.jsx)("div",{style:{fontSize:"11px",color:"#64748b"},children:"Portrait updates live as you change name, species, and class. When you save, a snapshot will be stored with your character."})]})]})]})]}),(0,p.jsxs)("div",{style:le,children:[(0,p.jsx)("h2",{style:ce,children:"Abilities"}),(0,p.jsxs)("div",{style:{display:"flex",gap:12,marginBottom:8},children:[(0,p.jsxs)("label",{children:[(0,p.jsx)("input",{type:"radio",checked:"POINT_BUY"===n.mode,onChange:()=>i("mode","POINT_BUY")})," Point Buy"]}),(0,p.jsxs)("label",{children:[(0,p.jsx)("input",{type:"radio",checked:"ROLL"===n.mode,onChange:()=>i("mode","ROLL")})," Roll (4d6 drop lowest)"]}),"ROLL"===n.mode&&(0,p.jsx)("button",{onClick:function(){const e=s({},q);Object.keys(e).forEach(t=>{e[t]=function(){const e=[de(1,6),de(1,6),de(1,6),de(1,6)];return e.sort((e,t)=>t-e),e[0]+e[1]+e[2]}()}),r(t=>s(s({},t),{},{stats:e}))},style:{marginLeft:"auto"},children:"Roll All"})]}),"POINT_BUY"===n.mode&&(0,p.jsxs)("div",{style:{marginBottom:8,opacity:.9},children:["Points left: ",(0,p.jsx)("strong",{children:a})," (Pool: ",27,", range ",8,"\u2013",ge,")",(0,p.jsx)("div",{style:{fontSize:12,marginTop:4,opacity:.7},children:"Cost: 8-13 = 1 point each, 14-15 = 2 points each, 16-20 = 3 points each"})]}),(0,p.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:8},children:Object.keys(n.stats).map(e=>{const t=n.stats[e],i=pe(t,e,n.species,n.archetype),o=function(e,t,n){var r,a;const i=(null===(r=te[t])||void 0===r?void 0:r[e])||0,o=(null===(a=ne[n])||void 0===a?void 0:a[e])||0;let s="";return i>0&&(s+=" +".concat(i," racial")),i<0&&(s+=" ".concat(i," racial")),o>0&&(s+=" +".concat(o," class")),o<0&&(s+=" ".concat(o," class")),s}(e,n.species,n.archetype);return(0,p.jsxs)("div",{style:{border:"1px solid #334155",borderRadius:10,padding:10},children:[(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,p.jsx)("strong",{children:e}),"POINT_BUY"===n.mode&&(0,p.jsxs)("span",{children:[(0,p.jsx)("button",{onClick:()=>{return t=e,void r(e=>{const n=e.stats[t];return"POINT_BUY"!==e.mode||n<=8?e:s(s({},e),{},{stats:s(s({},e.stats),{},{[t]:n-1})})});var t},disabled:n.stats[e]<=8,children:"\u2212"}),(0,p.jsx)("button",{onClick:()=>{return t=e,void r(e=>{const n=e.stats[t];return"POINT_BUY"!==e.mode||n>=ge?e:oe(n,a)?s(s({},e),{},{stats:s(s({},e.stats),{},{[t]:n+1})}):e});var t},disabled:n.stats[e]>=ge||!oe(n.stats[e],a),style:{marginLeft:6},children:"\uff0b"})]})]}),(0,p.jsx)("div",{style:{fontSize:28,textAlign:"center",marginTop:6},children:i!==t?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("span",{style:{opacity:.6},children:t}),(0,p.jsxs)("span",{style:{color:i>t?"#10b981":"#ef4444",marginLeft:4},children:["\u2192",i]})]}):i}),(0,p.jsxs)("div",{style:{fontSize:12,textAlign:"center",opacity:.8},children:["mod ",he(i)>=0?"+":"",he(i)]}),o&&(0,p.jsx)("div",{style:{fontSize:10,textAlign:"center",opacity:.6,marginTop:2},children:o})]},e)})})]}),(0,p.jsxs)("div",{style:le,children:[(0,p.jsxs)("h2",{style:ce,children:["Traits ",(0,p.jsxs)("small",{style:{opacity:.7},children:["(choose up to ",2,")"]})]}),(0,p.jsx)("div",{style:{marginBottom:"16px",padding:"12px",background:"rgba(71, 85, 105, 0.1)",border:"1px solid #475569",borderRadius:"8px"},children:(0,p.jsxs)("div",{style:{display:"flex",gap:"24px",fontSize:"0.85em",color:"#94a3b8"},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("span",{style:{color:"#10b981",fontWeight:"bold"},children:"\u25cf"})," Automatic - Required by your species/class"]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("span",{style:{color:"#f59e0b",fontWeight:"bold"},children:"\u25cf"})," Recommended - Fits your background well"]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("span",{style:{color:"#ef4444",fontWeight:"bold"},children:"\u25cf"})," Forbidden - Conflicts with your nature"]})]})}),(n.species||n.archetype)&&(0,p.jsxs)("div",{style:{marginBottom:"16px",padding:"12px",background:"rgba(30, 41, 59, 0.5)",border:"1px solid #334155",borderRadius:"8px"},children:[n.species&&X[n.species]&&(0,p.jsxs)("div",{style:{marginBottom:n.archetype?"8px":"0"},children:[(0,p.jsxs)("strong",{style:{color:"#e2e8f0"},children:["Species - ",n.species,":"]}),(0,p.jsx)("div",{style:{color:"#94a3b8",marginLeft:"8px",fontSize:"0.9em",marginTop:"2px"},children:X[n.species].description})]}),n.archetype&&$[n.archetype]&&(0,p.jsxs)("div",{children:[(0,p.jsxs)("strong",{style:{color:"#e2e8f0"},children:["Class - ",n.archetype,":"]}),(0,p.jsx)("div",{style:{color:"#94a3b8",marginLeft:"8px",fontSize:"0.9em",marginTop:"2px"},children:$[n.archetype].description})]})]}),(0,p.jsx)("div",{style:{display:"grid",gap:12},children:J.map(e=>{const t=K[e],a=n.traits.includes(e),i=o().includes(e),l=c(e),d=function(e){if(n.species){const t=X[n.species];if(null!==t&&void 0!==t&&t.preferred&&t.preferred.includes(e))return!0}if(n.archetype){const t=$[n.archetype];if(null!==t&&void 0!==t&&t.preferred&&t.preferred.includes(e))return!0}return!1}(e),u=!a&&n.traits.length>=2||l;let h="#374151",g="rgba(15, 23, 42, 0.5)",f="",m="";return i?(h="#10b981",g="rgba(16, 185, 129, 0.1)",f="AUTOMATIC",m="#10b981"):l?(h="#ef4444",g="rgba(239, 68, 68, 0.1)",f="FORBIDDEN",m="#ef4444"):a?(h="#3b82f6",g="rgba(59, 130, 246, 0.1)"):d&&(h="#f59e0b",g="rgba(245, 158, 11, 0.05)",f="RECOMMENDED",m="#f59e0b"),(0,p.jsxs)("label",{style:{display:"flex",gap:12,alignItems:"flex-start",padding:"12px",border:"2px solid ".concat(h),borderRadius:"8px",background:g,cursor:u&&!i?"not-allowed":"pointer",opacity:u&&!i?.5:1,position:"relative"},children:[(0,p.jsx)("input",{type:"checkbox",checked:a,onChange:()=>!i&&!l&&function(e){r(t=>t.traits.includes(e)?s(s({},t),{},{traits:t.traits.filter(t=>t!==e)}):t.traits.length>=2?t:s(s({},t),{},{traits:[...t.traits,e]}))}(e),disabled:i||l||!a&&n.traits.length>=2,style:{marginTop:"2px"}}),(0,p.jsxs)("div",{style:{flex:1},children:[(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,p.jsx)("div",{style:{fontWeight:"bold",color:"#f1f5f9"},children:t.name}),f&&(0,p.jsx)("span",{style:{fontSize:"0.7em",padding:"2px 6px",borderRadius:"4px",backgroundColor:m,color:"white",fontWeight:"bold"},children:f})]}),(0,p.jsx)("div",{style:{fontSize:"0.9em",color:"#94a3b8",marginTop:"4px"},children:t.description})]})]},e)})}),n.traits.length>0&&(0,p.jsxs)("div",{style:{marginTop:"16px",padding:"12px",background:"rgba(16, 185, 129, 0.1)",border:"1px solid #10b981",borderRadius:"8px"},children:[(0,p.jsx)("h3",{style:{margin:"0 0 8px",color:"#10b981",fontSize:"1rem"},children:"Active Trait Benefits:"}),(u=n,u.traits.map(e=>{const t=K[e];return t?"".concat(t.name,": ").concat(t.description):"".concat(e,": Unknown effect")})).map((e,t)=>(0,p.jsxs)("div",{style:{fontSize:"0.9em",color:"#e5e7eb",marginBottom:"4px"},children:["\u2022 ",e]},t))]})]}),"none"!==Y(n.archetype)&&(0,p.jsxs)("div",{style:le,children:[(0,p.jsx)("h2",{style:ce,children:"Spells & Cantrips"}),(0,p.jsxs)("div",{style:{marginBottom:"16px",padding:"12px",background:"rgba(59, 130, 246, 0.1)",border:"1px solid #3b82f6",borderRadius:"8px"},children:[(0,p.jsxs)("h3",{style:{margin:"0 0 8px",color:"#3b82f6",fontSize:"1rem"},children:["Spell Capacity (",Y(n.archetype)," caster):"]}),(0,p.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",fontSize:"0.9em"},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Cantrips:"})," ",(null===(e=n.knownCantrips)||void 0===e?void 0:e.length)||0," / ",U(n.level||1,n.stats.INT,n.stats.WIS)]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Spells:"})," ",(null===(t=n.knownSpells)||void 0===t?void 0:t.length)||0," / ",G(n.level||1,n.stats.INT,n.stats.WIS)]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Max Spell Level:"})," ",V(n.level||1)]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Primary Ability:"})," ","wizard"===Y(n.archetype)?"INT (".concat(n.stats.INT,")"):"cleric"===Y(n.archetype)?"WIS (".concat(n.stats.WIS,")"):"INT (".concat(n.stats.INT,") or WIS (").concat(n.stats.WIS,")")]})]})]}),(0,p.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,p.jsx)("h3",{style:{margin:"0 0 8px",color:"#8b5cf6",fontSize:"1.1rem"},children:"Known Cantrips:"}),(0,p.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px",marginBottom:"8px"},children:(n.knownCantrips||[]).map((e,t)=>{const r=JSON.parse(localStorage.getItem("world-engine-saved-spells")||"[]").find(t=>t.name===e&&0===t.level);return(0,p.jsxs)("span",{style:{background:"#1e293b",color:"#e2e8f0",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",border:"1px solid #8b5cf6",display:"flex",alignItems:"center",gap:"4px"},children:[(null===r||void 0===r?void 0:r.name)||e,(0,p.jsx)("button",{onClick:()=>{i("knownCantrips",(n.knownCantrips||[]).filter((e,n)=>n!==t))},style:{background:"none",border:"none",color:"#ef4444",cursor:"pointer",padding:"0",fontSize:"12px"},children:"\u2715"})]},t)})}),(0,p.jsx)("button",{onClick:()=>{const e=JSON.parse(localStorage.getItem("world-engine-saved-spells")||"[]").filter(e=>0===e.level&&!(n.knownCantrips||[]).includes(e.name));if(0===e.length)return void alert("No saved cantrips available! Create some cantrips in the Spell Generator first.");if((n.knownCantrips||[]).length>=U(n.level||1,n.stats.INT,n.stats.WIS))return void alert("Maximum cantrips reached! Increase level or ability scores for more.");const t=e[Math.floor(Math.random()*e.length)];i("knownCantrips",[...n.knownCantrips||[],t.name])},disabled:(n.knownCantrips||[]).length>=U(n.level||1,n.stats.INT,n.stats.WIS),style:{padding:"6px 12px",background:(n.knownCantrips||[]).length>=U(n.level||1,n.stats.INT,n.stats.WIS)?"#374151":"#8b5cf6",color:"#f9fafb",border:"none",borderRadius:"4px",cursor:(n.knownCantrips||[]).length>=U(n.level||1,n.stats.INT,n.stats.WIS)?"not-allowed":"pointer",fontSize:"12px"},children:"+ Add Random Cantrip"})]}),G(n.level||1,n.stats.INT,n.stats.WIS)>0&&(0,p.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,p.jsx)("h3",{style:{margin:"0 0 8px",color:"#8b5cf6",fontSize:"1.1rem"},children:"Known Spells:"}),(0,p.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px",marginBottom:"8px"},children:(n.knownSpells||[]).map((e,t)=>{const r=JSON.parse(localStorage.getItem("world-engine-saved-spells")||"[]").find(t=>t.name===e&&t.level>0);return(0,p.jsxs)("span",{style:{background:"#1e293b",color:"#e2e8f0",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",border:"1px solid #3b82f6",display:"flex",alignItems:"center",gap:"4px"},children:[(null===r||void 0===r?void 0:r.name)||e," ",r&&"(".concat(r.level,")"),(0,p.jsx)("button",{onClick:()=>{i("knownSpells",(n.knownSpells||[]).filter((e,n)=>n!==t))},style:{background:"none",border:"none",color:"#ef4444",cursor:"pointer",padding:"0",fontSize:"12px"},children:"\u2715"})]},t)})}),(0,p.jsxs)("button",{onClick:()=>{const e=JSON.parse(localStorage.getItem("world-engine-saved-spells")||"[]"),t=V(n.level||1),r=e.filter(e=>e.level>0&&e.level<=t&&!(n.knownSpells||[]).includes(e.name));if(0===r.length)return void alert("No saved spells available up to level ".concat(t,"! Create some spells in the Spell Generator first."));if((n.knownSpells||[]).length>=G(n.level||1,n.stats.INT,n.stats.WIS))return void alert("Maximum spells reached! Increase level or ability scores for more.");const a=r[Math.floor(Math.random()*r.length)];i("knownSpells",[...n.knownSpells||[],a.name])},disabled:(n.knownSpells||[]).length>=G(n.level||1,n.stats.INT,n.stats.WIS),style:{padding:"6px 12px",background:(n.knownSpells||[]).length>=G(n.level||1,n.stats.INT,n.stats.WIS)?"#374151":"#3b82f6",color:"#f9fafb",border:"none",borderRadius:"4px",cursor:(n.knownSpells||[]).length>=G(n.level||1,n.stats.INT,n.stats.WIS)?"not-allowed":"pointer",fontSize:"12px"},children:["+ Add Random Spell (max level ",V(n.level||1),")"]})]}),0===G(n.level||1,n.stats.INT,n.stats.WIS)&&(0,p.jsxs)("div",{style:{padding:"12px",background:"rgba(156, 163, 175, 0.1)",border:"1px solid #6b7280",borderRadius:"8px",textAlign:"center",color:"#9ca3af"},children:["No spells available at level ",n.level||1,". Reach level 2 to learn spells!"]})]}),(0,p.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,p.jsx)("button",{onClick:async function(){if(n.name.trim())try{const e=s(s({},n),{},{createdAt:(new Date).toISOString()});localStorage.setItem("we:lastCharacter",JSON.stringify(e)),ue("".concat(n.name.replace(/\s+/g,"_"),".json"),e),console.log("\u2705 Character saved successfully")}catch(e){console.error("Error saving character:",e);const t=s(s({},n),{},{createdAt:(new Date).toISOString()});localStorage.setItem("we:lastCharacter",JSON.stringify(t)),ue("".concat(n.name.replace(/\s+/g,"_"),".json"),t)}else alert("Give your character a name before saving.")},children:"Save (JSON + local)"}),(0,p.jsx)("button",{onClick:async function(){if(n.name.trim()){console.log("Saving character to library:",n);try{const e=await s({},n),t=JSON.parse(localStorage.getItem("world-engine-characters")||"[]");console.log("Existing characters:",t);const r={id:"char-".concat(Date.now()),name:e.name,race:e.species,characterClass:e.archetype,level:e.level||1,createdAt:(new Date).toISOString(),data:s(s({},e),{},{createdAt:(new Date).toISOString()})};console.log("Character data to save:",r),t.push(r),localStorage.setItem("world-engine-characters",JSON.stringify(t)),localStorage.setItem("world-engine-characters-backup",JSON.stringify(t)),console.log("Saved to localStorage, total characters:",t.length),alert("".concat(n.name," has been saved to your character library!"))}catch(e){console.error("Error saving to library:",e),alert("Error saving character to library.")}}else alert("Give your character a name before saving.")},children:"Save to Library"}),(0,p.jsx)("button",{onClick:function(){const e=localStorage.getItem("we:lastCharacter");if(!e)return alert("No saved character found.");try{r(JSON.parse(e))}catch(t){alert("Save file corrupted.")}},children:"Load Last"}),(0,p.jsx)("button",{onClick:function(){r({name:"",gender:"",species:"",archetype:"",background:"",stats:s({},q),traits:[],portraitUrl:"",mode:"POINT_BUY"})},children:"Reset"})]}),(0,p.jsxs)("div",{style:le,children:[(0,p.jsx)("h2",{style:ce,children:"Premade Characters"}),(0,p.jsx)("div",{style:{display:"grid",gap:8},children:ie.map(e=>(0,p.jsxs)("div",{style:{border:"1px solid #334155",borderRadius:8,padding:12,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("div",{children:(0,p.jsx)("strong",{children:e.name})}),(0,p.jsxs)("div",{style:{fontSize:"12px",opacity:.8},children:[e.species," ",e.archetype," \u2022 ",e.traits.join(", ")]})]}),(0,p.jsx)("button",{onClick:()=>function(e){r(s({},e))}(e),style:{padding:"6px 12px",background:"#059669",color:"#f9fafb",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:"Load"})]},e.name))})]})]}),(0,p.jsxs)("div",{style:le,children:[(0,p.jsx)("h2",{style:{marginTop:0},children:"Preview"}),(console.log("\ud83e\uddea CharacterCreate: Preview section - checking character data:",{hasName:!!n.name,hasSpecies:!!n.species,hasArchetype:!!n.archetype,name:n.name,species:n.species,archetype:n.archetype,level:n.level}),n.name&&n.species&&n.archetype&&n.gender?(console.log("\u2705 CharacterCreate: Rendering SimplePortraitPreview with full character data"),(0,p.jsx)("div",{style:{width:"100%",borderRadius:12,marginBottom:8},children:(0,p.jsx)(f,{gender:n.gender.toLowerCase(),species:n.species.toLowerCase(),archetype:n.archetype.toLowerCase(),size:"large",showDebug:!0})})):(console.log("\u23f8\ufe0f CharacterCreate: NOT rendering SimplePortraitPreview - missing data"),(0,p.jsx)("div",{style:{border:"1px dashed #334155",borderRadius:12,padding:12,textAlign:"center",marginBottom:8,opacity:.7},children:"Add a name, gender, species, and class to see portrait"}))),(0,p.jsx)("div",{children:(0,p.jsx)("strong",{children:n.name||"Unnamed Adventurer"})}),(0,p.jsx)("div",{style:{opacity:.8,marginBottom:8},children:[n.gender,n.species,n.archetype].filter(Boolean).join(" \u2022 ")}),(0,p.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:6,marginBottom:8},children:Object.keys(n.stats).map(e=>{const t=pe(n.stats[e],e,n.species,n.archetype);return(0,p.jsxs)("div",{style:{background:"#0f172a",border:"1px solid #334155",borderRadius:8,padding:8,textAlign:"center"},children:[(0,p.jsx)("div",{style:{fontSize:12,opacity:.8},children:e}),(0,p.jsx)("div",{style:{fontSize:20},children:t}),(0,p.jsxs)("div",{style:{fontSize:12,opacity:.8},children:["(",he(t)>=0?"+":"",he(t),")"]})]},e)})}),(0,p.jsxs)("div",{style:{marginBottom:8},children:[(0,p.jsxs)("div",{children:["HP: ",(0,p.jsx)("strong",{children:d.hp})," \u2022 AC: ",(0,p.jsx)("strong",{children:d.ac})," \u2022 Carry: ",(0,p.jsx)("strong",{children:d.carry})]}),d.naturalACBonus>0&&(0,p.jsxs)("div",{style:{fontSize:12,opacity:.7,marginTop:2},children:["Natural AC Bonus: +",d.naturalACBonus," (from level/class/race)"]}),(d.classHPBonus>0||0!==d.raceHPBonus||0!==d.traitHPBonus)&&(0,p.jsxs)("div",{style:{fontSize:12,opacity:.7,marginTop:2},children:["HP per level: ",d.totalHPPerLevel," = ",he(pe(n.stats.CON,"CON",n.species,n.archetype))," (CON)",d.classHPBonus>0&&" + ".concat(d.classHPBonus," (").concat(n.archetype,")"),0!==d.raceHPBonus&&" ".concat(d.raceHPBonus>=0?"+":"").concat(d.raceHPBonus," (").concat(n.species,")"),0!==d.traitHPBonus&&" ".concat(d.traitHPBonus>=0?"+":"").concat(d.traitHPBonus," (traits)")]}),n.traits.length>0&&(0,p.jsxs)("div",{style:{marginTop:6},children:["Traits: ",n.traits.join(", ")]})]}),n.background&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("h3",{style:ce,children:"Background"}),(0,p.jsx)("p",{style:{whiteSpace:"pre-wrap",lineHeight:1.35},children:n.background})]})]})]});var u}function me(e){const{label:t,value:n,onChange:r,placeholder:a}=e;return(0,p.jsxs)("label",{style:{display:"grid",gap:4},children:[(0,p.jsx)("span",{children:t}),(0,p.jsx)("input",{value:n,onChange:e=>r(e.target.value),placeholder:a,style:{padding:8,borderRadius:8,border:"1px solid #334155",background:"#0f172a",color:"#e5e7eb"}})]})}function ye(e){const{label:t,value:n,onChange:r,options:a}=e;return(0,p.jsxs)("label",{style:{display:"grid",gap:4},children:[(0,p.jsx)("span",{children:t}),(0,p.jsxs)("select",{value:n,onChange:e=>r(e.target.value),style:{padding:8,borderRadius:8,border:"1px solid #334155",background:"#0f172a",color:"#e5e7eb",cursor:"pointer"},children:[(0,p.jsxs)("option",{value:"",children:["Select ",t,"..."]}),a.map(e=>(0,p.jsx)("option",{value:e,children:e},e))]})]})}const ve={human:{male:{first:["Aiden","Aldric","Arthur","Bjorn","Caius","Damien","Edmund","Gareth","Hector","Ivan","Jasper","Kai","Leander","Marcus","Nolan","Owen","Pierce","Quinn","Rowan","Soren","Thane","Ulric","Victor","Willem","Xavier","Yorick","Zander"],last:["Blackwood","Brightblade","Stormwind","Ironforge","Goldleaf","Silverstone","Ravencrest","Drakemoor","Thornfield","Ashworth","Redmane","Whitehall","Greycastle","Bluestone","Greenwood"]},female:{first:["Aria","Brenna","Celeste","Diana","Elena","Freya","Gwen","Helena","Iris","Jade","Kira","Luna","Mira","Nora","Olivia","Petra","Quinn","Raven","Sera","Tara","Una","Vera","Willa","Xara","Yara","Zara"],last:["Blackwood","Brightblade","Stormwind","Ironforge","Goldleaf","Silverstone","Ravencrest","Drakemoor","Thornfield","Ashworth","Redmane","Whitehall","Greycastle","Bluestone","Greenwood"]}},elf:{male:{first:["Aelindra","Beiro","Celeborn","Daeron","Elrond","Faelar","Galinndan","Halimath","Ivellios","Jaelynn","Kelvhan","Lamlis","Mindartis","Naal","Otaehryn","Peren","Quarion","Riardon","Silvyr","Thamior","Uldreyin","Vanuath","Wranvyre","Xalvador","Yeshelne","Zoltan"],last:["Amakir","Amakir","Bereris","Cithreth","Enna","Galinndan","Hadarai","Immeral","Ivellios","Korfel","Lamlis","Mindartis","Naal","Nutae","Paelinn","Peren","Riardon","Rolen","Silvyr","Suhnaal","Thamior","Theriatis","Theriapis","Thervan","Uthemar","Vanuath","Varis"]},female:{first:["Adrie","Birel","Caelynn","Dara","Enna","Galinndan","Hadarai","Immeral","Ivellios","Jannalor","Korfel","Lamlis","Mialee","Nutae","Quelenna","Sariel","Shanairra","Shava","Silaqui","Suhnaal","Thamior","Theriatis","Theriapis","Thervan","Uthemar","Vanuath","Varis"],last:["Amakir","Bereris","Cithreth","Enna","Galinndan","Hadarai","Immeral","Ivellios","Korfel","Lamlis","Mindartis","Naal","Nutae","Paelinn","Peren","Riardon","Rolen","Silvyr","Suhnaal","Thamior","Theriatis","Theriapis","Thervan","Uthemar","Vanuath","Varis"]}},dwarf:{male:{first:["Adrik","Baern","Darrak","Eberk","Fargrim","Gardain","Harbek","Kildrak","Morgran","Orsik","Rangrim","Taklinn","Thorek","Ulfgar","Vondal","Balin","Dain","Dwalin","Gloin","Groin","Nain","Ori","Oin","Bifur","Bofur","Bombur","Dori"],last:["Battlehammer","Brawnanvil","Dankil","Fireforge","Frostbeard","Gorunn","Holderhek","Ironfist","Loderr","Lutgehr","Rumnaheim","Strakeln","Torunn","Ungart","Axebreaker","Battlehammer","Brawnanvil","Dankil","Fireforge","Frostbeard","Gorunn","Holderhek","Ironfist","Loderr","Lutgehr","Rumnaheim"]},female:{first:["Amber","Bardryn","Diesa","Eldeth","Gunnloda","Guthkea","Katernin","Liftrasa","Mardred","Riswynn","Sannl","Torbera","Torgga","Vistra","Kathra","Kristryd","Ilde","Liftrasa","Mardred","Riswynn","Sannl","Torbera","Torgga","Vistra","Welby","Darrak","Eberk"],last:["Battlehammer","Brawnanvil","Dankil","Fireforge","Frostbeard","Gorunn","Holderhek","Ironfist","Loderr","Lutgehr","Rumnaheim","Strakeln","Torunn","Ungart","Axebreaker","Battlehammer","Brawnanvil","Dankil","Fireforge","Frostbeard","Gorunn","Holderhek","Ironfist","Loderr","Lutgehr","Rumnaheim"]}},orc:{male:{first:["Grokk","Thokk","Uruk","Grash","Mokk","Drakk","Snagg","Gruul","Krusk","Thrag","Vrokk","Ghash","Brokk","Skarr","Gorthak","Mordak","Ughak","Grommash","Thrall","Garrosh","Durotan","Orgrim","Blackhand","Kilrogg","Kargath","Dentarg","Hurkan"],last:["Skullsplitter","Bloodfang","Ironjaw","Bonecrusher","Flameaxe","Stormrage","Shadowmoon","Frostwolf","Blackrock","Bleeding Hollow","Burning Blade","Dragonmaw","Laughing Skull","Shattered Hand","Twilight's Hammer","Warsong","Thunderlord","Red Walker","Whiteclaw","Redstone","Broken Bone","Burning Eye","Dark Spear","Death's Head","Frozen Rock","Lightning's Blade","Poisoned Spear"]},female:{first:["Baggi","Emen","Engong","Kansif","Myev","Neega","Ovak","Ownka","Shautha","Sutha","Vola","Volen","Yevelda","Grenda","Mokka","Urzul","Shra","Grakia","Vrokka","Thokka","Greshka","Mordka","Ughka","Snaggka","Kruska","Thraka","Vroska"],last:["Skullsplitter","Bloodfang","Ironjaw","Bonecrusher","Flameaxe","Stormrage","Shadowmoon","Frostwolf","Blackrock","Bleeding Hollow","Burning Blade","Dragonmaw","Laughing Skull","Shattered Hand","Twilight's Hammer","Warsong","Thunderlord","Red Walker","Whiteclaw","Redstone","Broken Bone","Burning Eye","Dark Spear","Death's Head","Frozen Rock","Lightning's Blade","Poisoned Spear"]}},places:{cities:["Ravenspire","Goldenhaven","Ironhold","Crystallake","Thornwall","Silverbrook","Dragonrest","Shadowmere","Brightwater","Stormhaven","Millbrook","Oakenford","Rosewood","Blackwater","Whitestone","Redmoor","Greenvale","Bluehaven","Yellowhill","Purplemist"],towns:["Millhaven","Brookshire","Oakheart","Pinewood","Willowdale","Maplegrove","Birchwood","Elmhurst","Cedarfall","Ashwood","Hickory Hill","Walnut Creek","Cherry Blossom","Apple Orchard","Pear Valley","Plum Grove","Peach Hollow","Berry Fields","Vine Ridge","Flower Meadow"],taverns:["The Prancing Pony","The Drunken Dragon","The Golden Griffin","The Silver Stag","The Red Rose","The Blue Moon","The Green Goblin","The Purple Parrot","The Black Swan","The White Wolf","The Rusty Anchor","The Broken Wheel","The Laughing Dwarf","The Singing Bard","The Dancing Bear","The Sleeping Giant","The Weeping Willow","The Howling Wolf","The Roaring Lion","The Soaring Eagle"]}},be=["Ae","Al","Am","An","Ar","Ba","Bel","Ber","Bra","Cal","Cel","Cor","Da","Del","Dra","El","Er","Fae","Gal","Gil","Hal","Ith","Kor","Lae","Lor","Mel","Mor","Nal","Nor","Quin","Ral","Sil","Tal","Thal","Val","Vel","Xan","Yor","Zel"],xe=["an","ar","as","en","er","eth","ia","iel","in","ion","is","ith","las","len","lin","lon","los","neth","oth","ran","ren","rin","ron","ros","san","sen","sin","son","sus","tan","ten","tin","ton","tus","van","ven","vin","von","vus"],we=["ael","aer","ah","al","an","ar","ath","el","en","er","eth","ia","ial","ian","iel","ien","ier","ies","in","ion","is","ith","las","len","lin","lon","los","neth","oth","ran","ren","rin","ron","ros","us","yn","yr","ys"];function Se(e){let{onBack:t}=e;const[n,r]=(0,l.useState)("human"),[a,i]=(0,l.useState)("male"),[o,s]=(0,l.useState)("character"),[c,d]=(0,l.useState)([]),[u,h]=(0,l.useState)([]),g=e=>e[Math.floor(Math.random()*e.length)],f=()=>{const e=ve[n];if(e&&"object"===typeof e&&"male"in e){const t=e[a];if(t&&"object"===typeof t&&"first"in t){const e=g(t.first),n=g(t.last);return"".concat(e," ").concat(n)}}return"Unknown Name"},m=()=>{const e=ve.places[n];return g(e)},y=()=>{const e=Math.random()<.3?2:3;let t="";t+=g(be);for(let n=1;n<e-1;n++)t+=g(xe);return e>1&&(t+=g(we)),t},v=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;const t=[];for(let n=0;n<e;n++){let e;e="character"===o?f():"place"===o?m():y(),t.includes(e)?n--:t.push(e)}d(t)};return l.useEffect(()=>{try{const e=JSON.parse(localStorage.getItem("world-engine-saved-names")||"[]");h(e)}catch(e){console.error("Error loading saved names:",e)}},[]),(0,p.jsxs)("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #0f172a 0%, #1e293b 100%)",color:"#e2e8f0"},children:[(0,p.jsxs)("div",{style:{padding:"1.5rem 2rem",borderBottom:"1px solid #334155",background:"rgba(15, 23, 42, 0.8)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("h1",{style:{margin:0,fontSize:"2.5rem",fontWeight:"bold"},children:"Name Generator"}),(0,p.jsx)("p",{style:{margin:"0.5rem 0 0",opacity:.8},children:"Generate fantasy names for characters and places"})]}),t&&(0,p.jsx)("button",{onClick:t,style:{padding:"0.75rem 1.5rem",background:"#374151",color:"#f9fafb",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"1rem"},children:"Back to Menu"})]}),(0,p.jsxs)("div",{style:{display:"flex",height:"calc(100vh - 120px)"},children:[(0,p.jsxs)("div",{style:{flex:1,padding:"2rem",borderRight:"1px solid #334155",overflowY:"auto"},children:[(0,p.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,p.jsx)("h3",{style:{marginBottom:"1rem",color:"#f1f5f9"},children:"Name Type"}),(0,p.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:["character","place","fantasy"].map(e=>(0,p.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[(0,p.jsx)("input",{type:"radio",name:"nameType",value:e,checked:o===e,onChange:e=>s(e.target.value),style:{accentColor:"#3b82f6"}}),(0,p.jsxs)("span",{style:{textTransform:"capitalize"},children:[e," Names"]})]},e))})]}),"character"===o&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,p.jsx)("h3",{style:{marginBottom:"1rem",color:"#f1f5f9"},children:"Race"}),(0,p.jsxs)("select",{value:n,onChange:e=>r(e.target.value),style:{width:"100%",padding:"0.75rem",background:"#1e293b",border:"1px solid #334155",borderRadius:"4px",color:"#e2e8f0",fontSize:"1rem"},children:[(0,p.jsx)("option",{value:"human",children:"Human"}),(0,p.jsx)("option",{value:"elf",children:"Elf"}),(0,p.jsx)("option",{value:"dwarf",children:"Dwarf"}),(0,p.jsx)("option",{value:"orc",children:"Orc"})]})]}),(0,p.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,p.jsx)("h3",{style:{marginBottom:"1rem",color:"#f1f5f9"},children:"Gender"}),(0,p.jsxs)("div",{style:{display:"flex",gap:"1rem"},children:[(0,p.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[(0,p.jsx)("input",{type:"radio",name:"gender",value:"male",checked:"male"===a,onChange:e=>i(e.target.value),style:{accentColor:"#3b82f6"}}),"Male"]}),(0,p.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[(0,p.jsx)("input",{type:"radio",name:"gender",value:"female",checked:"female"===a,onChange:e=>i(e.target.value),style:{accentColor:"#3b82f6"}}),"Female"]})]})]})]}),"place"===o&&(0,p.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,p.jsx)("h3",{style:{marginBottom:"1rem",color:"#f1f5f9"},children:"Place Type"}),(0,p.jsxs)("select",{value:n,onChange:e=>r(e.target.value),style:{width:"100%",padding:"0.75rem",background:"#1e293b",border:"1px solid #334155",borderRadius:"4px",color:"#e2e8f0",fontSize:"1rem"},children:[(0,p.jsx)("option",{value:"cities",children:"Cities"}),(0,p.jsx)("option",{value:"towns",children:"Towns"}),(0,p.jsx)("option",{value:"taverns",children:"Taverns"})]})]}),(0,p.jsx)("button",{onClick:()=>v(10),style:{width:"100%",padding:"1rem",background:"#3b82f6",color:"white",border:"none",borderRadius:"6px",fontSize:"1.1rem",fontWeight:"bold",cursor:"pointer",marginBottom:"1rem"},children:"Generate Names"}),(0,p.jsx)("button",{onClick:()=>v(25),style:{width:"100%",padding:"0.75rem",background:"#059669",color:"white",border:"none",borderRadius:"6px",fontSize:"1rem",cursor:"pointer"},children:"Generate More (25)"})]}),(0,p.jsxs)("div",{style:{flex:2,padding:"2rem",borderRight:"1px solid #334155"},children:[(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[(0,p.jsx)("h3",{style:{margin:0,color:"#f1f5f9"},children:"Generated Names"}),c.length>0&&(0,p.jsxs)("span",{style:{color:"#94a3b8",fontSize:"0.9rem"},children:[c.length," names"]})]}),0===c.length?(0,p.jsx)("div",{style:{textAlign:"center",padding:"3rem",color:"#64748b",fontStyle:"italic"},children:'Click "Generate Names" to get started!'}):(0,p.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"1rem",maxHeight:"calc(100vh - 250px)",overflowY:"auto"},children:c.map((e,t)=>(0,p.jsxs)("div",{style:{padding:"1rem",background:"rgba(15, 23, 42, 0.5)",border:"1px solid #334155",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,p.jsx)("span",{style:{fontWeight:"500"},children:e}),(0,p.jsx)("button",{onClick:()=>(e=>{if(!u.includes(e)){const t=[...u,e];h(t),localStorage.setItem("world-engine-saved-names",JSON.stringify(t))}})(e),disabled:u.includes(e),style:{padding:"0.25rem 0.5rem",background:u.includes(e)?"#374151":"#059669",color:"white",border:"none",borderRadius:"4px",fontSize:"0.8rem",cursor:u.includes(e)?"not-allowed":"pointer"},children:u.includes(e)?"Saved":"Save"})]},t))})]}),(0,p.jsxs)("div",{style:{flex:1,padding:"2rem"},children:[(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[(0,p.jsx)("h3",{style:{margin:0,color:"#f1f5f9"},children:"Saved Names"}),u.length>0&&(0,p.jsx)("button",{onClick:()=>{const e=JSON.stringify(u,null,2),t=new Blob([e],{type:"application/json"}),n=URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download="world-engine-names-".concat((new Date).toISOString().split("T")[0],".json"),r.click(),URL.revokeObjectURL(n)},style:{padding:"0.5rem",background:"#374151",color:"white",border:"none",borderRadius:"4px",fontSize:"0.8rem",cursor:"pointer"},children:"Export"})]}),0===u.length?(0,p.jsx)("div",{style:{textAlign:"center",padding:"2rem",color:"#64748b",fontStyle:"italic"},children:"Save names you like here!"}):(0,p.jsx)("div",{style:{maxHeight:"calc(100vh - 250px)",overflowY:"auto"},children:u.map((e,t)=>(0,p.jsxs)("div",{style:{padding:"0.75rem",background:"rgba(15, 23, 42, 0.3)",border:"1px solid #334155",borderRadius:"6px",marginBottom:"0.5rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,p.jsx)("span",{children:e}),(0,p.jsx)("button",{onClick:()=>(e=>{const t=u.filter(t=>t!==e);h(t),localStorage.setItem("world-engine-saved-names",JSON.stringify(t))})(e),style:{padding:"0.25rem 0.5rem",background:"#ef4444",color:"white",border:"none",borderRadius:"4px",fontSize:"0.7rem",cursor:"pointer"},children:"\xd7"})]},t))})]})]})]})}const ke={abjuration:[{name:"Ward",level:0,school:"Abjuration",castingTime:"1 action",range:"Touch",components:["V (protective word)","S (warding gesture)"],duration:"1 round",description:"Creates a shimmering barrier that provides +1 AC against the next attack.",color:"#3b82f6"},{name:"Resist",level:0,school:"Abjuration",castingTime:"1 reaction",range:"Self",components:["V (quick incantation)"],duration:"Instantaneous",description:"Reduces incoming damage by 1d4 points when cast as a reaction.",color:"#3b82f6"},{name:"Shield of Faith",level:1,school:"Abjuration",castingTime:"1 action",range:"60 feet",components:["V (prayer)","S (blessing gesture)","M (holy symbol)"],duration:"5 rounds",description:"Surrounds target with divine energy, granting +2 AC and resistance to the next spell.",color:"#3b82f6"},{name:"Dispel Minor Magic",level:1,school:"Abjuration",castingTime:"1 action",range:"60 feet",components:["V (dispelling word)","S (dismissive gesture)"],duration:"Instantaneous",description:"Ends one cantrip or 1st level spell effect on target creature or object.",color:"#3b82f6"},{name:"Arcane Lock",level:2,school:"Abjuration",castingTime:"2 actions",range:"Touch",components:["V (locking incantation)","S (sealing motions)","M (silver key worth 25 gp)"],duration:"Until dispelled",description:"Magically locks a door, chest, or portal. Only the caster or dispel magic can open it.",color:"#3b82f6"},{name:"Greater Ward",level:3,school:"Abjuration",castingTime:"1 action",range:"30 feet",components:["V (protective chant)","S (complex warding)","M (crystal focus)"],duration:"10 rounds",description:"Creates a 15-foot radius protective dome. Allies inside gain damage resistance and spell immunity.",color:"#3b82f6"}],conjuration:[{name:"Summon Spark",level:0,school:"Conjuration",castingTime:"1 action",range:"60 feet",components:["V (summoning word)","S (beckoning gesture)"],duration:"1 round",description:"Creates a tiny mote of light that can illuminate or distract. Deals 1d4 radiant damage.",color:"#10b981"},{name:"Conjure Weapon",level:1,school:"Conjuration",castingTime:"1 action",range:"Self",components:["V (weapon's name)","S (grasping motion)"],duration:"5 rounds",description:"Creates a simple melee weapon in your hand. Weapon deals 1d6 + spell modifier damage.",color:"#10b981"},{name:"Faithful Hound",level:1,school:"Conjuration",castingTime:"2 actions",range:"30 feet",components:["V (calling howl)","S (summoning ritual)","M (dog whistle)"],duration:"10 rounds",description:"Summons a spectral hound with 15 HP that follows your commands and alerts to enemies.",color:"#10b981"},{name:"Dimensional Door",level:2,school:"Conjuration",castingTime:"1 action",range:"500 feet",components:["V (travel word)","S (stepping motion)"],duration:"Instantaneous",description:"Instantly teleports you and one willing ally to a location you can see within range.",color:"#10b981"}],divination:[{name:"Detect",level:0,school:"Divination",castingTime:"1 action",range:"30 feet",components:["V (inquiry)","S (searching gesture)"],duration:"3 rounds",description:"Reveals the presence of magic, hidden objects, or creatures within range.",color:"#f59e0b"},{name:"True Sight",level:1,school:"Divination",castingTime:"1 action",range:"Self",components:["V (seeing word)","S (eye-opening gesture)","M (crystal lens)"],duration:"10 rounds",description:"See through illusions, detect invisible creatures, and perceive the true form of shapeshifters.",color:"#f59e0b"},{name:"Locate Object",level:1,school:"Divination",castingTime:"2 actions",range:"1 mile",components:["V (object's name)","S (searching motions)","M (lodestone)"],duration:"10 rounds",description:"Sense the direction and distance to a specific object you've seen before.",color:"#f59e0b"}],enchantment:[{name:"Charm",level:0,school:"Enchantment",castingTime:"1 action",range:"30 feet",components:["V (persuasive words)","S (friendly gesture)"],duration:"3 rounds",description:"Target views you as a friendly acquaintance. They won't attack you but aren't controlled.",color:"#ec4899"},{name:"Command",level:1,school:"Enchantment",castingTime:"1 action",range:"60 feet",components:["V (single word command)"],duration:"1 round",description:"Target must obey a one-word command: Approach, Drop, Flee, Grovel, or Halt.",color:"#ec4899"},{name:"Sleep",level:1,school:"Enchantment",castingTime:"1 action",range:"90 feet",components:["V (lullaby)","S (soothing gesture)","M (sand or rose petals)"],duration:"5 rounds",description:"Creatures in 20-foot radius fall unconscious. Affects 5d8 hit points worth of creatures.",color:"#ec4899"}],evocation:[{name:"Magic Missile",level:0,school:"Evocation",castingTime:"1 action",range:"120 feet",components:["V (targeting word)","S (pointing gesture)"],duration:"Instantaneous",description:"Creates 1 dart of pure force that automatically hits for 1d4+1 damage.",color:"#ef4444"},{name:"Spark",level:0,school:"Evocation",castingTime:"1 action",range:"60 feet",components:["V (crackling word)","S (snapping fingers)"],duration:"Instantaneous",description:"Target takes 1d6 lightning damage and must make a Constitution save or be stunned for 1 round.",color:"#ef4444"},{name:"Burning Hands",level:1,school:"Evocation",castingTime:"1 action",range:"15-foot cone",components:["V (fiery incantation)","S (spreading fingers)"],duration:"Instantaneous",description:"Flames shoot from your fingertips. Each creature in area takes 3d6 fire damage.",color:"#ef4444"},{name:"Lightning Bolt",level:1,school:"Evocation",castingTime:"1 action",range:"100 feet",components:["V (thunder word)","S (throwing motion)","M (copper wire)"],duration:"Instantaneous",description:"A bolt of lightning shoots in a line. Creatures in path take 2d8 lightning damage.",color:"#ef4444"}],healing:[{name:"Mend Wounds",level:0,school:"Healing",castingTime:"1 action",range:"Touch",components:["V (healing word)","S (gentle touch)"],duration:"Instantaneous",description:"Restores 1d4 hit points to a living creature. Cannot heal the same target twice per combat.",color:"#22c55e"},{name:"Stabilize",level:0,school:"Healing",castingTime:"1 action",range:"Touch",components:["V (life-binding word)","S (steadying touch)"],duration:"Instantaneous",description:"A dying creature becomes stable and regains 1 hit point.",color:"#22c55e"},{name:"Cure Light Wounds",level:1,school:"Healing",castingTime:"1 action",range:"Touch",components:["V (healing prayer)","S (laying on hands)"],duration:"Instantaneous",description:"Restores 1d8 + spellcasting modifier hit points to target creature.",color:"#22c55e"},{name:"Healing Word",level:1,school:"Healing",castingTime:"1 bonus action",range:"60 feet",components:["V (word of healing)"],duration:"Instantaneous",description:"Restores 1d4 + spellcasting modifier hit points. Can revive unconscious allies.",color:"#22c55e"},{name:"Prayer of Healing",level:2,school:"Healing",castingTime:"3 actions",range:"30-foot radius",components:["V (group prayer)","S (blessing gestures)","M (holy symbol)"],duration:"Instantaneous",description:"Up to 6 creatures regain 2d8 + spellcasting modifier hit points each.",color:"#22c55e"},{name:"Greater Heal",level:3,school:"Healing",castingTime:"1 action",range:"Touch",components:["V (major healing incantation)","S (powerful laying on hands)","M (diamond dust worth 100 gp)"],duration:"Instantaneous",description:"Restores 4d8 + spellcasting modifier hit points and removes one disease or poison.",color:"#22c55e"}],illusion:[{name:"Minor Illusion",level:0,school:"Illusion",castingTime:"1 action",range:"30 feet",components:["S (image-forming gesture)","M (bit of fleece)"],duration:"5 rounds",description:"Creates a sound or image no larger than a 5-foot cube. Can distract or deceive.",color:"#8b5cf6"},{name:"Disguise Self",level:1,school:"Illusion",castingTime:"1 action",range:"Self",components:["V (transformation word)","S (self-shaping gestures)"],duration:"10 rounds",description:"Change your appearance including clothing, armor, weapons, and other equipment.",color:"#8b5cf6"},{name:"Invisibility",level:1,school:"Illusion",castingTime:"1 action",range:"Touch",components:["V (vanishing word)","S (fading gesture)","M (eyelash in gum arabic)"],duration:"10 rounds",description:"Target becomes invisible until they attack, cast a spell, or duration ends.",color:"#8b5cf6"}],necromancy:[{name:"Chill Touch",level:0,school:"Necromancy",castingTime:"1 action",range:"120 feet",components:["V (death whisper)","S (grasping motion)"],duration:"1 round",description:"Spectral hand deals 1d8 necrotic damage and prevents healing until your next turn.",color:"#6b7280"},{name:"Speak with Dead",level:1,school:"Necromancy",castingTime:"3 actions",range:"10 feet",components:["V (death's language)","S (beckoning gesture)","M (burning incense)"],duration:"5 rounds",description:"Ask up to 5 questions of a corpse that died within the last week.",color:"#6b7280"},{name:"Vampiric Touch",level:1,school:"Necromancy",castingTime:"1 action",range:"Touch",components:["V (draining word)","S (life-stealing touch)"],duration:"Instantaneous",description:"Deal 2d6 necrotic damage and regain half as hit points.",color:"#6b7280"}],transmutation:[{name:"Mending",level:0,school:"Transmutation",castingTime:"1 action",range:"Touch",components:["V (repair word)","S (mending gesture)","M (two lodestones)"],duration:"Instantaneous",description:"Repairs a single break or tear in an object no larger than 1 foot.",color:"#06b6d4"},{name:"Alter Self",level:1,school:"Transmutation",castingTime:"1 action",range:"Self",components:["V (change word)","S (self-altering gestures)"],duration:"10 rounds",description:"Change your physical form: grow claws (+1d4 damage), gills (breathe water), or camouflage (+5 stealth).",color:"#06b6d4"},{name:"Enhance Ability",level:1,school:"Transmutation",castingTime:"1 action",range:"Touch",components:["V (empowering word)","S (enhancing touch)","M (hair or fur from a beast)"],duration:"10 rounds",description:"Target gains advantage on one type of ability check and +2 to that ability score.",color:"#06b6d4"}]},Ce=()=>Object.values(ke).flat(),je=e=>ke[e.toLowerCase()]||[],Te=[{name:"Abjuration",description:"Protective magic",color:"#3b82f6"},{name:"Conjuration",description:"Summoning and creation",color:"#10b981"},{name:"Divination",description:"Information gathering",color:"#f59e0b"},{name:"Enchantment",description:"Mind control and charm",color:"#ec4899"},{name:"Evocation",description:"Destructive energy",color:"#ef4444"},{name:"Healing",description:"Restoration and recovery",color:"#22c55e"},{name:"Illusion",description:"Deception and trickery",color:"#8b5cf6"},{name:"Necromancy",description:"Death and undeath",color:"#6b7280"},{name:"Transmutation",description:"Transformation",color:"#06b6d4"}],Ee=["1 action","1 bonus action","1 reaction","2 actions","3 actions","1 full round","2 rounds","3 rounds","1 minute","10 minutes","1 hour"],ze=["Self","Touch","10 feet","30 feet","60 feet","120 feet","300 feet","500 feet","1 mile","Sight","Special"],Me=["Instantaneous","1 round","2 rounds","3 rounds","5 rounds","10 rounds","1 minute (10 rounds)","10 minutes","1 hour","8 hours","24 hours","Until dispelled","Permanent","Concentration, up to 1 round","Concentration, up to 3 rounds","Concentration, up to 10 rounds","Concentration, up to 10 minutes","Concentration, up to 1 hour"],Ie={verbal:["Simple word","Quick chant","Whispered phrase","Ancient incantation","Mystical chant","Power word","Arcane phrase","Sacred prayer","Elemental call","Divine invocation"],somatic:["Quick gesture","Simple motion","Finger snap","Hand wave","Precise gestures","Complex hand movements","Ritualistic dance","Finger patterns","Sweeping motions","Sacred signs"],material:["Small focus","Tiny crystal","Bit of string","Drop of water","Crystal focus","Rare herbs","Precious metals","Ancient runes","Elemental essence","Sacred symbols","Diamond dust","Silver wire"]},_e={0:{damage:"1d4 to 1d6",healing:"1d4",effects:"Minor utility, small bonuses (+1), brief duration",limitations:"Single target, short range, minimal impact"},1:{damage:"1d8 to 3d6",healing:"1d8 + modifier",effects:"Basic combat/utility, small area effects, moderate bonuses (+2)",limitations:"Limited targets, moderate range and duration"},2:{damage:"2d8 to 5d6",healing:"2d8 + modifier",effects:"Enhanced effects, larger areas, significant bonuses (+3-4)",limitations:"Multiple targets, good range and duration"},3:{damage:"3d8 to 8d6",healing:"3d8 + modifier",effects:"Powerful effects, condition removal, major bonuses (+4-5)",limitations:"Large areas, long duration, powerful utility"}};function Pe(e){let{onBack:t,onSpellCreated:n}=e;const[r,a]=(0,l.useState)({name:"",level:0,school:"Evocation",castingTime:"1 action",range:"60 feet",duration:"Instantaneous",description:"",components:{verbal:!1,somatic:!1,material:!1,verbalDetail:"Ancient incantation",somaticDetail:"Precise gestures",materialDetail:"Crystal focus"}}),[i,o]=(0,l.useState)([]),[c,d]=(0,l.useState)(null),u=()=>{const e=(()=>{const e=[];return r.name.trim()||e.push("Spell name is required"),r.name.length>50&&e.push("Spell name too long (max 50 characters)"),r.description.trim()||e.push("Spell description is required"),r.description.length<20&&e.push("Spell description too short (minimum 20 characters)"),r.description.length>500&&e.push("Spell description too long (max 500 characters)"),r.components.verbal||r.components.somatic||r.components.material||e.push("Spell must have at least one component (Verbal, Somatic, or Material)"),0===r.level&&((r.duration.includes("hour")||r.duration.includes("day"))&&e.push("Cantrips cannot have durations longer than 10 minutes"),"1 mile"!==r.range&&"Sight"!==r.range||e.push("Cantrips should have limited range (max 120 feet)")),e})();if(e.length>0)return o(e),null;o([]);const t=[];r.components.verbal&&t.push("V (".concat(r.components.verbalDetail,")")),r.components.somatic&&t.push("S (".concat(r.components.somaticDetail,")")),r.components.material&&t.push("M (".concat(r.components.materialDetail,")"));const n=Te.find(e=>e.name===r.school)||Te[0];return{name:r.name,level:r.level,school:r.school,castingTime:r.castingTime,range:r.range,components:t,duration:r.duration,description:r.description,color:n.color}},h=()=>Te.find(e=>e.name===r.school)||Te[0],g=()=>_e[r.level]||_e[0];return(0,p.jsxs)("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #0f172a 0%, #1e293b 100%)",color:"#e2e8f0",padding:"2rem"},children:[(0,p.jsxs)("div",{style:{padding:"1.5rem 2rem",borderBottom:"1px solid #334155",background:"rgba(15, 23, 42, 0.8)",display:"flex",justifyContent:"space-between",alignItems:"center",borderRadius:"8px",marginBottom:"2rem"},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("h1",{style:{margin:0,fontSize:"2.5rem",fontWeight:"bold"},children:"\u26a1 Custom Spell Creator"}),(0,p.jsx)("p",{style:{margin:"0.5rem 0 0",opacity:.8},children:"Create your own balanced spells with limitations and guidelines"})]}),t&&(0,p.jsx)("button",{onClick:t,style:{padding:"0.75rem 1.5rem",background:"#374151",color:"#f9fafb",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"1rem"},children:"Back"})]}),(0,p.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"2rem"},children:[(0,p.jsxs)("div",{style:{background:"rgba(15, 23, 42, 0.6)",borderRadius:"8px",padding:"1.5rem",border:"1px solid #334155"},children:[(0,p.jsx)("h2",{style:{margin:"0 0 1.5rem",color:"#f1f5f9"},children:"\ud83d\udcdd Spell Details"}),(0,p.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,p.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",color:"#cbd5e1"},children:"Spell Name"}),(0,p.jsx)("input",{type:"text",value:r.name,onChange:e=>a(s(s({},r),{},{name:e.target.value})),placeholder:"Enter spell name...",style:{width:"100%",padding:"0.75rem",background:"#374151",border:"1px solid #4b5563",borderRadius:"6px",color:"#f9fafb",fontSize:"1rem"}})]}),(0,p.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1.5rem"},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",color:"#cbd5e1"},children:"Spell Level"}),(0,p.jsxs)("select",{value:r.level,onChange:e=>a(s(s({},r),{},{level:parseInt(e.target.value)})),style:{width:"100%",padding:"0.75rem",background:"#374151",border:"1px solid #4b5563",borderRadius:"6px",color:"#f9fafb",fontSize:"1rem"},children:[(0,p.jsx)("option",{value:0,children:"Cantrip"}),(0,p.jsx)("option",{value:1,children:"1st Level"}),(0,p.jsx)("option",{value:2,children:"2nd Level"}),(0,p.jsx)("option",{value:3,children:"3rd Level"})]})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",color:"#cbd5e1"},children:"School of Magic"}),(0,p.jsx)("select",{value:r.school,onChange:e=>a(s(s({},r),{},{school:e.target.value})),style:{width:"100%",padding:"0.75rem",background:"#374151",border:"1px solid #4b5563",borderRadius:"6px",color:"#f9fafb",fontSize:"1rem"},children:Te.map(e=>(0,p.jsx)("option",{value:e.name,children:e.name},e.name))})]})]}),(0,p.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"1rem",marginBottom:"1.5rem"},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",color:"#cbd5e1"},children:"Casting Time"}),(0,p.jsx)("select",{value:r.castingTime,onChange:e=>a(s(s({},r),{},{castingTime:e.target.value})),style:{width:"100%",padding:"0.75rem",background:"#374151",border:"1px solid #4b5563",borderRadius:"6px",color:"#f9fafb",fontSize:"0.9rem"},children:Ee.map(e=>(0,p.jsx)("option",{value:e,children:e},e))})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",color:"#cbd5e1"},children:"Range"}),(0,p.jsx)("select",{value:r.range,onChange:e=>a(s(s({},r),{},{range:e.target.value})),style:{width:"100%",padding:"0.75rem",background:"#374151",border:"1px solid #4b5563",borderRadius:"6px",color:"#f9fafb",fontSize:"0.9rem"},children:ze.map(e=>(0,p.jsx)("option",{value:e,children:e},e))})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",color:"#cbd5e1"},children:"Duration"}),(0,p.jsx)("select",{value:r.duration,onChange:e=>a(s(s({},r),{},{duration:e.target.value})),style:{width:"100%",padding:"0.75rem",background:"#374151",border:"1px solid #4b5563",borderRadius:"6px",color:"#f9fafb",fontSize:"0.9rem"},children:Me.map(e=>(0,p.jsx)("option",{value:e,children:e},e))})]})]}),(0,p.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,p.jsx)("label",{style:{display:"block",marginBottom:"0.75rem",color:"#cbd5e1"},children:"Components"}),(0,p.jsxs)("div",{style:{marginBottom:"0.75rem"},children:[(0,p.jsxs)("label",{style:{display:"flex",alignItems:"center",marginBottom:"0.5rem"},children:[(0,p.jsx)("input",{type:"checkbox",checked:r.components.verbal,onChange:e=>a(s(s({},r),{},{components:s(s({},r.components),{},{verbal:e.target.checked})})),style:{marginRight:"0.5rem"}}),(0,p.jsx)("span",{style:{color:"#f9fafb"},children:"Verbal (V)"})]}),r.components.verbal&&(0,p.jsx)("select",{value:r.components.verbalDetail,onChange:e=>a(s(s({},r),{},{components:s(s({},r.components),{},{verbalDetail:e.target.value})})),style:{width:"100%",padding:"0.5rem",background:"#4b5563",border:"1px solid #6b7280",borderRadius:"4px",color:"#f9fafb",fontSize:"0.9rem"},children:Ie.verbal.map(e=>(0,p.jsx)("option",{value:e,children:e},e))})]}),(0,p.jsxs)("div",{style:{marginBottom:"0.75rem"},children:[(0,p.jsxs)("label",{style:{display:"flex",alignItems:"center",marginBottom:"0.5rem"},children:[(0,p.jsx)("input",{type:"checkbox",checked:r.components.somatic,onChange:e=>a(s(s({},r),{},{components:s(s({},r.components),{},{somatic:e.target.checked})})),style:{marginRight:"0.5rem"}}),(0,p.jsx)("span",{style:{color:"#f9fafb"},children:"Somatic (S)"})]}),r.components.somatic&&(0,p.jsx)("select",{value:r.components.somaticDetail,onChange:e=>a(s(s({},r),{},{components:s(s({},r.components),{},{somaticDetail:e.target.value})})),style:{width:"100%",padding:"0.5rem",background:"#4b5563",border:"1px solid #6b7280",borderRadius:"4px",color:"#f9fafb",fontSize:"0.9rem"},children:Ie.somatic.map(e=>(0,p.jsx)("option",{value:e,children:e},e))})]}),(0,p.jsxs)("div",{children:[(0,p.jsxs)("label",{style:{display:"flex",alignItems:"center",marginBottom:"0.5rem"},children:[(0,p.jsx)("input",{type:"checkbox",checked:r.components.material,onChange:e=>a(s(s({},r),{},{components:s(s({},r.components),{},{material:e.target.checked})})),style:{marginRight:"0.5rem"}}),(0,p.jsx)("span",{style:{color:"#f9fafb"},children:"Material (M)"})]}),r.components.material&&(0,p.jsx)("input",{type:"text",value:r.components.materialDetail,onChange:e=>a(s(s({},r),{},{components:s(s({},r.components),{},{materialDetail:e.target.value})})),placeholder:"Describe material component...",style:{width:"100%",padding:"0.5rem",background:"#4b5563",border:"1px solid #6b7280",borderRadius:"4px",color:"#f9fafb",fontSize:"0.9rem"}})]})]}),(0,p.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,p.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",color:"#cbd5e1"},children:"Spell Description"}),(0,p.jsx)("textarea",{value:r.description,onChange:e=>a(s(s({},r),{},{description:e.target.value})),placeholder:"Describe what the spell does, its effects, damage, bonuses, etc...",rows:4,style:{width:"100%",padding:"0.75rem",background:"#374151",border:"1px solid #4b5563",borderRadius:"6px",color:"#f9fafb",fontSize:"1rem",resize:"vertical"}}),(0,p.jsxs)("div",{style:{fontSize:"0.8rem",color:"#94a3b8",marginTop:"0.25rem"},children:[r.description.length,"/500 characters"]})]}),(0,p.jsxs)("div",{style:{display:"flex",gap:"1rem"},children:[(0,p.jsx)("button",{onClick:()=>{const e=u();d(e)},style:{flex:1,padding:"0.75rem",background:h().color,color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"1rem",fontWeight:"bold"},children:"\ud83d\udc41\ufe0f Preview Spell"}),(0,p.jsx)("button",{onClick:()=>{const e=u();e&&n&&n(e)},disabled:!c,style:{flex:1,padding:"0.75rem",background:c?"#059669":"#374151",color:"white",border:"none",borderRadius:"6px",cursor:c?"pointer":"not-allowed",fontSize:"1rem",fontWeight:"bold"},children:"\ud83d\udcbe Save Spell"})]}),i.length>0&&(0,p.jsxs)("div",{style:{marginTop:"1rem",padding:"1rem",background:"rgba(220, 38, 38, 0.2)",border:"1px solid #dc2626",borderRadius:"6px"},children:[(0,p.jsx)("h4",{style:{margin:"0 0 0.5rem",color:"#fca5a5"},children:"Validation Errors:"}),(0,p.jsx)("ul",{style:{margin:0,paddingLeft:"1.5rem",color:"#fca5a5"},children:i.map((e,t)=>(0,p.jsx)("li",{children:e},t))})]})]}),(0,p.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[(0,p.jsxs)("div",{style:{background:"rgba(15, 23, 42, 0.6)",borderRadius:"8px",padding:"1.5rem",border:"2px solid ".concat(h().color)},children:[(0,p.jsxs)("h2",{style:{margin:"0 0 1rem",color:h().color},children:["\ud83d\udccb ",h().name," Guidelines"]}),(0,p.jsx)("p",{style:{margin:"0 0 1rem",color:"#cbd5e1",fontStyle:"italic"},children:h().description}),(0,p.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,p.jsxs)("h4",{style:{margin:"0 0 0.5rem",color:"#f1f5f9"},children:["Level ",r.level," ",0===r.level?"Cantrip":""," Limits:"]}),(0,p.jsxs)("div",{style:{fontSize:"0.9rem",color:"#94a3b8"},children:[(0,p.jsxs)("p",{style:{margin:"0.25rem 0"},children:[(0,p.jsx)("strong",{children:"Damage:"})," ",g().damage]}),(0,p.jsxs)("p",{style:{margin:"0.25rem 0"},children:[(0,p.jsx)("strong",{children:"Healing:"})," ",g().healing]}),(0,p.jsxs)("p",{style:{margin:"0.25rem 0"},children:[(0,p.jsx)("strong",{children:"Effects:"})," ",g().effects]}),(0,p.jsxs)("p",{style:{margin:"0.25rem 0"},children:[(0,p.jsx)("strong",{children:"Limitations:"})," ",g().limitations]})]})]}),(0,p.jsxs)("div",{style:{padding:"1rem",background:"rgba(59, 130, 246, 0.1)",borderRadius:"6px",border:"1px solid #3b82f6"},children:[(0,p.jsx)("h4",{style:{margin:"0 0 0.5rem",color:"#93c5fd"},children:"\ud83d\udca1 Design Tips:"}),(0,p.jsxs)("ul",{style:{margin:0,paddingLeft:"1.5rem",color:"#cbd5e1",fontSize:"0.9rem"},children:[(0,p.jsx)("li",{children:"Be specific about targets, ranges, and effects"}),(0,p.jsx)("li",{children:"Higher level spells should have more complex components"}),(0,p.jsx)("li",{children:"Balance damage with utility - not every spell needs to do damage"}),(0,p.jsx)("li",{children:"Consider what class would use this spell"}),(0,p.jsx)("li",{children:"Make effects interesting but not overpowered"})]})]})]}),c&&(0,p.jsxs)("div",{style:{background:"rgba(15, 23, 42, 0.6)",borderRadius:"8px",padding:"1.5rem",border:"2px solid ".concat(c.color)},children:[(0,p.jsx)("h2",{style:{margin:"0 0 1rem",color:"#f1f5f9"},children:"\ud83d\udc41\ufe0f Spell Preview"}),(0,p.jsxs)("div",{style:{background:"rgba(15, 23, 42, 0.8)",borderRadius:"6px",padding:"1.5rem",border:"1px solid ".concat(c.color)},children:[(0,p.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,p.jsx)("h3",{style:{margin:"0 0 0.25rem",color:c.color,fontSize:"1.5rem"},children:c.name}),(0,p.jsxs)("p",{style:{margin:0,color:"#94a3b8",fontSize:"0.9rem"},children:[0===c.level?"Cantrip":"".concat(c.level,"st Level")," ",c.school]})]}),(0,p.jsxs)("div",{style:{marginBottom:"1rem",fontSize:"0.9rem",color:"#cbd5e1"},children:[(0,p.jsxs)("p",{style:{margin:"0.25rem 0"},children:[(0,p.jsx)("strong",{children:"Casting Time:"})," ",c.castingTime]}),(0,p.jsxs)("p",{style:{margin:"0.25rem 0"},children:[(0,p.jsx)("strong",{children:"Range:"})," ",c.range]}),(0,p.jsxs)("p",{style:{margin:"0.25rem 0"},children:[(0,p.jsx)("strong",{children:"Components:"})," ",c.components.join(", ")]}),(0,p.jsxs)("p",{style:{margin:"0.25rem 0"},children:[(0,p.jsx)("strong",{children:"Duration:"})," ",c.duration]})]}),(0,p.jsx)("div",{children:(0,p.jsx)("p",{style:{margin:0,color:"#e2e8f0",lineHeight:"1.5"},children:c.description})})]})]})]})]})]})}const Le={schools:[{name:"Abjuration",description:"Protective magic",color:"#3b82f6"},{name:"Conjuration",description:"Summoning and creation",color:"#10b981"},{name:"Divination",description:"Information gathering",color:"#f59e0b"},{name:"Enchantment",description:"Mind control and charm",color:"#ec4899"},{name:"Evocation",description:"Destructive energy",color:"#ef4444"},{name:"Healing",description:"Restoration and recovery",color:"#22c55e"},{name:"Illusion",description:"Deception and trickery",color:"#8b5cf6"},{name:"Necromancy",description:"Death and undeath",color:"#6b7280"},{name:"Transmutation",description:"Transformation",color:"#06b6d4"}]};function Re(e){var t;let{onBack:n}=e;const[r,a]=(0,l.useState)("menu"),[i,o]=(0,l.useState)("any"),[s,c]=(0,l.useState)([]),[d,u]=(0,l.useState)([]);l.useEffect(()=>{try{const e=JSON.parse(localStorage.getItem("world-engine-saved-spells")||"[]");u(e)}catch(e){console.error("Error loading saved spells:",e),u([])}},[]);const h=e=>{c(t=>[e,...t]),console.log("\u2728 Created custom spell: ".concat(e.name)),a("menu")},g=e=>{let t=[];e&&"any"!==e?(t=je(e),console.log("\ud83d\udcda Loaded ".concat(t.length," premade ").concat(e," spells"))):(t=Ce(),console.log("\ud83d\udcda Loaded ".concat(t.length," premade spells from all schools"))),c(t)};return"custom"===r?(0,p.jsx)(Pe,{onBack:()=>a("menu"),onSpellCreated:h}):(0,p.jsxs)("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #0f172a 0%, #1e293b 100%)",color:"#e2e8f0"},children:[(0,p.jsxs)("div",{style:{padding:"1.5rem 2rem",borderBottom:"1px solid #334155",background:"rgba(15, 23, 42, 0.8)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("h1",{style:{margin:0,fontSize:"2.5rem",fontWeight:"bold"},children:"\u26a1 Spell Workshop"}),(0,p.jsx)("p",{style:{margin:"0.5rem 0 0",opacity:.8},children:"menu"===r?"Choose your spell creation method":"premade"===r?"Browse curated spell collections":"Generate random magical spells"})]}),(0,p.jsxs)("div",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:["menu"!==r&&(0,p.jsx)("button",{onClick:()=>a("menu"),style:{padding:"0.75rem 1.5rem",background:"#6366f1",color:"#f9fafb",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"1rem"},children:"\ud83c\udfe0 Main Menu"}),n&&(0,p.jsx)("button",{onClick:n,style:{padding:"0.75rem 1.5rem",background:"#374151",color:"#f9fafb",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"1rem"},children:"Back to Game"})]})]}),"menu"===r&&(0,p.jsxs)("div",{style:{padding:"3rem 2rem"},children:[(0,p.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(350px, 1fr))",gap:"2rem",maxWidth:"1200px",margin:"0 auto"},children:[(0,p.jsxs)("div",{style:{background:"rgba(15, 23, 42, 0.6)",borderRadius:"12px",padding:"2rem",border:"2px solid #10b981",cursor:"pointer",transition:"all 0.3s ease"},onMouseEnter:e=>e.currentTarget.style.transform="translateY(-4px)",onMouseLeave:e=>e.currentTarget.style.transform="translateY(0px)",onClick:()=>a("premade"),children:[(0,p.jsx)("div",{style:{fontSize:"3rem",textAlign:"center",marginBottom:"1rem"},children:"\ud83d\udcda"}),(0,p.jsx)("h2",{style:{margin:"0 0 1rem",color:"#10b981",textAlign:"center",fontSize:"1.5rem"},children:"Premade Spell Collections"}),(0,p.jsx)("p",{style:{margin:"0 0 1.5rem",color:"#cbd5e1",textAlign:"center",lineHeight:"1.6"},children:"Browse carefully crafted spells for each school of magic. Perfect for quick gameplay and learning spell mechanics."}),(0,p.jsxs)("div",{style:{background:"rgba(16, 185, 129, 0.1)",borderRadius:"6px",padding:"1rem",border:"1px solid #10b981"},children:[(0,p.jsx)("h4",{style:{margin:"0 0 0.5rem",color:"#6ee7b7"},children:"\u2728 Features:"}),(0,p.jsxs)("ul",{style:{margin:0,paddingLeft:"1.5rem",color:"#d1fae5"},children:[(0,p.jsx)("li",{children:"Balanced and tested spells"}),(0,p.jsx)("li",{children:"Organized by school and level"}),(0,p.jsx)("li",{children:"Rich flavor text and descriptions"}),(0,p.jsx)("li",{children:"Ready to use immediately"})]})]})]}),(0,p.jsxs)("div",{style:{background:"rgba(15, 23, 42, 0.6)",borderRadius:"12px",padding:"2rem",border:"2px solid #ef4444",cursor:"pointer",transition:"all 0.3s ease"},onMouseEnter:e=>e.currentTarget.style.transform="translateY(-4px)",onMouseLeave:e=>e.currentTarget.style.transform="translateY(0px)",onClick:()=>a("custom"),children:[(0,p.jsx)("div",{style:{fontSize:"3rem",textAlign:"center",marginBottom:"1rem"},children:"\u2692\ufe0f"}),(0,p.jsx)("h2",{style:{margin:"0 0 1rem",color:"#ef4444",textAlign:"center",fontSize:"1.5rem"},children:"Custom Spell Creator"}),(0,p.jsx)("p",{style:{margin:"0 0 1.5rem",color:"#cbd5e1",textAlign:"center",lineHeight:"1.6"},children:"Design your own spells from scratch with built-in balance guidelines. Perfect for experienced players who want full creative control."}),(0,p.jsxs)("div",{style:{background:"rgba(239, 68, 68, 0.1)",borderRadius:"6px",padding:"1rem",border:"1px solid #ef4444"},children:[(0,p.jsx)("h4",{style:{margin:"0 0 0.5rem",color:"#fca5a5"},children:"\ud83d\udee0\ufe0f Features:"}),(0,p.jsxs)("ul",{style:{margin:0,paddingLeft:"1.5rem",color:"#fee2e2"},children:[(0,p.jsx)("li",{children:"Complete creative freedom"}),(0,p.jsx)("li",{children:"Balance guidelines and validation"}),(0,p.jsx)("li",{children:"Component customization"}),(0,p.jsx)("li",{children:"Real-time spell preview"})]})]}),(0,p.jsx)("div",{style:{background:"rgba(245, 158, 11, 0.1)",borderRadius:"6px",padding:"0.75rem",border:"1px solid #f59e0b",marginTop:"1rem"},children:(0,p.jsx)("div",{style:{color:"#fbbf24",fontSize:"0.9rem",textAlign:"center"},children:"\u26a0\ufe0f For Experienced Players"})})]})]}),(0,p.jsxs)("div",{style:{marginTop:"3rem",textAlign:"center",padding:"2rem",background:"rgba(15, 23, 42, 0.4)",borderRadius:"8px",border:"1px solid #334155"},children:[(0,p.jsx)("h3",{style:{margin:"0 0 1rem",color:"#f1f5f9"},children:"\ud83d\udcca Spell Library Stats"}),(0,p.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",maxWidth:"800px",margin:"0 auto"},children:Le.schools.map(e=>{const t=je(e.name).length;return(0,p.jsxs)("div",{style:{padding:"1rem",background:"rgba(15, 23, 42, 0.6)",borderRadius:"6px",border:"1px solid ".concat(e.color)},children:[(0,p.jsx)("div",{style:{color:e.color,fontWeight:"bold"},children:e.name}),(0,p.jsxs)("div",{style:{color:"#94a3b8",fontSize:"0.9rem"},children:[t," spells"]})]},e.name)})})]})]}),"premade"===r&&(0,p.jsxs)("div",{style:{display:"flex",height:"calc(100vh - 120px)"},children:[(0,p.jsxs)("div",{style:{width:"300px",padding:"2rem",borderRight:"1px solid #334155",overflowY:"auto",background:"rgba(15, 23, 42, 0.4)"},children:[(0,p.jsx)("h3",{style:{marginBottom:"1rem",color:"#f1f5f9"},children:"\ud83d\udcda Browse by School"}),(0,p.jsxs)("button",{onClick:()=>g("any"),style:{width:"100%",padding:"1rem",marginBottom:"0.5rem",background:"any"===i?"#374151":"rgba(15, 23, 42, 0.6)",border:"1px solid #4b5563",borderRadius:"6px",color:"#f9fafb",cursor:"pointer",textAlign:"left",fontSize:"1rem"},children:["\ud83c\udf1f All Schools (",Ce().length," spells)"]}),Le.schools.map(e=>{const t=je(e.name).length;return(0,p.jsxs)("button",{onClick:()=>{o(e.name.toLowerCase()),g(e.name)},style:{width:"100%",padding:"1rem",marginBottom:"0.5rem",background:i===e.name.toLowerCase()?e.color:"rgba(15, 23, 42, 0.6)",border:"1px solid ".concat(e.color),borderRadius:"6px",color:i===e.name.toLowerCase()?"#ffffff":e.color,cursor:"pointer",textAlign:"left",fontSize:"0.9rem",transition:"all 0.2s ease"},children:[(0,p.jsx)("div",{style:{fontWeight:"bold"},children:e.name}),(0,p.jsxs)("div",{style:{fontSize:"0.8rem",opacity:.8},children:[e.description," (",t," spells)"]})]},e.name)})]}),(0,p.jsx)("div",{style:{flex:1,padding:"2rem",overflowY:"auto"},children:0===s.length?(0,p.jsxs)("div",{style:{textAlign:"center",padding:"3rem",color:"#94a3b8"},children:[(0,p.jsx)("div",{style:{fontSize:"4rem",marginBottom:"1rem"},children:"\ud83d\udcda"}),(0,p.jsx)("h3",{style:{margin:"0 0 1rem",color:"#cbd5e1"},children:"Select a School"}),(0,p.jsx)("p",{children:"Choose a school of magic from the left panel to browse curated spells."})]}):(0,p.jsxs)("div",{children:[(0,p.jsxs)("h2",{style:{margin:"0 0 1.5rem",color:"#f1f5f9"},children:["any"===i?"All Schools":(null===(t=Le.schools.find(e=>e.name.toLowerCase()===i))||void 0===t?void 0:t.name)||"Spells",(0,p.jsxs)("span",{style:{color:"#94a3b8",fontSize:"1rem",fontWeight:"normal",marginLeft:"1rem"},children:["(",s.length," spells)"]})]}),(0,p.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(400px, 1fr))",gap:"1.5rem"},children:s.map((e,t)=>(0,p.jsxs)("div",{style:{background:"rgba(15, 23, 42, 0.8)",borderRadius:"8px",padding:"1.5rem",border:"2px solid ".concat(e.color),transition:"transform 0.2s ease"},children:[(0,p.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,p.jsx)("h3",{style:{margin:"0 0 0.25rem",color:e.color,fontSize:"1.3rem"},children:e.name}),(0,p.jsxs)("p",{style:{margin:0,color:"#94a3b8",fontSize:"0.9rem"},children:[0===e.level?"Cantrip":"Level ".concat(e.level)," ",e.school]})]}),(0,p.jsxs)("div",{style:{marginBottom:"1rem",fontSize:"0.9rem",color:"#cbd5e1"},children:[(0,p.jsxs)("p",{style:{margin:"0.25rem 0"},children:[(0,p.jsx)("strong",{children:"Casting Time:"})," ",e.castingTime]}),(0,p.jsxs)("p",{style:{margin:"0.25rem 0"},children:[(0,p.jsx)("strong",{children:"Range:"})," ",e.range]}),(0,p.jsxs)("p",{style:{margin:"0.25rem 0"},children:[(0,p.jsx)("strong",{children:"Components:"})," ",e.components.join(", ")]}),(0,p.jsxs)("p",{style:{margin:"0.25rem 0"},children:[(0,p.jsx)("strong",{children:"Duration:"})," ",e.duration]})]}),(0,p.jsx)("div",{style:{marginBottom:"1.5rem"},children:(0,p.jsx)("p",{style:{margin:0,color:"#e2e8f0",lineHeight:"1.5"},children:e.description})}),(0,p.jsx)("button",{onClick:()=>(e=>{if(d.find(t=>t.name===e.name))return void alert("Spell already saved!");const t=[...d,e];u(t),localStorage.setItem("world-engine-saved-spells",JSON.stringify(t)),console.log("Spell saved:",e.name)})(e),style:{width:"100%",padding:"0.75rem",background:"#059669",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"1rem",fontWeight:"bold"},children:"\ud83d\udcbe Save to Spellbook"})]},t))})]})})]}),d.length>0&&(0,p.jsxs)("div",{style:{position:"fixed",bottom:"2rem",right:"2rem",background:"rgba(15, 23, 42, 0.9)",border:"1px solid #334155",borderRadius:"8px",padding:"1rem",color:"#f1f5f9"},children:["\ud83d\udcbe ",d.length," spells saved"]})]})}function Ae(e){let{onBack:t}=e;const[n,r]=(0,l.useState)([]),[a,i]=(0,l.useState)([]),[o,c]=(0,l.useState)(-1),[d,u]=(0,l.useState)(-1),h=e=>e.class||e.characterClass||"Unknown",g=e=>{var t;return e.level||(null===(t=e.data)||void 0===t?void 0:t.level)||1};(0,l.useEffect)(()=>{try{const e=JSON.parse(localStorage.getItem("world-engine-characters")||"[]"),t=JSON.parse(localStorage.getItem("world-engine-saved-spells")||"[]"),n=[{id:"test-cleric",name:"Elara the Cleric",class:"Cleric",race:"Human",level:3,baseStats:{strength:12,constitution:14,wisdom:16,intelligence:10,dexterity:13,charisma:15},finalStats:{strength:12,constitution:14,wisdom:16,intelligence:10,dexterity:13,charisma:15},hitPoints:28,knownSpells:[],knownCantrips:[]},{id:"test-wizard",name:"Merlin the Wise",class:"Wizard",race:"Elf",level:4,baseStats:{strength:8,constitution:12,wisdom:13,intelligence:17,dexterity:14,charisma:10},finalStats:{strength:8,constitution:12,wisdom:13,intelligence:17,dexterity:14,charisma:10},hitPoints:24,knownSpells:[],knownCantrips:[]},{id:"test-paladin",name:"Sir Roland",class:"Paladin",race:"Human",level:3,baseStats:{strength:16,constitution:14,wisdom:11,intelligence:10,dexterity:10,charisma:15},finalStats:{strength:16,constitution:14,wisdom:11,intelligence:10,dexterity:10,charisma:15},hitPoints:32,knownSpells:[],knownCantrips:[]},{id:"test-sorcerer",name:"Luna Stormcaller",class:"Sorcerer",race:"Dragonborn",level:2,baseStats:{strength:10,constitution:13,wisdom:12,intelligence:11,dexterity:14,charisma:16},finalStats:{strength:10,constitution:13,wisdom:12,intelligence:11,dexterity:14,charisma:16},hitPoints:18,knownSpells:[],knownCantrips:[]},{id:"test-druid",name:"Thorn Earthwalker",class:"Druid",race:"Half-Elf",level:3,baseStats:{strength:11,constitution:14,wisdom:16,intelligence:12,dexterity:13,charisma:14},finalStats:{strength:11,constitution:14,wisdom:16,intelligence:12,dexterity:13,charisma:14},hitPoints:26,knownSpells:[],knownCantrips:[]}],a=[...n];e.forEach(e=>{n.find(t=>t.id===e.id)||a.push(e)}),r(a),i(t),console.log("Loaded characters:",a.length,"characters (",n.length,"test +",e.length,"saved)")}catch(e){console.error("Error loading data:",e),r([{id:"test-cleric",name:"Elara the Cleric",class:"Cleric",race:"Human",level:3,baseStats:{strength:12,constitution:14,wisdom:16,intelligence:10,dexterity:13,charisma:15},finalStats:{strength:12,constitution:14,wisdom:16,intelligence:10,dexterity:13,charisma:15},hitPoints:28,knownSpells:[],knownCantrips:[]},{id:"test-wizard",name:"Merlin the Wise",class:"Wizard",race:"Elf",level:4,baseStats:{strength:8,constitution:12,wisdom:13,intelligence:17,dexterity:14,charisma:10},finalStats:{strength:8,constitution:12,wisdom:13,intelligence:17,dexterity:14,charisma:10},hitPoints:24,knownSpells:[],knownCantrips:[]},{id:"test-paladin",name:"Sir Roland",class:"Paladin",race:"Human",level:3,baseStats:{strength:16,constitution:14,wisdom:11,intelligence:10,dexterity:10,charisma:15},finalStats:{strength:16,constitution:14,wisdom:11,intelligence:10,dexterity:10,charisma:15},hitPoints:32,knownSpells:[],knownCantrips:[]},{id:"test-sorcerer",name:"Luna Stormcaller",class:"Sorcerer",race:"Dragonborn",level:2,baseStats:{strength:10,constitution:13,wisdom:12,intelligence:11,dexterity:14,charisma:16},finalStats:{strength:10,constitution:13,wisdom:12,intelligence:11,dexterity:14,charisma:16},hitPoints:18,knownSpells:[],knownCantrips:[]},{id:"test-druid",name:"Thorn Earthwalker",class:"Druid",race:"Half-Elf",level:3,baseStats:{strength:11,constitution:14,wisdom:16,intelligence:12,dexterity:13,charisma:14},finalStats:{strength:11,constitution:14,wisdom:16,intelligence:12,dexterity:13,charisma:14},hitPoints:26,knownSpells:[],knownCantrips:[]}])}},[]);const f=(e,t)=>{const n=h(e),r=g(e),a={Wizard:{schools:["all"],maxLevel:Math.ceil(r/2)+1,stat:"intelligence"},Sorcerer:{schools:["all"],maxLevel:Math.ceil(r/2)+1,stat:"charisma"},Cleric:{schools:["Abjuration","Divination","Evocation","Healing"],maxLevel:Math.ceil(r/2)+1,stat:"wisdom"},Druid:{schools:["Conjuration","Divination","Evocation","Transmutation","Healing"],maxLevel:Math.ceil(r/2)+1,stat:"wisdom"},Paladin:{schools:["Abjuration","Evocation","Healing"],maxLevel:Math.max(1,Math.ceil((r-1)/4)),stat:"charisma"},Ranger:{schools:["Conjuration","Divination","Transmutation"],maxLevel:Math.max(1,Math.ceil((r-1)/4)),stat:"wisdom"},Bard:{schools:["all"],maxLevel:Math.ceil(r/2)+1,stat:"charisma"},Warlock:{schools:["all"],maxLevel:Math.min(5,Math.ceil(r/2)+1),stat:"charisma"}}[n];return!!a&&(!(t.level>a.maxLevel)&&(!("all"!==a.schools[0]&&!a.schools.includes(t.school))&&(0===t.level?!(null!==(i=e.knownCantrips)&&void 0!==i&&i.includes(t.name)):!(null!==(o=e.knownSpells)&&void 0!==o&&o.includes(t.name)))));var i,o},m=(e,t,a)=>{const i=n.map((n,r)=>{var i,o;return r===e?s(s({},n),{},a?{knownCantrips:(null===(i=n.knownCantrips)||void 0===i?void 0:i.filter(e=>e!==t))||[]}:{knownSpells:(null===(o=n.knownSpells)||void 0===o?void 0:o.filter(e=>e!==t))||[]}):n});r(i),localStorage.setItem("world-engine-characters",JSON.stringify(i))},y=e=>{const t=h(e),n=g(e);return{Wizard:{maxLevel:Math.ceil(n/2)+1,stat:"Intelligence"},Sorcerer:{maxLevel:Math.ceil(n/2)+1,stat:"Charisma"},Cleric:{maxLevel:Math.ceil(n/2)+1,stat:"Wisdom"},Druid:{maxLevel:Math.ceil(n/2)+1,stat:"Wisdom"},Paladin:{maxLevel:Math.max(1,Math.ceil((n-1)/4)),stat:"Charisma"},Ranger:{maxLevel:Math.max(1,Math.ceil((n-1)/4)),stat:"Wisdom"},Bard:{maxLevel:Math.ceil(n/2)+1,stat:"Charisma"},Warlock:{maxLevel:Math.min(5,Math.ceil(n/2)+1),stat:"Charisma"}}[t]};return(0,p.jsxs)("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #0f172a 0%, #1e293b 100%)",color:"#e2e8f0",padding:"2rem"},children:[(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem",padding:"1rem",background:"rgba(15, 23, 42, 0.8)",borderRadius:"8px",border:"1px solid #334155"},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("h1",{style:{margin:0,fontSize:"2rem",fontWeight:"bold"},children:"Spell Assignment"}),(0,p.jsx)("p",{style:{margin:"0.5rem 0 0",opacity:.8},children:"Assign spells to characters based on their class and abilities"})]}),t&&(0,p.jsx)("button",{onClick:t,style:{padding:"0.5rem 1rem",background:"#475569",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:"Back to Menu"})]}),(0,p.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"2rem"},children:[(0,p.jsxs)("div",{style:{background:"rgba(30, 41, 59, 0.8)",border:"1px solid #334155",borderRadius:"8px",padding:"1.5rem"},children:[(0,p.jsx)("h2",{style:{margin:"0 0 1rem",color:"#3b82f6"},children:"Assign Spells"}),0===n.length&&(0,p.jsx)("p",{style:{color:"#94a3b8",fontStyle:"italic"},children:"No characters found. Create some characters first!"}),0===a.length&&(0,p.jsx)("p",{style:{color:"#94a3b8",fontStyle:"italic"},children:"No spells available. Generate some spells first!"}),n.length>0&&a.length>0&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,p.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold"},children:"Select Character:"}),(0,p.jsxs)("select",{value:o,onChange:e=>c(parseInt(e.target.value)),style:{width:"100%",padding:"0.5rem",background:"#1e293b",border:"1px solid #475569",borderRadius:"4px",color:"#e2e8f0"},children:[(0,p.jsx)("option",{value:-1,children:"Choose a character..."}),n.map((e,t)=>{const n=y(e),r=h(e),a=g(e);return(0,p.jsxs)("option",{value:t,children:[e.name," (",r,", Level ",a,n?" - Max Spell Level ".concat(n.maxLevel):" - No Spellcasting",")"]},t)})]})]}),(0,p.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,p.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold"},children:"Select Spell:"}),(0,p.jsxs)("select",{value:d,onChange:e=>u(parseInt(e.target.value)),style:{width:"100%",padding:"0.5rem",background:"#1e293b",border:"1px solid #475569",borderRadius:"4px",color:"#e2e8f0"},children:[(0,p.jsx)("option",{value:-1,children:"Choose a spell..."}),a.map((e,t)=>{const r=!(o>=0)||f(n[o],e);return(0,p.jsxs)("option",{value:t,disabled:!r,style:{color:r?"#e2e8f0":"#6b7280"},children:[e.name," (Level ",e.level,", ",e.school,")",r?"":" - Cannot Learn"]},t)})]})]}),(0,p.jsx)("button",{onClick:()=>{if(-1===o||-1===d)return;const e=n[o],t=a[d];if(!f(e,t))return void alert("".concat(e.name," cannot learn ").concat(t.name,"!"));const i=n.map((e,n)=>n===o?0===t.level?s(s({},e),{},{knownCantrips:[...e.knownCantrips||[],t.name]}):s(s({},e),{},{knownSpells:[...e.knownSpells||[],t.name]}):e);r(i),localStorage.setItem("world-engine-characters",JSON.stringify(i)),c(-1),u(-1)},disabled:-1===o||-1===d,style:{width:"100%",padding:"0.75rem",background:o>=0&&d>=0?"#3b82f6":"#475569",color:"white",border:"none",borderRadius:"6px",fontSize:"1rem",cursor:o>=0&&d>=0?"pointer":"not-allowed",fontWeight:"bold"},children:"Assign Spell"}),o>=0&&d>=0&&(0,p.jsx)("div",{style:{marginTop:"1rem",padding:"1rem",background:f(n[o],a[d])?"rgba(34, 197, 94, 0.1)":"rgba(239, 68, 68, 0.1)",border:"1px solid ".concat(f(n[o],a[d])?"#22c55e":"#ef4444"),borderRadius:"6px"},children:(0,p.jsx)("p",{style:{margin:0,fontSize:"0.9rem"},children:f(n[o],a[d])?"\u2713 ".concat(n[o].name," can learn ").concat(a[d].name,"!"):"\u2717 ".concat(n[o].name," cannot learn ").concat(a[d].name,".")})})]})]}),(0,p.jsxs)("div",{style:{background:"rgba(30, 41, 59, 0.8)",border:"1px solid #334155",borderRadius:"8px",padding:"1.5rem"},children:[(0,p.jsx)("h2",{style:{margin:"0 0 1rem",color:"#22c55e"},children:"Character Spells"}),0===n.length?(0,p.jsx)("p",{style:{color:"#94a3b8",fontStyle:"italic"},children:"No characters to display."}):(0,p.jsx)("div",{style:{maxHeight:"70vh",overflowY:"auto"},children:n.map((e,t)=>{const n=y(e);return(0,p.jsxs)("div",{style:{marginBottom:"1.5rem",padding:"1rem",background:"rgba(15, 23, 42, 0.6)",border:"1px solid #475569",borderRadius:"6px"},children:[(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,p.jsx)("h3",{style:{margin:0,color:"#f8fafc"},children:e.name}),(0,p.jsxs)("span",{style:{fontSize:"0.8rem",color:"#94a3b8"},children:[h(e)," Level ",g(e)]})]}),n?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("p",{style:{margin:"0.5rem 0",fontSize:"0.8rem",color:"#94a3b8"},children:["Spellcasting Stat: ",n.stat," | Max Spell Level: ",n.maxLevel]}),e.knownCantrips&&e.knownCantrips.length>0&&(0,p.jsxs)("div",{style:{marginBottom:"0.5rem"},children:[(0,p.jsx)("h4",{style:{margin:"0 0 0.25rem",fontSize:"0.9rem",color:"#60a5fa"},children:"Cantrips:"}),e.knownCantrips.map((e,n)=>(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.25rem 0.5rem",background:"rgba(59, 130, 246, 0.1)",border:"1px solid #3b82f6",borderRadius:"4px",margin:"0.25rem 0",fontSize:"0.8rem"},children:[(0,p.jsx)("span",{children:e}),(0,p.jsx)("button",{onClick:()=>m(t,e,!0),style:{background:"#ef4444",color:"white",border:"none",borderRadius:"3px",padding:"0.125rem 0.25rem",fontSize:"0.7rem",cursor:"pointer"},children:"Remove"})]},n))]}),e.knownSpells&&e.knownSpells.length>0&&(0,p.jsxs)("div",{children:[(0,p.jsx)("h4",{style:{margin:"0 0 0.25rem",fontSize:"0.9rem",color:"#34d399"},children:"Spells:"}),e.knownSpells.map((e,n)=>(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.25rem 0.5rem",background:"rgba(34, 197, 94, 0.1)",border:"1px solid #22c55e",borderRadius:"4px",margin:"0.25rem 0",fontSize:"0.8rem"},children:[(0,p.jsx)("span",{children:e}),(0,p.jsx)("button",{onClick:()=>m(t,e,!1),style:{background:"#ef4444",color:"white",border:"none",borderRadius:"3px",padding:"0.125rem 0.25rem",fontSize:"0.7rem",cursor:"pointer"},children:"Remove"})]},n))]}),(!e.knownSpells||0===e.knownSpells.length)&&(!e.knownCantrips||0===e.knownCantrips.length)&&(0,p.jsx)("p",{style:{fontSize:"0.8rem",color:"#6b7280",fontStyle:"italic"},children:"No spells learned yet."})]}):(0,p.jsx)("p",{style:{fontSize:"0.8rem",color:"#6b7280",fontStyle:"italic"},children:"This class cannot cast spells."})]},t)})})]})]})]})}function Ne(e){let{onBack:t}=e;const[n,r]=(0,l.useState)([]),[a,i]=(0,l.useState)([]),[o,c]=(0,l.useState)([]);l.useEffect(()=>{try{const e=JSON.parse(localStorage.getItem("world-engine-characters")||"[]"),t=JSON.parse(localStorage.getItem("world-engine-saved-spells")||"[]");console.log("Raw saved characters:",e);const n=[{name:"Elara the Cleric",class:"Cleric",baseStats:{strength:12,constitution:14,wisdom:16,intelligence:10,dexterity:13,charisma:15},finalStats:{strength:12,constitution:14,wisdom:16,intelligence:10,dexterity:13,charisma:15},hitPoints:32,level:3,knownSpells:["Cure Light Wounds","Healing Word","Prayer of Healing"]},{name:"Thorin Ironbeard",class:"Fighter",baseStats:{strength:16,constitution:15,wisdom:11,intelligence:9,dexterity:12,charisma:10},finalStats:{strength:16,constitution:15,wisdom:11,intelligence:9,dexterity:12,charisma:10},hitPoints:18,level:2},{name:"Luna Shadowstep",class:"Rogue",baseStats:{strength:10,constitution:12,wisdom:14,intelligence:13,dexterity:17,charisma:11},finalStats:{strength:10,constitution:12,wisdom:14,intelligence:13,dexterity:17,charisma:11},hitPoints:22,level:2}],a=[...n];e.forEach(e=>{if(e.characterClass&&e.name&&!a.find(t=>t.name===e.name)){var t;const n=e.data||e,r=n.constitution||(null===(t=n.baseStats)||void 0===t?void 0:t.constitution)||14,i=e.level||n.level||1,o=10+Math.floor((r-10)/2)*i,s=Math.max(o+6*i,20),l={name:e.name,class:e.characterClass,baseStats:{strength:n.strength||10,constitution:r,wisdom:n.wisdom||12,intelligence:n.intelligence||11,dexterity:n.dexterity||13,charisma:n.charisma||10},finalStats:{strength:n.strength||10,constitution:r,wisdom:n.wisdom||12,intelligence:n.intelligence||11,dexterity:n.dexterity||13,charisma:n.charisma||10},hitPoints:s,level:i,knownSpells:n.knownSpells||[],knownCantrips:n.knownCantrips||[]};a.push(l)}}),r(a),d("Loaded ".concat(a.length," characters for healing system (").concat(n.length," test + ").concat(a.length-n.length," saved)"));const o=a.filter(e=>!n.find(t=>t.name===e.name));o.length>0&&d("Custom characters loaded: ".concat(o.map(e=>"".concat(e.name," (").concat(e.hitPoints," HP)")).join(", "))),i(t)}catch(e){console.error("Error loading data:",e);r([{name:"Elara the Cleric",class:"Cleric",baseStats:{strength:12,constitution:14,wisdom:16,intelligence:10,dexterity:13,charisma:15},finalStats:{strength:12,constitution:14,wisdom:16,intelligence:10,dexterity:13,charisma:15},hitPoints:32,level:3,knownSpells:["Cure Light Wounds","Healing Word","Prayer of Healing"]}]),d("Loaded fallback test characters")}},[]);const d=e=>{c(t=>[...t,e])},u=e=>Math.floor(Math.random()*e)+1,h=e=>Math.floor((e-10)/2),g=e=>e<=0?"#991b1b":e<=25?"#dc2626":e<=50?"#f59e0b":e<=75?"#eab308":"#10b981",f=a.filter(e=>e.description.toLowerCase().includes("heal")||e.description.toLowerCase().includes("restore"));return(0,p.jsxs)("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #0f172a 0%, #1e293b 100%)",color:"#e2e8f0",padding:"2rem"},children:[(0,p.jsxs)("div",{style:{padding:"1.5rem 2rem",borderBottom:"1px solid #334155",background:"rgba(15, 23, 42, 0.8)",display:"flex",justifyContent:"space-between",alignItems:"center",borderRadius:"8px",marginBottom:"2rem"},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("h1",{style:{margin:0,fontSize:"2.5rem",fontWeight:"bold"},children:"\u2695\ufe0f Healing & Recovery System"}),(0,p.jsx)("p",{style:{margin:"0.5rem 0 0",opacity:.8},children:"Manage your party's health and use healing magic"})]}),t&&(0,p.jsx)("button",{onClick:t,style:{padding:"0.75rem 1.5rem",background:"#374151",color:"#f9fafb",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"1rem"},children:"Back to Menu"})]}),(0,p.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"2rem"},children:[(0,p.jsxs)("div",{style:{background:"rgba(15, 23, 42, 0.6)",borderRadius:"8px",padding:"1.5rem",border:"1px solid #334155"},children:[(0,p.jsx)("h2",{style:{margin:"0 0 1.5rem",color:"#f1f5f9"},children:"\ud83d\udc65 Party Health Status"}),0===n.length?(0,p.jsx)("div",{style:{textAlign:"center",padding:"2rem",color:"#64748b",fontStyle:"italic"},children:"No characters found. Create some characters first!"}):(0,p.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:n.map((e,t)=>{return(0,p.jsxs)("div",{style:{padding:"1rem",background:"rgba(15, 23, 42, 0.8)",border:"2px solid ".concat(g(e.hitPoints)),borderRadius:"6px"},children:[(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("h3",{style:{margin:"0 0 0.25rem",color:"#f1f5f9"},children:e.name}),(0,p.jsxs)("p",{style:{margin:0,color:"#94a3b8",fontSize:"0.9rem"},children:[e.class," \u2022 Level ",e.level]})]}),(0,p.jsxs)("div",{style:{textAlign:"right"},children:[(0,p.jsxs)("div",{style:{fontSize:"1.2rem",fontWeight:"bold",color:g(e.hitPoints)},children:[e.hitPoints,"/100 HP"]}),(0,p.jsx)("div",{style:{fontSize:"0.8rem",color:g(e.hitPoints)},children:(n=e.hitPoints,n<=0?"Unconscious":n<=25?"Critical":n<=50?"Injured":n<=75?"Wounded":"Healthy")})]})]}),(0,p.jsx)("div",{style:{marginTop:"0.75rem",width:"100%",height:"8px",background:"#374151",borderRadius:"4px",overflow:"hidden"},children:(0,p.jsx)("div",{style:{width:"".concat(e.hitPoints,"%"),height:"100%",background:g(e.hitPoints),transition:"width 0.3s ease"}})}),(0,p.jsxs)("div",{style:{marginTop:"1rem",display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[(0,p.jsx)("button",{onClick:()=>(e=>{const t=h(e.finalStats.constitution),n=Math.max(1,u(4)+t),a=e.hitPoints,i=Math.min(e.hitPoints+n,100);r(t=>t.map(t=>t.name===e.name?s(s({},t),{},{hitPoints:i}):t));const o=i-a;d("\ud83d\udee1\ufe0f ".concat(e.name," takes a rest and recovers naturally")),d("\ud83d\udc9a Natural healing: ".concat(o," HP (").concat(a," \u2192 ").concat(i,")"))})(e),style:{padding:"0.5rem 1rem",background:"#059669",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"0.9rem"},children:"\ud83d\udecf\ufe0f Natural Rest"}),(0,p.jsx)("button",{onClick:()=>(e=>{if(isNaN(e.hitPoints)||void 0===e.hitPoints)return void d("\u274c Error: ".concat(e.name," has invalid HP data. Cannot simulate injury."));const t=u(20)+u(6),n=e.hitPoints,a=Math.max(0,e.hitPoints-t);r(t=>t.map(t=>t.name===e.name?s(s({},t),{},{hitPoints:a}):t)),d("\ud83d\udca5 ".concat(e.name," suffers an injury: ").concat(t," damage (").concat(n," \u2192 ").concat(a,")")),0===a&&d("\ud83d\udc80 ".concat(e.name," is unconscious and needs immediate healing!"))})(e),style:{padding:"0.5rem 1rem",background:"#dc2626",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"0.9rem"},children:"\ud83d\udca5 Simulate Injury"})]})]},t);var n})})]}),(0,p.jsxs)("div",{style:{background:"rgba(15, 23, 42, 0.6)",borderRadius:"8px",padding:"1.5rem",border:"1px solid #334155"},children:[(0,p.jsx)("h2",{style:{margin:"0 0 1.5rem",color:"#f1f5f9"},children:"\u2728 Healing Magic"}),0===f.length?(0,p.jsx)("div",{style:{textAlign:"center",padding:"2rem",color:"#64748b",fontStyle:"italic"},children:"No healing spells found. Generate some healing spells in the Spell Generator!"}):(0,p.jsxs)("div",{children:[(0,p.jsxs)("p",{style:{color:"#94a3b8",marginBottom:"1rem"},children:["Available healing spells: ",f.length]}),(0,p.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:f.map((e,t)=>(0,p.jsxs)("div",{style:{padding:"1rem",background:"rgba(15, 23, 42, 0.8)",border:"2px solid ".concat(e.color),borderRadius:"6px"},children:[(0,p.jsxs)("div",{style:{marginBottom:"0.75rem"},children:[(0,p.jsx)("h4",{style:{margin:"0 0 0.25rem",color:e.color},children:e.name}),(0,p.jsxs)("p",{style:{margin:0,fontSize:"0.8rem",color:"#94a3b8"},children:[0===e.level?"Cantrip":"Level ".concat(e.level)," \u2022 ",e.school]}),(0,p.jsx)("p",{style:{margin:"0.5rem 0",fontSize:"0.9rem",color:"#cbd5e1"},children:e.description})]}),(0,p.jsxs)("div",{style:{marginBottom:"0.75rem"},children:[(0,p.jsx)("label",{style:{fontSize:"0.9rem",color:"#94a3b8",marginBottom:"0.5rem",display:"block"},children:"Choose caster:"}),(0,p.jsxs)("select",{style:{width:"100%",padding:"0.5rem",background:"#374151",border:"1px solid #6b7280",borderRadius:"4px",color:"#f9fafb"},children:[(0,p.jsx)("option",{value:"",children:"Select a character..."}),n.map((e,t)=>(0,p.jsxs)("option",{value:t,children:[e.name," (Level ",e.level," ",e.class,")"]},t))]})]}),(0,p.jsxs)("div",{style:{marginBottom:"0.75rem"},children:[(0,p.jsx)("label",{style:{fontSize:"0.9rem",color:"#94a3b8",marginBottom:"0.5rem",display:"block"},children:"Choose target:"}),(0,p.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem"},children:n.map((t,a)=>(0,p.jsxs)("button",{onClick:()=>{const a=document.querySelector("select"),i=parseInt((null===a||void 0===a?void 0:a.value)||"0");null!==a&&void 0!==a&&a.value&&n[i]?((e,t,n)=>{const a=t.description.toLowerCase();if(!a.includes("heal")&&!a.includes("restore"))return void d("\u274c ".concat(t.name," is not a healing spell!"));let i=0;const o=h(e.finalStats.wisdom);i=0===t.level?u(4)+o:u(8)*t.level+o,i=Math.max(1,i);const l=n.hitPoints,c=Math.min(n.hitPoints+i,100);r(e=>e.map(e=>e.name===n.name?s(s({},e),{},{hitPoints:c}):e));const p=c-l;d("\u2728 ".concat(e.name," casts ").concat(t.name," on ").concat(n.name)),d("\ud83d\udc9a ".concat(n.name," heals ").concat(p," HP (").concat(l," \u2192 ").concat(c,")")),0===p&&d("".concat(n.name," is already at full health!"))})(n[i],e,t):d("\u274c Please select a caster first!")},style:{padding:"0.5rem 0.75rem",background:t.hitPoints<100?"#3b82f6":"#6b7280",color:"white",border:"none",borderRadius:"4px",cursor:t.hitPoints<100?"pointer":"not-allowed",fontSize:"0.8rem"},disabled:t.hitPoints>=100,children:[t.name," (",t.hitPoints,"/100)"]},a))})]})]},t))})]})]})]}),(0,p.jsxs)("div",{style:{marginTop:"2rem",padding:"1.5rem",background:"rgba(15, 23, 42, 0.6)",borderRadius:"8px",border:"1px solid #334155"},children:[(0,p.jsx)("h3",{style:{margin:"0 0 1rem",color:"#f1f5f9"},children:"\ud83d\udcdc Healing Log"}),(0,p.jsx)("div",{style:{background:"rgba(0, 0, 0, 0.3)",borderRadius:"4px",padding:"1rem",maxHeight:"200px",overflowY:"auto",fontSize:"0.9rem"},children:0===o.length?(0,p.jsx)("p",{style:{color:"#64748b",fontStyle:"italic"},children:"No healing actions yet..."}):o.slice(-10).map((e,t)=>(0,p.jsx)("div",{style:{marginBottom:"0.5rem",color:"#d1d5db"},children:e},t))}),(0,p.jsx)("button",{onClick:()=>c([]),style:{marginTop:"1rem",padding:"0.5rem 1rem",background:"#6b7280",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"0.9rem"},children:"Clear Log"})]})]})}class Be{constructor(e){this.seed=void 0,this.seed="string"===typeof e?this.hash(e):e}hash(e){let t=2166136261;for(let n=0;n<e.length;n++)t^=e.charCodeAt(n),t=Math.imul(t,16777619);return t>>>0}next(){let e=this.seed+2654435769;return e^=e<<13,e^=e>>>17,e^=e<<5,this.seed=e>>>0,(this.seed>>>0)/4294967296}nextFloat(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e+this.next()*(t-e)}nextInt(e,t){return Math.floor(this.nextFloat(e,t+1))}pick(e){return e[this.nextInt(0,e.length-1)]}}class De{constructor(e){this.permTable=void 0,this.gradients=void 0;const t=new Be(e);this.permTable=Array.from({length:512},(e,t)=>t%256);for(let n=this.permTable.length-1;n>0;n--){const e=t.nextInt(0,n);[this.permTable[n],this.permTable[e]]=[this.permTable[e],this.permTable[n]]}for(let n=0;n<256;n++)this.permTable[256+n]=this.permTable[n];this.gradients=[];for(let n=0;n<256;n++){const e=t.nextFloat(0,2*Math.PI);this.gradients.push({x:Math.cos(e),y:Math.sin(e)})}}fade(e){return e*e*e*(e*(6*e-15)+10)}lerp(e,t,n){return e+n*(t-e)}grad(e,t,n){const r=this.gradients[255&e];return r.x*t+r.y*n}noise(e,t){const n=255&Math.floor(e),r=255&Math.floor(t);e-=Math.floor(e),t-=Math.floor(t);const a=this.fade(e),i=this.fade(t),o=this.permTable[n]+r,s=this.permTable[n+1]+r;return this.lerp(this.lerp(this.grad(this.permTable[o],e,t),this.grad(this.permTable[s],e-1,t),a),this.lerp(this.grad(this.permTable[o+1],e,t-1),this.grad(this.permTable[s+1],e-1,t-1),a),i)}fbm(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,i=0,o=1,s=1,l=0;for(let c=0;c<n;c++)i+=this.noise(e*s,t*s)*o,l+=o,o*=r,s*=a;return i/l}ridge(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,i=0,o=1,s=1,l=0;for(let c=0;c<n;c++){i+=(1-Math.abs(this.noise(e*s,t*s)))*o,l+=o,o*=r,s*=a}return i/l}}class Oe{constructor(e){this.noiseX=void 0,this.noiseY=void 0,this.noiseX=new De("".concat(e,"_warpX")),this.noiseY=new De("".concat(e,"_warpY"))}warp(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;return{x:e+this.noiseX.fbm(.01*e,.01*t,4)*n,y:t+this.noiseY.fbm(.01*e,.01*t,4)*n}}}class Fe{constructor(e){this.seed=e,this.elevation=void 0,this.temperature=void 0,this.moisture=void 0,this.warp=void 0,this.elevation=new De("".concat(e,"_elev")),this.temperature=new De("".concat(e,"_temp")),this.moisture=new De("".concat(e,"_moist")),this.warp=new Oe("".concat(e,"_warp"))}getElevation(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/1024,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:700;const a=this.warp.warp(e,t,r);return this.elevation.fbm(a.x*n,a.y*n,6,.6,2)}getTemperature(e,t,n,r){const a=1-Math.abs(t-r/2)/(r/2),i=.8*Math.max(0,n-.3),o=.2*this.temperature.fbm(.005*e,.005*t,3,.3,2);return Math.max(0,Math.min(1,a-i+o))}getMoisture(e,t,n){const r=this.moisture.fbm(.003*e,.003*t,4,.5,2),a=n>.4?.3*Math.max(0,this.elevation.noise(.01*e,.01*t)):0;return Math.max(0,Math.min(1,(r+1)/2+a))}}const We=32;class He{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.seed=e,this.chunks=new Map,this.noise=void 0,this.config=void 0,this.noise=new Fe(e),this.config=s({seaLevel:0,continentFreq:1/1024,featureFreq:1/128,warpStrength:700,mapWidth:2048,mapHeight:2048},t)}worldToChunk(e,t){return{chunkX:Math.floor(e/We),chunkY:Math.floor(t/We)}}chunkKey(e,t){return"".concat(e,",").concat(t)}tileKey(e,t){return"".concat(e,",").concat(t)}ensureRadius(e,t,n){const r=this.worldToChunk(e,t),a=Math.ceil(n/We)+1;for(let i=-a;i<=a;i++)for(let o=-a;o<=a;o++){const a=r.chunkX+i,s=r.chunkY+o,l=a*We+16,c=s*We+16;Math.sqrt(Math.pow(l-e,2)+Math.pow(c-t,2))<=n+We&&this.ensureChunk(a,s)}}ensureChunk(e,t){const n=this.chunkKey(e,t);let r=this.chunks.get(n);return r||(r=this.createChunk(e,t),this.chunks.set(n,r)),r.generated||this.generateChunk(r),r.lastAccessed=Date.now(),r}createChunk(e,t){return{coord:{chunkX:e,chunkY:t},tiles:new Map,generated:!1,lastAccessed:Date.now()}}generateChunk(e){const t=e.coord.chunkX*We,n=e.coord.chunkY*We;for(let r=0;r<We;r++)for(let a=0;a<We;a++){const i=t+r,o=n+a,s=this.generateTile(i,o);e.tiles.set(this.tileKey(i,o),s)}e.generated=!0}generateTile(e,t){const n=this.noise.getElevation(e,t,this.config.continentFreq,this.config.warpStrength),r=this.noise.getTemperature(e,t,n,this.config.mapHeight),a=this.noise.getMoisture(e,t,n);return{x:e,y:t,biome:this.determineBiome(n,r,a),elevation:n,temperature:r,moisture:a,river:!1,road:!1,discovered:!1}}determineBiome(e,t,n){const{seaLevel:r}=this.config;return e<r-.02?"Ocean":e<r+.02?"Coast":e>.7?t<.2?"Snow":"Mountain":t<.15?n>.3?"Tundra":"Snow":t<.35?n>.6?"Taiga":"Tundra":t<.65?n>.7?"Forest":n>.4?"Grass":n>.2?"Savanna":"Desert":n>.8?"Jungle":n>.6?"Forest":n>.4?"Savanna":n>.2?"Grass":e<.5&&n>.6?"Swamp":"Desert"}getTile(e,t){const n=this.worldToChunk(e,t);return this.ensureChunk(n.chunkX,n.chunkY).tiles.get(this.tileKey(e,t))}hasTile(e,t){const n=this.worldToChunk(e,t),r=this.chunkKey(n.chunkX,n.chunkY),a=this.chunks.get(r);return(null===a||void 0===a?void 0:a.generated)&&a.tiles.has(this.tileKey(e,t))||!1}unloadBeyond(e,t,n){let r=0;const a=this.worldToChunk(e,t),i=Math.ceil(n/We)+2,o=[];return this.chunks.forEach((e,t)=>{const n=e.coord.chunkX-a.chunkX,r=e.coord.chunkY-a.chunkY;Math.sqrt(n*n+r*r)>i&&o.push(t)}),o.forEach(e=>{this.chunks.delete(e),r++}),r}getStats(){let e=0,t=0;this.chunks.forEach(n=>{n.generated&&(e++,t+=n.tiles.size)});const n=200*t/1048576;return{totalChunks:this.chunks.size,generatedChunks:e,totalTiles:t,memoryEstimateMB:n}}updateConfig(e){this.config=s(s({},this.config),e)}invalidateAll(){this.chunks.forEach(e=>{e.generated=!1,e.tiles.clear()})}}class qe{constructor(e){this.rng=void 0,this.rng=new Be(e)}generateAbility(e,t){const n=qe.ABILITY_TEMPLATES[e][t];if(!n||0===n.length)throw new Error("No templates found for ".concat(e," ").concat(t));const r=this.rng.pick(n);return s({name:this.generateAbilityName(e,t),school:e,tier:t},r)}generateAbilityName(e,t){const n=this.rng.pick({Novice:["Basic","Simple","Student's","Apprentice","Training"],Adept:["Skilled","Practiced","Advanced","Refined","Improved"],Expert:["Master","Superior","Perfect","Elite","Exceptional"],Master:["Grand","Supreme","Ultimate","Legendary","Transcendent"],Legendary:["Mythical","Divine","Eternal","Cosmic","Godlike"]}[t]),r=this.rng.pick({Weaponmastery:["Strike","Slash","Thrust","Cut","Blade Dance","Steel Song","Edge Mastery"],Combat:["Fist","Punch","Grapple","Throw","Counter","Fighting Form","Combat Style"],Athletics:["Leap","Sprint","Climb","Jump","Dash","Athletic Form","Body Control"],Tactics:["Strategy","Formation","Command","Leadership","Battle Plan","War Art"],Survival:["Track","Hunt","Navigate","Forage","Wilderness Way","Nature Bond"],Stealth:["Shadow","Sneak","Hide","Infiltrate","Silent Step","Phantom Move"],Defense:["Block","Guard","Shield","Protect","Aegis","Fortress Stance"],Berserker:["Rage","Fury","Wrath","Frenzy","Berserker","Primal Scream"]}[e]);return"".concat(n," ").concat(r)}getAvailableAbilities(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];const a=[];for(const i of Object.keys(qe.ABILITY_TEMPLATES))for(const o of Object.keys(qe.ABILITY_TEMPLATES[i])){const s=qe.ABILITY_TEMPLATES[i][o];for(const l of s){if(e<l.requirements.minLevel)continue;let s=!0;for(const[e,n]of Object.entries(l.requirements.requiredStats||{}))if((t[e]||0)<n){s=!1;break}if(!s)continue;if(l.requirements.requiredEquipment){if(!l.requirements.requiredEquipment.every(e=>n.some(t=>t.toLowerCase().includes(e.toLowerCase()))))continue}if(l.requirements.prerequisiteAbilities){if(!l.requirements.prerequisiteAbilities.every(e=>r.includes(e)))continue}const c=this.generateAbility(i,o);a.push(c)}}return a}generateAbilityScroll(e){const t=e>=9?"Legendary":e>=7?"Master":e>=5?"Expert":e>=3?"Adept":"Novice",n=Object.keys(qe.ABILITY_TEMPLATES),r=this.rng.pick(n),a=this.generateAbilityName(r,t);return{name:"".concat(a," Manual"),description:"A training manual that teaches the ".concat(a," technique from the ").concat(r," discipline.")}}}qe.ABILITY_TEMPLATES={Weaponmastery:{Novice:[{description:"A basic sword technique that strikes with improved accuracy.",requirements:{minLevel:1,requiredStats:{strength:12},requiredEquipment:["sword"]},effects:{damage:{min:2,max:6,type:"slashing"}},staminaCost:2,range:"touch"},{description:"Precise bow shot that rarely misses its target.",requirements:{minLevel:1,requiredStats:{dexterity:12},requiredEquipment:["bow"]},effects:{damage:{min:3,max:5,type:"piercing"}},staminaCost:1,range:"far"},{description:"Quick flourish that intimidates opponents.",requirements:{minLevel:2,requiredStats:{dexterity:10,charisma:10}},effects:{special:["intimidate","initiative_bonus"]},staminaCost:1,range:"near"}],Adept:[{description:"A spinning attack that strikes multiple nearby enemies.",requirements:{minLevel:4,requiredStats:{strength:14,dexterity:12}},effects:{damage:{min:4,max:8,type:"slashing"},special:["cleave"]},staminaCost:4,range:"near"},{description:"Twin-strike technique for dual-wielding weapons.",requirements:{minLevel:5,requiredStats:{dexterity:15},prerequisiteAbilities:["Basic Strike"]},effects:{damage:{min:3,max:6},special:["double_attack"]},staminaCost:5,range:"touch"}],Expert:[{description:"Devastating overhead strike that can cleave through armor.",requirements:{minLevel:8,requiredStats:{strength:16}},effects:{damage:{min:8,max:15,type:"slashing"},special:["armor_pierce"]},staminaCost:8,cooldown:3,range:"touch"}],Master:[{description:"Legendary sword technique that can cut through multiple foes in a single motion.",requirements:{minLevel:12,requiredStats:{strength:18,dexterity:16}},effects:{damage:{min:12,max:20,type:"slashing"},special:["chain_attack","armor_pierce"]},staminaCost:12,cooldown:5,range:"near"}],Legendary:[{description:"The ultimate expression of weapon mastery, a technique that transcends mortal limits.",requirements:{minLevel:18,requiredStats:{strength:20,dexterity:18}},effects:{damage:{min:20,max:35,type:"slashing"},special:["perfect_strike","ignore_armor","cleave_all"]},staminaCost:20,cooldown:10,range:"far"}]},Combat:{Novice:[{description:"Basic unarmed strike enhanced by training.",requirements:{minLevel:1,requiredStats:{strength:10}},effects:{damage:{min:1,max:4,type:"bludgeoning"}},staminaCost:1,range:"touch"},{description:"Simple grappling technique to restrain opponents.",requirements:{minLevel:2,requiredStats:{strength:12,dexterity:10}},effects:{special:["grapple","restrain"]},staminaCost:3,range:"touch"}],Adept:[{description:"Stunning blow that can daze enemies.",requirements:{minLevel:4,requiredStats:{strength:13,constitution:12}},effects:{damage:{min:3,max:6,type:"bludgeoning"},special:["stun"]},staminaCost:4,range:"touch"},{description:"Counter-attack that triggers when enemies miss.",requirements:{minLevel:5,requiredStats:{dexterity:14,wisdom:12}},effects:{damage:{min:2,max:5},special:["counter","reactive"]},staminaCost:0,range:"touch"}],Expert:[{description:"Devastating combination of strikes that builds momentum.",requirements:{minLevel:8,requiredStats:{strength:15,dexterity:15}},effects:{damage:{min:6,max:12,type:"bludgeoning"},special:["combo","momentum"]},staminaCost:7,range:"touch"}],Master:[{description:"Perfect martial arts technique that flows like water.",requirements:{minLevel:12,requiredStats:{strength:16,dexterity:18,wisdom:15}},effects:{damage:{min:10,max:18,type:"force"},special:["flowing_strike","unblockable"]},staminaCost:10,cooldown:4,range:"touch"}],Legendary:[{description:"Transcendent fighting technique that channels inner power.",requirements:{minLevel:18,requiredStats:{strength:18,dexterity:20,wisdom:18}},effects:{damage:{min:18,max:30,type:"force"},special:["ki_strike","ignore_armor","heal_self"]},staminaCost:15,cooldown:8,range:"near"}]},Athletics:{Novice:[{description:"Enhanced climbing ability for scaling walls and cliffs.",requirements:{minLevel:1,requiredStats:{strength:10,dexterity:10}},effects:{special:["climb_speed","sure_grip"]},staminaCost:2,range:"self"},{description:"Improved jumping distance and height.",requirements:{minLevel:1,requiredStats:{strength:11}},effects:{special:["long_jump","high_jump"]},staminaCost:1,range:"self"}],Adept:[{description:"Parkour techniques for rapid urban movement.",requirements:{minLevel:4,requiredStats:{dexterity:14,constitution:12}},effects:{special:["wall_run","fast_movement","obstacle_ignore"]},staminaCost:3,range:"self"},{description:"Enhanced endurance for long-distance activities.",requirements:{minLevel:3,requiredStats:{constitution:14}},effects:{buff:{stat:"stamina_regen",modifier:2}},staminaCost:0,range:"self"}],Expert:[{description:"Acrobatic maneuvers that help avoid attacks.",requirements:{minLevel:7,requiredStats:{dexterity:16,constitution:13}},effects:{special:["evasion_boost","acrobatic_dodge","fall_immunity"]},staminaCost:5,range:"self"}],Master:[{description:"Superhuman athletic ability that defies normal limits.",requirements:{minLevel:11,requiredStats:{strength:16,dexterity:17,constitution:16}},effects:{special:["perfect_balance","superhuman_speed","tireless"]},staminaCost:8,range:"self"}],Legendary:[{description:"Legendary athletic prowess that approaches the mythical.",requirements:{minLevel:16,requiredStats:{strength:18,dexterity:20,constitution:18}},effects:{special:["legendary_speed","physics_defying","unstoppable_momentum"]},staminaCost:12,cooldown:6,range:"self"}]},Tactics:{Novice:[{description:"Basic leadership that inspires nearby allies.",requirements:{minLevel:2,requiredStats:{intelligence:12,charisma:11}},effects:{buff:{stat:"morale",modifier:1},special:["inspire"]},staminaCost:2,range:"near"},{description:"Tactical assessment of battlefield conditions.",requirements:{minLevel:1,requiredStats:{intelligence:13,wisdom:10}},effects:{special:["battle_awareness","enemy_analysis"]},staminaCost:1,range:"far"}],Adept:[{description:"Coordinated attack with allies for increased effectiveness.",requirements:{minLevel:5,requiredStats:{intelligence:14,charisma:12}},effects:{damage:{min:0,max:0},special:["coordinated_attack","ally_bonus"]},staminaCost:4,range:"near"},{description:"Defensive formation that protects the group.",requirements:{minLevel:4,requiredStats:{intelligence:13,constitution:12}},effects:{special:["formation_defense","damage_reduction"]},staminaCost:3,range:"near"}],Expert:[{description:"Advanced battlefield strategy that confuses enemies.",requirements:{minLevel:8,requiredStats:{intelligence:16,wisdom:14}},effects:{special:["strategic_advantage","enemy_confusion","initiative_control"]},staminaCost:6,range:"far"}],Master:[{description:"Masterful tactical command that turns the tide of battle.",requirements:{minLevel:12,requiredStats:{intelligence:18,charisma:16,wisdom:15}},effects:{special:["battle_mastery","ally_coordination","enemy_disruption"]},staminaCost:10,cooldown:5,range:"far"}],Legendary:[{description:"Legendary generalship that can win battles against impossible odds.",requirements:{minLevel:17,requiredStats:{intelligence:20,charisma:18,wisdom:17}},effects:{special:["legendary_tactics","army_inspiration","victory_inevitable"]},staminaCost:15,cooldown:10,range:"far"}]},Survival:{Novice:[{description:"Basic tracking skills for following creatures and people.",requirements:{minLevel:1,requiredStats:{wisdom:12,intelligence:10}},effects:{special:["track","identify_creatures"]},staminaCost:1,range:"far"},{description:"Foraging ability to find food and water in the wilderness.",requirements:{minLevel:1,requiredStats:{wisdom:13,constitution:10}},effects:{special:["forage","identify_plants"]},staminaCost:2,range:"near"}],Adept:[{description:"Advanced wilderness navigation that prevents getting lost.",requirements:{minLevel:4,requiredStats:{wisdom:14,intelligence:12}},effects:{special:["never_lost","weather_prediction","shortcut_finding"]},staminaCost:2,range:"self"},{description:"Animal communication for basic interaction with beasts.",requirements:{minLevel:5,requiredStats:{wisdom:15,charisma:12}},effects:{special:["animal_speech","beast_friendship","mount_training"]},staminaCost:3,range:"near"}],Expert:[{description:"Master tracker who can follow days-old trails.",requirements:{minLevel:8,requiredStats:{wisdom:16,constitution:13}},effects:{special:["master_tracking","scent_trail","predict_movement"]},staminaCost:4,range:"far"}],Master:[{description:"Legendary survival skills that allow thriving in any environment.",requirements:{minLevel:12,requiredStats:{wisdom:18,constitution:16,intelligence:14}},effects:{special:["environmental_adaptation","weather_immunity","resource_mastery"]},staminaCost:6,range:"self"}],Legendary:[{description:"Mythical connection to nature that grants supernatural survival abilities.",requirements:{minLevel:16,requiredStats:{wisdom:20,constitution:18,charisma:16}},effects:{special:["nature_bond","elemental_resistance","wilderness_mastery"]},staminaCost:10,cooldown:8,range:"far"}]},Stealth:{Novice:[{description:"Basic stealth techniques for moving unseen.",requirements:{minLevel:1,requiredStats:{dexterity:12}},effects:{special:["hide","move_silently"]},staminaCost:2,range:"self"},{description:"Simple lockpicking for basic locks and traps.",requirements:{minLevel:2,requiredStats:{dexterity:13,intelligence:10}},effects:{special:["lockpick","disable_trap"]},staminaCost:1,range:"touch"}],Adept:[{description:"Advanced stealth that works even in broad daylight.",requirements:{minLevel:4,requiredStats:{dexterity:15,wisdom:12}},effects:{special:["invisibility","shadow_step","crowd_blend"]},staminaCost:4,range:"self"},{description:"Sneak attack that deals extra damage from hiding.",requirements:{minLevel:5,requiredStats:{dexterity:14,strength:11}},effects:{damage:{min:6,max:12,type:"piercing"},special:["sneak_attack"]},staminaCost:3,range:"touch"}],Expert:[{description:"Master infiltration techniques for bypassing security.",requirements:{minLevel:8,requiredStats:{dexterity:17,intelligence:14}},effects:{special:["master_infiltration","security_bypass","disguise"]},staminaCost:6,range:"self"}],Master:[{description:"Legendary stealth that approaches true invisibility.",requirements:{minLevel:12,requiredStats:{dexterity:19,wisdom:15,intelligence:14}},effects:{special:["perfect_stealth","phase_walk","memory_erase"]},staminaCost:10,cooldown:4,range:"self"}],Legendary:[{description:"Mythical assassination technique that can kill with a single touch.",requirements:{minLevel:17,requiredStats:{dexterity:20,wisdom:17,intelligence:16}},effects:{damage:{min:50,max:100,type:"death"},special:["death_strike","untraceable","shadow_mastery"]},staminaCost:20,cooldown:15,range:"touch"}]},Defense:{Novice:[{description:"Basic shield blocking technique.",requirements:{minLevel:1,requiredStats:{strength:11,constitution:10},requiredEquipment:["shield"]},effects:{special:["block","damage_reduction_2"]},staminaCost:1,range:"self"},{description:"Defensive stance that reduces incoming damage.",requirements:{minLevel:2,requiredStats:{constitution:12}},effects:{special:["defensive_stance","damage_reduction_3"]},staminaCost:2,range:"self"}],Adept:[{description:"Shield bash that can stun opponents while defending.",requirements:{minLevel:4,requiredStats:{strength:13,constitution:12},requiredEquipment:["shield"]},effects:{damage:{min:2,max:5,type:"bludgeoning"},special:["stun","knockback"]},staminaCost:3,range:"touch"},{description:"Armor expertise that improves protection effectiveness.",requirements:{minLevel:5,requiredStats:{constitution:14,intelligence:11}},effects:{special:["armor_mastery","damage_reduction_5"]},staminaCost:0,range:"self"}],Expert:[{description:"Perfect parry that reflects attacks back at enemies.",requirements:{minLevel:8,requiredStats:{dexterity:16,constitution:14}},effects:{special:["perfect_parry","reflect_damage","counter_attack"]},staminaCost:5,range:"self"}],Master:[{description:"Legendary defense that makes the user nearly invulnerable.",requirements:{minLevel:12,requiredStats:{constitution:18,strength:15,dexterity:15}},effects:{special:["legendary_defense","damage_immunity","aegis_aura"]},staminaCost:12,cooldown:6,range:"self"}],Legendary:[{description:"Mythical protection that extends to allies and can turn the tide of battle.",requirements:{minLevel:16,requiredStats:{constitution:20,strength:17,charisma:16}},effects:{special:["divine_protection","ally_immunity","battlefield_aegis"]},staminaCost:18,cooldown:12,range:"far"}]},Berserker:{Novice:[{description:"Basic rage that increases damage but reduces defense.",requirements:{minLevel:2,requiredStats:{strength:12,constitution:11}},effects:{buff:{stat:"damage",modifier:3},special:["rage","defense_penalty"]},staminaCost:3,range:"self"},{description:"Intimidating roar that frightens nearby enemies.",requirements:{minLevel:1,requiredStats:{strength:11,charisma:10}},effects:{special:["fear","intimidate","morale_damage"]},staminaCost:2,range:"near"}],Adept:[{description:"Berserker frenzy that allows multiple attacks.",requirements:{minLevel:5,requiredStats:{strength:14,constitution:13}},effects:{damage:{min:4,max:8},special:["frenzy","extra_attacks","pain_ignore"]},staminaCost:6,range:"self"},{description:"Unstoppable charge that breaks through enemy lines.",requirements:{minLevel:4,requiredStats:{strength:13,constitution:12}},effects:{damage:{min:6,max:10,type:"bludgeoning"},special:["charge","knockdown","breakthrough"]},staminaCost:4,range:"near"}],Expert:[{description:"Primal fury that grows stronger as health decreases.",requirements:{minLevel:8,requiredStats:{strength:16,constitution:15}},effects:{special:["primal_fury","escalating_rage","death_resistance"]},staminaCost:8,range:"self"}],Master:[{description:"Legendary berserker state that makes one nearly unstoppable.",requirements:{minLevel:12,requiredStats:{strength:18,constitution:17}},effects:{damage:{min:15,max:25},special:["legendary_rage","unstoppable","fear_immunity"]},staminaCost:15,cooldown:8,range:"self"}],Legendary:[{description:"Mythical warrior state that channels primal forces of destruction.",requirements:{minLevel:17,requiredStats:{strength:20,constitution:19}},effects:{damage:{min:25,max:40},special:["apocalyptic_rage","area_destruction","immortal_fury"]},staminaCost:25,cooldown:15,range:"far"}]}};class Ue{constructor(e){this.rng=void 0,this.rng=new Be(e)}generateSpell(e,t){const n=Ue.SPELL_TEMPLATES[e][t];if(!n||0===n.length)throw new Error("No templates found for ".concat(e," ").concat(t));const r=this.rng.pick(n);return s({name:this.generateSpellName(e,t),school:e,tier:t},r)}generateSpellName(e,t){const n=this.rng.pick({Cantrip:["Minor","Lesser","Simple","Basic","Apprentice"],Apprentice:["Improved","Enhanced","Refined","Focused","Practiced"],Adept:["Greater","Superior","Advanced","Powerful","Mastered"],Master:["Grand","Supreme","Ultimate","Perfect","Transcendent"],Archmage:["Divine","Cosmic","Reality","Omnipotent","Godlike"]}[t]),r=this.rng.pick({Evocation:["Bolt","Blast","Storm","Fury","Inferno","Lightning","Elemental Force"],Enchantment:["Blessing","Enhancement","Charm","Empowerment","Inspiration","Might"],Transmutation:["Transformation","Shaping","Alteration","Metamorphosis","Change","Form"],Divination:["Sight","Vision","Revelation","Knowledge","Truth","Perception","Awareness"],Conjuration:["Summoning","Creation","Manifestation","Portal","Gateway","Calling"],Necromancy:["Drain","Death","Decay","Soul","Undeath","Corruption","Life Steal"],Illusion:["Phantasm","Deception","Mirage","Dream","Shadow","Glamour","Trickery"],Abjuration:["Ward","Shield","Barrier","Protection","Defense","Sanctuary","Aegis"]}[e]);return"".concat(n," ").concat(r)}getAvailableSpells(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];const a=[];for(const i of Object.keys(Ue.SPELL_TEMPLATES))for(const o of Object.keys(Ue.SPELL_TEMPLATES[i])){const s=Ue.SPELL_TEMPLATES[i][o];for(const l of s){if(e<l.requirements.minLevel)continue;let s=!0;for(const[e,n]of Object.entries(l.requirements.requiredStats||{}))if((t[e]||0)<n){s=!1;break}if(!s)continue;if(l.requirements.requiredComponents){if(!l.requirements.requiredComponents.every(e=>n.some(t=>t.toLowerCase().includes(e.toLowerCase()))))continue}if(l.requirements.prerequisiteSpells){if(!l.requirements.prerequisiteSpells.every(e=>r.includes(e)))continue}const c=this.generateSpell(i,o);a.push(c)}}return a}generateSpellScroll(e){const t=e>=9?"Archmage":e>=7?"Master":e>=5?"Adept":e>=3?"Apprentice":"Cantrip",n=Object.keys(Ue.SPELL_TEMPLATES),r=this.rng.pick(n),a=this.generateSpellName(r,t);return{name:"".concat(a," Scroll"),description:"A magical scroll containing the ".concat(a," spell from the ").concat(r," school of magic.")}}}Ue.SPELL_TEMPLATES={Evocation:{Cantrip:[{description:"A small spark of flame that can light candles or deal minor damage.",requirements:{minLevel:1,requiredStats:{intelligence:10}},effects:{damage:{min:1,max:3,type:"fire"}},etherCost:1,range:"near"},{description:"A minor jolt of electricity that can shock enemies or power devices.",requirements:{minLevel:1,requiredStats:{intelligence:11}},effects:{damage:{min:1,max:4,type:"lightning"}},etherCost:1,range:"touch"}],Apprentice:[{description:"A bolt of searing flame that burns enemies.",requirements:{minLevel:3,requiredStats:{intelligence:13}},effects:{damage:{min:4,max:8,type:"fire"}},etherCost:3,range:"far"},{description:"Shards of ice that pierce through armor.",requirements:{minLevel:3,requiredStats:{intelligence:12,wisdom:11}},effects:{damage:{min:3,max:7,type:"ice"},special:["armor_pierce"]},etherCost:3,range:"far"}],Adept:[{description:"A devastating explosion of elemental energy.",requirements:{minLevel:6,requiredStats:{intelligence:15}},effects:{damage:{min:8,max:15,type:"elemental"},special:["area_effect"]},etherCost:6,range:"far"}],Master:[{description:"A storm of pure elemental fury that devastates the battlefield.",requirements:{minLevel:10,requiredStats:{intelligence:17,wisdom:14}},effects:{damage:{min:15,max:25,type:"elemental"},special:["area_effect","multi_element"]},etherCost:12,range:"sight"}],Archmage:[{description:"The ultimate expression of destructive magic, reshaping reality itself.",requirements:{minLevel:15,requiredStats:{intelligence:20,wisdom:16}},effects:{damage:{min:25,max:40,type:"reality"},special:["reality_warp","unstoppable"]},etherCost:20,range:"sight"}]},Enchantment:{Cantrip:[{description:"Enhances the caster's natural abilities temporarily.",requirements:{minLevel:1,requiredStats:{charisma:11}},effects:{buff:{stat:"all_stats",modifier:1,duration:10}},etherCost:1,range:"self"}],Apprentice:[{description:"Grants supernatural strength to the target.",requirements:{minLevel:3,requiredStats:{charisma:13,intelligence:11}},effects:{buff:{stat:"strength",modifier:3,duration:30}},etherCost:3,range:"touch"},{description:"Enhances the target's reflexes and agility.",requirements:{minLevel:3,requiredStats:{charisma:12,dexterity:12}},effects:{buff:{stat:"dexterity",modifier:3,duration:30}},etherCost:3,range:"touch"}],Adept:[{description:"Provides comprehensive enhancement to all physical capabilities.",requirements:{minLevel:6,requiredStats:{charisma:15,intelligence:13}},effects:{buff:{stat:"all_stats",modifier:2,duration:60}},etherCost:6,range:"near"}],Master:[{description:"Grants legendary abilities that transcend normal limitations.",requirements:{minLevel:10,requiredStats:{charisma:17,intelligence:15}},effects:{special:["legendary_enhancement","stat_transcendence"]},etherCost:12,duration:120,range:"near"}],Archmage:[{description:"Elevates the target to godlike levels of capability.",requirements:{minLevel:15,requiredStats:{charisma:20,intelligence:18}},effects:{special:["divine_enhancement","reality_transcendence"]},etherCost:20,duration:180,range:"sight"}]},Transmutation:{Cantrip:[{description:"Changes the basic properties of small objects.",requirements:{minLevel:1,requiredStats:{intelligence:12}},effects:{special:["minor_transmutation"]},etherCost:1,range:"touch"}],Apprentice:[{description:"Transforms basic materials into more valuable substances.",requirements:{minLevel:4,requiredStats:{intelligence:14,wisdom:12}},effects:{special:["material_transformation"]},etherCost:4,range:"touch"}],Adept:[{description:"Alters the fundamental structure of objects and beings.",requirements:{minLevel:7,requiredStats:{intelligence:16,wisdom:14}},effects:{special:["structural_alteration","living_transmutation"]},etherCost:7,range:"near"}],Master:[{description:"Completely reshapes matter according to the caster's will.",requirements:{minLevel:11,requiredStats:{intelligence:18,wisdom:16}},effects:{special:["matter_mastery","form_transcendence"]},etherCost:15,range:"far"}],Archmage:[{description:"Controls the fundamental forces that shape reality itself.",requirements:{minLevel:16,requiredStats:{intelligence:20,wisdom:19}},effects:{special:["reality_shaping","universal_transmutation"]},etherCost:25,range:"sight"}]},Divination:{Cantrip:[{description:"Reveals basic information about objects and creatures.",requirements:{minLevel:1,requiredStats:{wisdom:12}},effects:{special:["basic_detection"]},etherCost:1,range:"near"}],Apprentice:[{description:"Senses the presence of hidden things and creatures.",requirements:{minLevel:3,requiredStats:{wisdom:14,intelligence:11}},effects:{special:["true_sight","hidden_detection"]},etherCost:3,range:"far"}],Adept:[{description:"Peer into the past and future to gain knowledge.",requirements:{minLevel:6,requiredStats:{wisdom:16,intelligence:13}},effects:{special:["temporal_sight","knowledge_revelation"]},etherCost:6,range:"sight"}],Master:[{description:"Comprehends the deepest mysteries of existence.",requirements:{minLevel:10,requiredStats:{wisdom:18,intelligence:16}},effects:{special:["cosmic_awareness","universal_knowledge"]},etherCost:12,range:"sight"}],Archmage:[{description:"Achieves perfect understanding of all things across all realities.",requirements:{minLevel:15,requiredStats:{wisdom:20,intelligence:19}},effects:{special:["omniscience","reality_comprehension"]},etherCost:20,range:"sight"}]},Conjuration:{Cantrip:[{description:"Creates small objects from thin air.",requirements:{minLevel:1,requiredStats:{intelligence:11,charisma:10}},effects:{special:["minor_creation"]},etherCost:1,range:"near"}],Apprentice:[{description:"Summons helpful creatures to aid in battle.",requirements:{minLevel:3,requiredStats:{intelligence:13,charisma:12}},effects:{special:["summon_ally"]},etherCost:4,range:"near",duration:60}],Adept:[{description:"Opens portals to distant locations for rapid travel.",requirements:{minLevel:6,requiredStats:{intelligence:15,wisdom:13}},effects:{special:["teleportation","portal_creation"]},etherCost:8,range:"sight"}],Master:[{description:"Brings forth powerful entities from other planes.",requirements:{minLevel:10,requiredStats:{intelligence:17,charisma:16}},effects:{special:["planar_summoning","entity_binding"]},etherCost:15,range:"far",duration:120}],Archmage:[{description:"Commands the fundamental forces of creation itself.",requirements:{minLevel:15,requiredStats:{intelligence:19,charisma:18,wisdom:16}},effects:{special:["cosmic_creation","reality_summoning"]},etherCost:25,range:"sight",duration:240}]},Necromancy:{Cantrip:[{description:"Drains a small amount of life force from enemies.",requirements:{minLevel:1,requiredStats:{intelligence:11,constitution:10}},effects:{damage:{min:1,max:2,type:"necrotic"},healing:{min:1,max:2}},etherCost:1,range:"touch"}],Apprentice:[{description:"Animate the dead to serve as temporary minions.",requirements:{minLevel:4,requiredStats:{intelligence:13,constitution:12}},effects:{special:["animate_dead"]},etherCost:5,range:"near",duration:60}],Adept:[{description:"Steal years of life from enemies to extend your own.",requirements:{minLevel:7,requiredStats:{intelligence:15,constitution:14}},effects:{damage:{min:8,max:12,type:"life_drain"},healing:{min:4,max:6}},etherCost:8,range:"far"}],Master:[{description:"Command over death itself, raising powerful undead servants.",requirements:{minLevel:11,requiredStats:{intelligence:17,constitution:16}},effects:{special:["death_mastery","undead_legion"]},etherCost:15,range:"far",duration:240}],Archmage:[{description:"Transcend the boundary between life and death.",requirements:{minLevel:16,requiredStats:{intelligence:19,constitution:18}},effects:{special:["lichdom","death_transcendence","soul_mastery"]},etherCost:30,range:"sight"}]},Illusion:{Cantrip:[{description:"Create minor visual or auditory illusions.",requirements:{minLevel:1,requiredStats:{intelligence:10,charisma:11}},effects:{special:["minor_illusion"]},etherCost:1,range:"near"}],Apprentice:[{description:"Become invisible to most forms of detection.",requirements:{minLevel:3,requiredStats:{intelligence:12,dexterity:13}},effects:{special:["invisibility"]},etherCost:4,range:"self",duration:30}],Adept:[{description:"Create complex illusions that can fool multiple senses.",requirements:{minLevel:6,requiredStats:{intelligence:15,charisma:14}},effects:{special:["complex_illusion","mass_deception"]},etherCost:7,range:"far",duration:60}],Master:[{description:"Bend reality to create illusions indistinguishable from truth.",requirements:{minLevel:10,requiredStats:{intelligence:17,charisma:16,wisdom:14}},effects:{special:["reality_illusion","truth_deception"]},etherCost:12,range:"sight",duration:120}],Archmage:[{description:"Make illusions so perfect they become reality.",requirements:{minLevel:15,requiredStats:{intelligence:19,charisma:18,wisdom:17}},effects:{special:["illusion_reality","dream_manifestation"]},etherCost:20,range:"sight",duration:300}]},Abjuration:{Cantrip:[{description:"Creates a small protective barrier against harm.",requirements:{minLevel:1,requiredStats:{wisdom:11,constitution:10}},effects:{special:["minor_protection"]},etherCost:1,range:"self",duration:10}],Apprentice:[{description:"Dispels hostile magical effects and enchantments.",requirements:{minLevel:3,requiredStats:{wisdom:13,intelligence:11}},effects:{special:["dispel_magic"]},etherCost:3,range:"near"}],Adept:[{description:"Creates powerful wards that protect against multiple threats.",requirements:{minLevel:6,requiredStats:{wisdom:15,constitution:13}},effects:{special:["greater_ward","multi_protection"]},etherCost:6,range:"near",duration:120}],Master:[{description:"Establishes ultimate magical defenses that repel all harm.",requirements:{minLevel:10,requiredStats:{wisdom:17,constitution:16,intelligence:14}},effects:{special:["absolute_protection","harm_immunity"]},etherCost:12,range:"far",duration:180}],Archmage:[{description:"Becomes untouchable by mortal means through perfect magical defense.",requirements:{minLevel:15,requiredStats:{wisdom:20,constitution:18,intelligence:17}},effects:{special:["divine_protection","reality_shield"]},etherCost:20,range:"sight",duration:360}]}};class Ge{constructor(e,t,n,r,a){this.noise=void 0,this.rng=void 0,this.physicalAbilities=void 0,this.magicalSpells=void 0,this.chokepoints=new Map,this.regions=[],this.mapWidth=void 0,this.mapHeight=void 0,this.startX=void 0,this.startY=void 0;try{console.log("Initializing ChokepointManager with:",{seed:e,mapWidth:t,mapHeight:n,startX:r,startY:a}),this.noise=new Fe(e),this.rng=new Be("".concat(e,"_chokepoints")),this.physicalAbilities=new qe("".concat(e,"_abilities")),this.magicalSpells=new Ue("".concat(e,"_spells")),this.mapWidth=t,this.mapHeight=n,this.startX=r,this.startY=a,console.log("Generating regions..."),this.generateRegions(),console.log("Identifying chokepoints..."),this.identifyChokepoints(),console.log("Placing fortifications..."),this.placeFortifications(),console.log("ChokepointManager initialized with ".concat(this.regions.length," regions and ").concat(this.chokepoints.size," chokepoints"))}catch(i){console.error("Error in ChokepointManager constructor:",i),this.noise=new Fe(e),this.rng=new Be("".concat(e,"_chokepoints")),this.mapWidth=t,this.mapHeight=n,this.startX=r,this.startY=a,this.regions=[],this.chokepoints=new Map}}generateRegions(){try{this.rng.nextInt(6,12);const t=Math.min(this.mapWidth,this.mapHeight)/4;this.regions.push({centerX:this.startX,centerY:this.startY,radius:.6*t,difficultyLevel:1,biomePreference:["Grass","Forest","Coast"],name:"The Heartlands",description:"Peaceful starting region with friendly settlements and basic resources."});const n=[{distance:1.2*t,level:2,count:3},{distance:1.8*t,level:4,count:4},{distance:2.5*t,level:6,count:3},{distance:3.2*t,level:8,count:2}];for(const r of n)for(let n=0;n<r.count;n++)try{const e=2*Math.PI*n/r.count+this.rng.nextFloat(-.3,.3),a=r.distance*this.rng.nextFloat(.8,1.2),i=this.startX+Math.cos(e)*a,o=this.startY+Math.sin(e)*a,s=100,l=Math.max(s,Math.min(this.mapWidth-s,i)),c=Math.max(s,Math.min(this.mapHeight-s,o));this.regions.push({centerX:l,centerY:c,radius:.4*t,difficultyLevel:r.level,biomePreference:this.getBiomesForDifficulty(r.level),name:this.generateRegionName(r.level),description:this.generateRegionDescription(r.level)})}catch(e){console.warn("Error generating region in ring:",r,e)}console.log("Generated ".concat(this.regions.length," regions"))}catch(e){console.error("Error in generateRegions:",e),0===this.regions.length&&this.regions.push({centerX:this.startX,centerY:this.startY,radius:500,difficultyLevel:1,biomePreference:["Grass","Forest"],name:"The Starting Lands",description:"A safe region for new adventurers."})}}getBiomesForDifficulty(e){return e<=2?["Grass","Forest","Coast","Savanna"]:e<=4?["Forest","Taiga","Swamp","Mountain"]:e<=6?["Mountain","Desert","Tundra","Jungle"]:["Mountain","Snow","Desert","Tundra"]}generateRegionName(e){const t={2:["The Borderlands","Merchant's Rest","The Greenwood","Pilgrim's Path"],4:["The Wildlands","Thornmarch","The Disputed Lands","Ravenwood"],6:["The Bleaklands","Dragonspine Mountains","The Cursed Marsh","Doomheath"],8:["The Shattered Realms","The Bone Wastes","Hellfire Peaks","The Dread Expanse"],10:["The Void Touched","World's End","The Final Dark","Apocalypse Gate"]},n=t[e]||t[8];return this.rng.pick(n)}generateRegionDescription(e){const t={2:"A frontier region with scattered settlements and minor dangers.",4:"Dangerous wilderness requiring caution and proper preparation.",6:"Hostile territory where only experienced adventurers survive.",8:"A realm of nightmares where death lurks behind every shadow.",10:"The ultimate challenge - where legends are born or die."};return t[e]||t[8]}identifyChokepoints(){try{console.log("Starting chokepoint identification...");let t=0;for(let n=0;n<this.regions.length;n++)for(let r=n+1;r<this.regions.length;r++)try{const e=this.regions[n],a=this.regions[r],i=Math.abs(e.difficultyLevel-a.difficultyLevel);if(i<=1&&i>0){t+=this.findChokepointsBetweenRegions(e,a)}}catch(e){console.warn("Error finding chokepoints between regions:",n,r,e)}console.log("Found ".concat(t," chokepoints between ").concat(this.regions.length," regions"))}catch(e){console.error("Error in identifyChokepoints:",e)}}findChokepointsBetweenRegions(e,t){try{const r=t.centerX-e.centerX,a=t.centerY-e.centerY,i=Math.sqrt(r*r+a*a),o=Math.max(5,Math.min(20,Math.floor(i/20)));let s=0;for(let l=1;l<o;l++)try{const n=l/o,i=Math.floor(e.centerX+r*n),c=Math.floor(e.centerY+a*n);if(i>=0&&i<this.mapWidth&&c>=0&&c<this.mapHeight&&this.isNaturalChokepoint(i,c)){const e=this.determineChokepointType(i,c),n={x:i,y:c,type:e,width:this.calculateChokepointWidth(i,c,e),fortified:!1,controlsAccess:[t.name],fortification:void 0};this.chokepoints.set("".concat(i,",").concat(c),n),s++}}catch(n){console.warn("Error processing chokepoint sample:",l,n)}return s}catch(n){return console.error("Error in findChokepointsBetweenRegions:",n),0}}isNaturalChokepoint(e,t){try{const n=this.noise.getElevation(e,t),r=this.noise.getMoisture(e,t,n);if(isNaN(n)||isNaN(r))return!1;const a=[];for(let o=-3;o<=3;o++)for(let n=-3;n<=3;n++){if(0===o&&0===n)continue;const r=e+o,i=t+n;if(r>=0&&r<this.mapWidth&&i>=0&&i<this.mapHeight){const e=this.noise.getElevation(r,i);isNaN(e)||a.push(e)}}if(0===a.length)return!1;const i=a.reduce((e,t)=>e+t,0)/a.length;if(n>.6&&i<n-.2)return!0;if(n>.35&&n<.5&&r>.7){const n=Math.abs(this.getElevationSafe(e-2,t)-this.getElevationSafe(e+2,t)),r=Math.abs(this.getElevationSafe(e,t-2)-this.getElevationSafe(e,t+2));if(Math.max(n,r)>.1)return!0}if(n>.32&&n<.42){let n=0;for(let r=-2;r<=2;r++)for(let a=-2;a<=2;a++)this.getElevationSafe(e+r,t+a)<.35&&n++;if(n>15)return!0}return!1}catch(n){return console.warn("Error checking natural chokepoint at",e,t,":",n),!1}}getElevationSafe(e,t){if(e<0||e>=this.mapWidth||t<0||t>=this.mapHeight)return.5;try{return this.noise.getElevation(e,t)}catch(n){return.5}}determineChokepointType(e,t){const n=this.noise.getElevation(e,t),r=this.noise.getMoisture(e,t,n);return n>.6?"pass":n<.4&&r>.7?"bridge":n<.42?"strait":n>.5&&r<.3?"canyon":this.rng.pick(["bridge","pass","canyon"])}calculateChokepointWidth(e,t,n){return{bridge:2,pass:4,strait:3,canyon:3,tunnel:2,gate:5}[n]+this.rng.nextInt(-1,2)}placeFortifications(){try{console.log("Starting fortification placement...");const t=Array.from(this.chokepoints.values()).sort((e,t)=>this.getDistanceFromStart(e.x,e.y)-this.getDistanceFromStart(t.x,t.y));let n=0;const r=Math.min(8,t.length);for(const a of t){if(n>=r)break;try{const e=this.getDistanceFromStart(a.x,a.y);if(this.shouldPlaceFortification(a,e)){const t=this.calculateFortificationDifficulty(e);a.fortified=!0,a.fortification=this.createFortification(a,t),n++}}catch(e){console.warn("Error placing fortification at chokepoint:",a,e)}}console.log("Placed ".concat(n," fortifications out of ").concat(t.length," chokepoints"))}catch(e){console.error("Error in placeFortifications:",e)}}getDistanceFromStart(e,t){const n=e-this.startX,r=t-this.startY;return Math.sqrt(n*n+r*r)}shouldPlaceFortification(e,t){if(t<Math.min(this.mapWidth,this.mapHeight)/8)return!1;if(e.width<=2)return!0;const n=this.calculateStrategicValue(e);return this.rng.nextFloat()<n}calculateStrategicValue(e){let t=.3;return t+=.1*(5-e.width),"pass"!==e.type&&"bridge"!==e.type||(t+=.3),t+=.2*e.controlsAccess.length,Math.min(.9,t)}calculateFortificationDifficulty(e){const t=e/(Math.sqrt(this.mapWidth*this.mapWidth+this.mapHeight*this.mapHeight)/2);return Math.max(1,Math.min(10,Math.floor(8*t)+1))}createFortification(e,t){const n=t>=8?"citadel":t>=6?"keep":t>=4?"wall":t>=2?"watchtower":"barricade",r=this.generateFortificationNames(n,t),a=this.rng.pick(r);return{name:a,level:t,type:n,garrison:10*t+this.rng.nextInt(5,15),requiredLevel:Math.max(1,t-1),requiredGear:this.getRequiredGear(e,t),rewards:this.generateRewards(t),cleared:!1,description:this.generateFortificationDescription(a,n,e)}}generateFortificationNames(e,t){const n=t>=6?["Dread","Death","Shadow","Doom","Blood","Iron","Dark"]:["Stone","Iron","Grey","Old","High","White","Red"],r={keep:["Keep","Hold","Fort","Stronghold"],watchtower:["Tower","Spire","Watch","Beacon"],wall:["Wall","Gate","Barrier","Passage"],barricade:["Barricade","Block","Obstruction"],outpost:["Outpost","Station","Checkpoint"],citadel:["Citadel","Fortress","Bastion","Stronghold"]}[e],a=[];for(const i of n.slice(0,3))for(const e of r)a.push("".concat(i," ").concat(e));return a}getRequiredGear(e,t){const n=[];return"bridge"!==e.type&&"strait"!==e.type||(t>=3&&n.push("rope"),t>=5&&n.push("boat")),"pass"!==e.type&&"canyon"!==e.type||(t>=2&&n.push("climbing_gear"),t>=6&&n.push("cold_weather_gear")),t>=4&&n.push("siege_equipment"),t>=7&&n.push("magical_weapons"),n}generateRewards(e){const t=[];if(t.push({type:"gold",name:"Garrison Treasury",value:100*e+this.rng.nextInt(50,150),description:"Gold looted from the defeated garrison."}),e>=3&&t.push({type:"equipment",name:this.generateEquipmentName(e),value:e,description:"High-quality equipment from the fortress armory."}),e>=5){const n=this.magicalSpells.generateSpellScroll(e);t.push({type:"spell",name:n.name,value:e,description:n.description})}if(e>=4){const n=this.physicalAbilities.generateAbilityScroll(e);t.push({type:"spell",name:n.name,value:e,description:n.description})}return e>=4&&t.push({type:"key",name:"Key to the ".concat(this.rng.pick(["Eastern","Northern","Western","Southern"])," Passage"),value:1,description:"Opens access to previously blocked routes."}),t}generateEquipmentName(e){const t=e>=6?["Legendary","Mythic","Divine","Runic"]:["Fine","Masterwork","Enchanted","Superior"];return"".concat(this.rng.pick(t)," ").concat(this.rng.pick(["Sword","Shield","Armor","Bow","Staff","Hammer","Axe"]))}generateSpellName(e){return"".concat(e>=8?"Greater":e>=6?"Major":"Lesser"," ").concat(this.rng.pick(["Fireball","Lightning Bolt","Ice Storm","Healing","Barrier","Teleport"]))}generateFortificationDescription(e,t,n){return"".concat({keep:"A massive stone fortress",watchtower:"A tall defensive tower",wall:"A fortified wall with iron gates",barricade:"A sturdy wooden barrier",outpost:"A military checkpoint",citadel:"An impregnable fortress complex"}[t]," ").concat({bridge:"guarding the only safe river crossing",pass:"controlling the mountain pass",strait:"watching over the narrow strait",canyon:"blocking the canyon passage",tunnel:"sealing the underground route",gate:"barring the ancient gateway"}[n.type],". The ").concat(e," has stood for centuries, its garrison ensuring that only the worthy may pass.")}getChokepoints(){return Array.from(this.chokepoints.values())}getChokepointAt(e,t){return this.chokepoints.get("".concat(e,",").concat(t))}getRegions(){return this.regions}getRegionAt(e,t){for(const n of this.regions){const r=e-n.centerX,a=t-n.centerY;if(Math.sqrt(r*r+a*a)<=n.radius)return n}}isRouteBlocked(e,t,n,r){const a=[],i=n-e,o=r-t,s=Math.sqrt(i*i+o*o),l=Math.floor(s);for(let d=0;d<=l;d++){var c;const n=d/l,r=Math.floor(e+i*n),s=Math.floor(t+o*n),u=this.getChokepointAt(r,s);null===u||void 0===u||!u.fortified||null!==(c=u.fortification)&&void 0!==c&&c.cleared||a.push(u)}return a}clearFortification(e,t){const n=this.getChokepointAt(e,t);return!(null===n||void 0===n||!n.fortification||n.fortification.cleared)&&(n.fortification.cleared=!0,!0)}}class Ve{constructor(e,t){this.chunkManager=void 0,this.chokepointManager=null,this.physicalAbilities=void 0,this.magicalSpells=void 0,this.rng=void 0,this.state=void 0,this.loadedFromSave=!1;const n=localStorage.getItem("world-engine-save");if(n)try{console.log("Found existing save, loading from localStorage...");if(this.loadFromStorage(n))return console.log("Successfully loaded existing game!"),void(this.loadedFromSave=!0)}catch(r){console.warn("Failed to load existing save, creating new game:",r),localStorage.removeItem("world-engine-save")}console.log("Creating new game..."),this.loadedFromSave=!1,this.createNewGame(e,t)}createNewGame(e,t){const n=e||this.generateSeed();this.rng=new Be("".concat(n,"_engine"));const r={movementCostPerTile:15,encounterBaseChance:.15,weatherChangeDays:3,fogOfWarRadius:8,chunkLoadRadius:32,chunkUnloadRadius:64},a={world:s(s({},{seaLevel:0,continentFreq:1/1024,featureFreq:1/128,warpStrength:700,mapWidth:2048,mapHeight:2048}),null===t||void 0===t?void 0:t.world),gameplay:s(s({},r),null===t||void 0===t?void 0:t.gameplay)};this.chunkManager=new He(n,a.world),this.physicalAbilities=new qe(n),this.magicalSpells=new Ue(n);try{console.log("Initializing chokepoint system..."),this.chokepointManager=new Ge(n,a.world.mapWidth,a.world.mapHeight,a.world.mapWidth/2,a.world.mapHeight/2),console.log("Chokepoint system initialized successfully")}catch(c){console.error("Failed to initialize chokepoint system:",c),this.chokepointManager=null}const i=this.findLandSpawnLocation(a.world.mapWidth,a.world.mapHeight,a.world.seaLevel),o=this.chunkManager.getTile(i.x,i.y),l=!o||"Ocean"===o.biome;console.log("Final spawn location:",i.x,i.y),console.log("Spawn tile biome:",(null===o||void 0===o?void 0:o.biome)||"null"),console.log("Needs boat:",l||i.needsBoat),this.state={seed:n,party:{x:i.x,y:i.y,members:[],supplies:{food:100,water:100,gold:50},equipment:l||i.needsBoat?["boat"]:[],speed:1,hitPoints:100,maxHitPoints:100,level:1,experience:0,knownAbilities:[],knownSpells:[],stats:{strength:12,dexterity:12,constitution:12,intelligence:12,wisdom:12,charisma:12},stamina:20,maxStamina:20,ether:15,maxEther:15},characters:[],time:{minutes:480,day:1,season:"Spring",year:1},weather:this.generateWeather(i.x,i.y,n,1),encounterClock:{riskLevel:0,lastEncounter:0,encounterChance:a.gameplay.encounterBaseChance},activeEncounter:null,completedEncounters:new Set,discovered:new Set,config:a,version:"1.0.0"},this.discoverRadius(this.state.party.x,this.state.party.y,3),this.createMainCity(this.state.party.x,this.state.party.y),this.autoSave()}loadFromStorage(e){try{const n=JSON.parse(e);this.chunkManager=new He(n.seed,n.config.world),this.physicalAbilities=new qe(n.seed),this.magicalSpells=new Ue(n.seed),this.rng=new Be("".concat(n.seed,"_engine"));try{this.chokepointManager=new Ge(n.seed,n.config.world.mapWidth,n.config.world.mapHeight,n.config.world.mapWidth/2,n.config.world.mapHeight/2)}catch(t){console.error("Failed to recreate chokepoint manager during load:",t),this.chokepointManager=null}return this.state=s(s({},n),{},{discovered:new Set(n.discovered)}),console.log("Game loaded successfully! Seed: ".concat(this.state.seed,", Characters: ").concat(this.state.characters.length)),!0}catch(t){return console.error("Failed to load game state:",t),!1}}autoSave(){try{const e=this.save();localStorage.setItem("world-engine-save",e),console.log("Game auto-saved to localStorage")}catch(e){console.error("Failed to auto-save game:",e)}}findLandSpawnLocation(e,t,n){console.log("Finding suitable spawn location...");const r=[{x:Math.floor(.25*e),y:Math.floor(.25*t)},{x:Math.floor(.75*e),y:Math.floor(.75*t)},{x:Math.floor(.25*e),y:Math.floor(.75*t)},{x:Math.floor(.75*e),y:Math.floor(.25*t)},{x:Math.floor(.4*e),y:Math.floor(.3*t)},{x:Math.floor(.6*e),y:Math.floor(.7*t)},{x:Math.floor(.3*e),y:Math.floor(.6*e)},{x:Math.floor(.7*e),y:Math.floor(.4*e)},{x:Math.floor(.5*e),y:Math.floor(.3*t)},{x:Math.floor(.3*e),y:Math.floor(.5*t)}];console.log("Trying strategic land candidates with sea level",n,"...");for(const i of r){console.log("Testing candidate:",i.x,i.y),this.chunkManager.ensureRadius(i.x,i.y,3);const e=this.chunkManager.getTile(i.x,i.y);if(console.log("Candidate tile details:"),console.log("  Position:",i.x,i.y),console.log("  Biome:",(null===e||void 0===e?void 0:e.biome)||"null"),console.log("  Elevation:",(null===e||void 0===e?void 0:e.elevation)||"null"),console.log("  Temperature:",(null===e||void 0===e?void 0:e.temperature)||"null"),console.log("  Moisture:",(null===e||void 0===e?void 0:e.moisture)||"null"),console.log("  Sea level config:",n),e&&"Ocean"!==e.biome)return console.log("\u2713 Found land spawn at:",i.x,i.y,"Biome:",e.biome),{x:i.x,y:i.y,needsBoat:!1}}const a=r[0];return console.log("All land searches failed, spawning with boat at:",a.x,a.y),{x:a.x,y:a.y,needsBoat:!0}}generateSeed(){return Math.random().toString(36).substring(2,15)}tickTravel(e,t){const n=Math.round(this.state.party.x+e),r=Math.round(this.state.party.y+t);if(n<0||n>=this.state.config.world.mapWidth||r<0||r>=this.state.config.world.mapHeight)return!1;const a=this.chunkManager.getTile(n,r);if(!a)return!1;if("Ocean"===a.biome&&!this.hasBoat())return!1;const i=this.state.config.gameplay.movementCostPerTile,o=this.getTerrainMovementModifier(a),s=this.state.weather.movementModifier,l=Math.round(i*o*s/this.state.party.speed);return this.state.party.x=n,this.state.party.y=r,this.advanceTime(l),this.discoverRadius(n,r,this.state.config.gameplay.fogOfWarRadius),this.ensureRadius(this.state.config.gameplay.chunkLoadRadius),this.updateEncounterRisk(a,l),this.checkForEncounter(a),this.updateWeather(),this.autoSave(),!0}hasBoat(){return this.state.party.equipment.includes("boat")||this.state.party.equipment.includes("ship")}getTerrainMovementModifier(e){let t={Ocean:.3,Coast:.8,Grass:1,Forest:.7,Jungle:.5,Savanna:1.1,Desert:.6,Taiga:.8,Tundra:.7,Swamp:.4,Mountain:.3,Snow:.5}[e.biome]||1;return e.road&&(t*=1.5),e.river&&!e.road&&(t*=.8),t}advanceTime(e){for(this.state.time.minutes+=e;this.state.time.minutes>=1440;)if(this.state.time.minutes-=1440,this.state.time.day++,this.state.time.day>90){this.state.time.day=1;const e=["Spring","Summer","Autumn","Winter"],t=e.indexOf(this.state.time.season);3===t?(this.state.time.season="Spring",this.state.time.year++):this.state.time.season=e[t+1]}}discoverRadius(e,t,n){const r=this.state.weather.visibility,a=Math.floor(n*r);for(let i=-a;i<=a;i++)for(let n=-a;n<=a;n++){if(Math.sqrt(i*i+n*n)<=a){const r=e+i,a=t+n;r>=0&&r<this.state.config.world.mapWidth&&a>=0&&a<this.state.config.world.mapHeight&&this.state.discovered.add("".concat(r,",").concat(a))}}}ensureRadius(e){this.chunkManager.ensureRadius(this.state.party.x,this.state.party.y,e),this.chunkManager.unloadBeyond(this.state.party.x,this.state.party.y,this.state.config.gameplay.chunkUnloadRadius)}updateEncounterRisk(e,t){let n=t/60*.02*({Ocean:.2,Coast:.5,Grass:1,Forest:1.3,Jungle:1.5,Savanna:1.1,Desert:.8,Taiga:1.2,Tundra:.7,Swamp:1.4,Mountain:1.6,Snow:.6}[e.biome]||1);e.road&&(n*=.5),e.settlement&&(n=0),this.state.encounterClock.riskLevel=Math.min(1,this.state.encounterClock.riskLevel+n)}generateWeather(e,t,n,r){var a,i,o,l,c,d,u,h,p,g,f;const m=null!==(a=null!==e&&void 0!==e?e:null===(i=this.state)||void 0===i||null===(o=i.party)||void 0===o?void 0:o.x)&&void 0!==a?a:1024,y=null!==(l=null!==t&&void 0!==t?t:null===(c=this.state)||void 0===c||null===(d=c.party)||void 0===d?void 0:d.y)&&void 0!==l?l:1024,v=null!==(u=null!==n&&void 0!==n?n:null===(h=this.state)||void 0===h?void 0:h.seed)&&void 0!==u?u:"default",b=null!==(p=null!==r&&void 0!==r?r:null===(g=this.state)||void 0===g||null===(f=g.time)||void 0===f?void 0:f.day)&&void 0!==p?p:1,x=this.chunkManager.getTile(m,y);if(!x)return{type:"Clear",intensity:0,duration:480,visibility:1,movementModifier:1};const w=new Be("".concat(v,"_weather_").concat(b)),S=this.getBiomeWeatherChances(x.biome),k=w.nextFloat();let C="Clear",j=0;for(const[s,E]of Object.entries(S))if(j+=E,k<=j){C=s;break}const T=w.nextFloat(.3,1);return s({type:C,intensity:T,duration:w.nextInt(240,720)},this.getWeatherEffects(C,T))}getBiomeWeatherChances(e){const t={Ocean:{Clear:.5,Rain:.3,Storm:.1,Wind:.1},Coast:{Clear:.6,Rain:.25,Wind:.1,Fog:.05},Grass:{Clear:.7,Rain:.2,Wind:.1},Forest:{Clear:.6,Rain:.3,Fog:.1},Jungle:{Clear:.4,Rain:.5,Storm:.1},Desert:{Clear:.8,Wind:.15,Storm:.05},Mountain:{Clear:.5,Snow:.2,Wind:.2,Storm:.1},Snow:{Clear:.4,Snow:.4,Wind:.2},Tundra:{Clear:.5,Snow:.3,Wind:.2},Taiga:{Clear:.6,Snow:.2,Rain:.1,Wind:.1},Swamp:{Clear:.4,Rain:.3,Fog:.3},Savanna:{Clear:.7,Rain:.2,Wind:.1}};return t[e]||t.Grass}getWeatherEffects(e,t){const n={Clear:{visibility:1,movementModifier:1},Rain:{visibility:.8,movementModifier:.8},Snow:{visibility:.6,movementModifier:.6},Fog:{visibility:.3,movementModifier:.9},Wind:{visibility:1,movementModifier:.9},Storm:{visibility:.4,movementModifier:.5}}[e];return{visibility:Math.max(.1,n.visibility-.2*(1-t)),movementModifier:Math.max(.3,n.movementModifier-.2*(t-.5))}}updateWeather(){this.state.weather.duration--,this.state.weather.duration<=0&&(this.state.weather=this.generateWeather())}rest(e){this.advanceTime(60*e),this.state.encounterClock.riskLevel=Math.max(0,this.state.encounterClock.riskLevel-.3);const t=10*e;this.state.party.hitPoints=Math.min(this.state.party.maxHitPoints,this.state.party.hitPoints+t);const n=5*e;this.state.party.stamina=Math.min(this.state.party.maxStamina,this.state.party.stamina+n);const r=3*e;this.state.party.ether=Math.min(this.state.party.maxEther,this.state.party.ether+r);for(let a=0;a<e;a++)this.updateWeather()}takeDamage(e){return this.state.party.hitPoints=Math.max(0,this.state.party.hitPoints-e),this.state.party.hitPoints>0}heal(e){this.state.party.hitPoints=Math.min(this.state.party.maxHitPoints,this.state.party.hitPoints+e)}getTile(e,t){return this.chunkManager.getTile(e,t)}isDiscovered(e,t){return this.state.discovered.has("".concat(e,",").concat(t))}getTimeOfDay(){return this.state.time.minutes%1440/1440}getStats(){const e=Math.floor(this.state.time.minutes/60)%24,t=this.state.time.minutes%60;return{chunks:this.chunkManager.getStats(),discovered:this.state.discovered.size,timeOfDay:this.getTimeOfDay(),gameTime:"Day ".concat(this.state.time.day,", ").concat(this.state.time.season," Year ").concat(this.state.time.year," - ").concat(e.toString().padStart(2,"0"),":").concat(t.toString().padStart(2,"0"))}}wasLoadedFromSave(){return this.loadedFromSave}save(){const e=s(s({},this.state),{},{discovered:Array.from(this.state.discovered)});return JSON.stringify(e,null,2)}load(e){try{const n=JSON.parse(e);this.chunkManager=new He(n.seed,n.config.world);try{this.chokepointManager=new Ge(n.seed,n.config.world.mapWidth,n.config.world.mapHeight,n.config.world.mapWidth/2,n.config.world.mapHeight/2)}catch(t){console.error("Failed to recreate chokepoint manager during load:",t),this.chokepointManager=null}return this.rng=new Be("".concat(n.seed,"_engine")),this.state=s(s({},n),{},{discovered:new Set(n.discovered)}),this.ensureRadius(this.state.config.gameplay.chunkLoadRadius),this.loadedFromSave=!0,!0}catch(t){return console.error("Failed to load save data:",t),!1}}updateWorldConfig(e){this.state.config.world=s(s({},this.state.config.world),e),this.chunkManager.updateConfig(this.state.config.world),this.chunkManager.invalidateAll();try{this.chokepointManager=new Ge(this.state.seed,this.state.config.world.mapWidth,this.state.config.world.mapHeight,this.state.config.world.mapWidth/2,this.state.config.world.mapHeight/2)}catch(t){console.error("Failed to recreate chokepoint manager:",t),this.chokepointManager=null}this.state.discovered.clear(),this.discoverRadius(this.state.party.x,this.state.party.y,this.state.config.gameplay.fogOfWarRadius)}getChokepoints(){var e;return(null===(e=this.chokepointManager)||void 0===e?void 0:e.getChokepoints())||[]}getChokepointAt(e,t){var n;return null===(n=this.chokepointManager)||void 0===n?void 0:n.getChokepointAt(e,t)}getRegions(){var e;return(null===(e=this.chokepointManager)||void 0===e?void 0:e.getRegions())||[]}getRegionAt(e,t){var n;return null===(n=this.chokepointManager)||void 0===n?void 0:n.getRegionAt(e,t)}checkTravelBlockage(e,t){var n;return(null===(n=this.chokepointManager)||void 0===n?void 0:n.isRouteBlocked(this.state.party.x,this.state.party.y,e,t))||[]}attemptFortificationClear(e,t){const n=this.getChokepointAt(e,t);if(null===n||void 0===n||!n.fortification||n.fortification.cleared)return{success:!1};const r=n.fortification,a=Math.max(1,Math.floor(this.state.time.day/30)),i=r.requiredGear.every(e=>this.state.party.equipment.includes(e));if(a>=r.requiredLevel&&i){var o;if(null===(o=this.chokepointManager)||void 0===o?void 0:o.clearFortification(e,t)){for(const e of r.rewards)"gold"===e.type?this.state.party.supplies.gold+=e.value:"equipment"===e.type&&this.state.party.equipment.push(e.name);return{success:!0,fortification:r,rewards:r.rewards}}}return{success:!1,fortification:r}}getCurrentRegion(){return this.getRegionAt(this.state.party.x,this.state.party.y)}canTravelTo(e,t){const n=this.checkTravelBlockage(e,t);if(0===n.length)return{canTravel:!0,blockedBy:[]};const r=n.filter(e=>e.fortified&&e.fortification&&!e.fortification.cleared);if(r.length>0){const e=r.map(e=>{var t;return null===(t=e.fortification)||void 0===t?void 0:t.name}).filter(Boolean).join(", ");return{canTravel:!1,blockedBy:r,reason:"Path blocked by fortification(s): ".concat(e)}}return{canTravel:!0,blockedBy:[]}}createMainCity(e,t){const n=this.chunkManager.getTile(e,t);if(n){n.settlement={name:this.generateCityName(),population:this.rng.nextInt(5e3,15e3),size:"city",faction:"Capital"};for(let n=-1;n<=1;n++)for(let r=-1;r<=1;r++){const a=this.chunkManager.getTile(e+n,t+r);a&&"Ocean"===a.biome&&(a.biome="Coast")}}}generateCityName(){const e=["Haven","Storm","River","Gold","Stone","Iron","Silver","White","Black","Red"],t=["port","hold","burg","haven","ford","gate","fall","ridge","vale","watch"],n=e[this.rng.nextInt(0,e.length-1)],r=t[this.rng.nextInt(0,t.length-1)];return"".concat(n).concat(r)}checkForEncounter(e){var t;if("city"===(null===(t=e.settlement)||void 0===t?void 0:t.size))return;const n=this.getFixedEncounterAt(this.state.party.x,this.state.party.y);if(n&&!this.state.completedEncounters.has(n.id))return void(this.state.activeEncounter=n);if(this.rng.nextFloat()<=this.state.encounterClock.riskLevel*this.state.encounterClock.encounterChance){const t=this.generateRandomEncounter(e);t&&(this.state.activeEncounter=t,this.state.encounterClock.riskLevel=Math.max(0,this.state.encounterClock.riskLevel-.5),this.state.encounterClock.lastEncounter=this.state.time.minutes)}}generateRandomEncounter(e){const t=[];switch(e.biome){case"Forest":t.push({name:"Forest Bandits",type:"combat",danger:"medium",description:"A group of bandits emerges from the trees, demanding your coin.",biome:"Forest",rewards:{gold:50,experience:75}},{name:"Lost Traveler",type:"event",danger:"safe",description:"A confused traveler asks for directions to the nearest town.",biome:"Forest",rewards:{experience:25}},{name:"Ancient Grove",type:"discovery",danger:"safe",description:"You discover an ancient grove with mystical properties.",biome:"Forest",rewards:{experience:100}});break;case"Grass":t.push({name:"Wild Wolves",type:"combat",danger:"low",description:"A pack of hungry wolves blocks your path.",biome:"Grass",rewards:{experience:50}},{name:"Merchant Caravan",type:"trader",danger:"safe",description:"A friendly merchant offers to trade goods.",biome:"Grass",rewards:{experience:25}});break;case"Mountain":t.push({name:"Mountain Trolls",type:"combat",danger:"high",description:"Massive trolls emerge from rocky caves, brandishing crude weapons.",biome:"Mountain",rewards:{gold:100,experience:150}},{name:"Hidden Cave",type:"discovery",danger:"medium",description:"You discover a cave that might contain treasure... or danger.",biome:"Mountain",rewards:{gold:75,experience:100}});break;case"Desert":t.push({name:"Desert Nomads",type:"event",danger:"safe",description:"Desert nomads offer to share their water and knowledge.",biome:"Desert",rewards:{experience:50}},{name:"Sandstorm Mirage",type:"discovery",danger:"low",description:"A mirage reveals the location of an oasis.",biome:"Desert",rewards:{experience:75}});break;case"Swamp":t.push({name:"Swamp Wraiths",type:"combat",danger:"high",description:"Ghostly figures rise from the murky waters.",biome:"Swamp",rewards:{experience:125,items:["Spirit Essence"]}});break;default:t.push({name:"Strange Weather",type:"event",danger:"safe",description:"Unusual weather patterns create an interesting phenomenon.",rewards:{experience:30}})}if(0===t.length)return null;const n=t[this.rng.nextInt(0,t.length-1)];return s({id:"random_".concat(this.state.party.x,"_").concat(this.state.party.y,"_").concat(this.state.time.day,"_").concat(Date.now()),x:this.state.party.x,y:this.state.party.y,isFixed:!1,isActive:!0},n)}getFixedEncounterAt(e,t){return[{id:"dragon_lair_1000_1000",name:"Ancient Dragon Lair",type:"combat",danger:"extreme",description:"An ancient red dragon guards a massive hoard in this mountain cave.",x:1e3,y:1e3,isFixed:!0,isActive:!0,rewards:{gold:5e3,experience:1e3,items:["Dragon Scale Armor","Flame Sword"],reputation:[{faction:"Dragon Slayers",amount:100}]}}].find(n=>n.x===e&&n.y===t)||null}getActiveEncounter(){return this.state.activeEncounter}completeEncounter(e,t){if(!this.state.activeEncounter)return;const n=this.state.activeEncounter;if("combat"===n.type)if(e){const e=Math.floor(5*Math.random());e>0&&(this.takeDamage(e),console.log("Combat won with minor injuries: ".concat(e," damage taken.")))}else{let e=0;switch(n.danger){case"low":e=10+Math.floor(10*Math.random());break;case"medium":e=20+Math.floor(15*Math.random());break;case"high":e=30+Math.floor(20*Math.random());break;default:e=15+Math.floor(10*Math.random())}this.takeDamage(e),console.log("Combat failed! Party takes ".concat(e," damage. HP: ").concat(this.state.party.hitPoints,"/").concat(this.state.party.maxHitPoints))}if(e&&(this.state.completedEncounters.add(n.id),n.rewards)){const e=n.rewards;if(e.gold&&(this.state.party.supplies.gold+=e.gold),e.items&&this.state.party.equipment.push(...e.items),e.experience){this.gainExperience(e.experience)?console.log("Party gained ".concat(e.experience," XP and leveled up! Now level ").concat(this.state.party.level)):console.log("Party gained ".concat(e.experience," XP"))}}this.state.activeEncounter=null}dismissEncounter(){this.state.activeEncounter=null}getAvailableMagicalSpells(){return this.magicalSpells.getAvailableSpells(this.state.party.level,this.state.party.stats,this.state.party.equipment,this.state.party.knownSpells)}learnMagicalSpell(e){return!(!this.getAvailableMagicalSpells().find(t=>t.name===e)||this.state.party.knownSpells.includes(e))&&(this.state.party.knownSpells.push(e),!0)}castMagicalSpell(e){if(!this.state.party.knownSpells.includes(e))return{success:!1,message:"Spell not known"};const t=this.getAvailableMagicalSpells().find(t=>t.name===e);if(!t)return{success:!1,message:"Spell no longer available (requirements not met)"};if(this.state.party.ether<t.etherCost)return{success:!1,message:"Not enough ether"};this.state.party.ether-=t.etherCost;let n="Cast ".concat(e,"!");if(t.effects.healing){const e=Math.floor(Math.random()*(t.effects.healing.max-t.effects.healing.min+1))+t.effects.healing.min;this.heal(e),n+=" Healed ".concat(e," HP.")}if(t.effects.damage){const e=Math.floor(Math.random()*(t.effects.damage.max-t.effects.damage.min+1))+t.effects.damage.min;n+=" Dealt ".concat(e," ").concat(t.effects.damage.type||"magical"," damage.")}return{success:!0,message:n}}getAvailablePhysicalAbilities(){return this.physicalAbilities.getAvailableAbilities(this.state.party.level,this.state.party.stats,this.state.party.equipment,this.state.party.knownAbilities)}learnPhysicalAbility(e){return!(!this.getAvailablePhysicalAbilities().find(t=>t.name===e)||this.state.party.knownAbilities.includes(e))&&(this.state.party.knownAbilities.push(e),!0)}usePhysicalAbility(e){if(!this.state.party.knownAbilities.includes(e))return{success:!1,message:"Ability not known"};const t=this.getAvailablePhysicalAbilities().find(t=>t.name===e);if(!t)return{success:!1,message:"Ability no longer available (requirements not met)"};if(this.state.party.stamina<t.staminaCost)return{success:!1,message:"Not enough stamina"};this.state.party.stamina-=t.staminaCost;let n="Used ".concat(e,"!");if(t.effects.healing){const e=Math.floor(Math.random()*(t.effects.healing.max-t.effects.healing.min+1))+t.effects.healing.min;this.heal(e),n+=" Healed ".concat(e," HP.")}if(t.effects.damage){const e=Math.floor(Math.random()*(t.effects.damage.max-t.effects.damage.min+1))+t.effects.damage.min;n+=" Dealt ".concat(e," ").concat(t.effects.damage.type||"damage",".")}return{success:!0,message:n}}restoreStamina(e){this.state.party.stamina=Math.min(this.state.party.maxStamina,this.state.party.stamina+e)}restoreEther(e){this.state.party.ether=Math.min(this.state.party.maxEther,this.state.party.ether+e)}useEther(e){return this.state.party.ether>=e&&(this.state.party.ether-=e,!0)}gainExperience(e){this.state.party.experience+=e;const t=100*this.state.party.level;if(this.state.party.experience>=t){this.state.party.level++,this.state.party.experience-=t;const e=Object.keys(this.state.party.stats),n=this.rng.pick(e);return this.state.party.stats[n]++,this.state.party.maxStamina+=2,this.state.party.stamina=this.state.party.maxStamina,this.state.party.maxEther+=1,this.state.party.ether=this.state.party.maxEther,!0}return!1}addCharacter(e){const t=s(s({},e),{},{id:"char_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),hitPoints:this.calculateMaxHitPoints(e.stats.constitution,e.level),maxHitPoints:this.calculateMaxHitPoints(e.stats.constitution,e.level),stamina:this.calculateMaxStamina(e.stats.constitution,e.level),maxStamina:this.calculateMaxStamina(e.stats.constitution,e.level),ether:this.calculateMaxEther(e.stats.intelligence,e.stats.wisdom,e.level),maxEther:this.calculateMaxEther(e.stats.intelligence,e.stats.wisdom,e.level),knownAbilities:[],knownSpells:[],knownCantrips:[],equipment:[]});return this.state.characters.push(t),this.state.party.members.push(t.id),this.autoSave(),t}getCharacter(e){return this.state.characters.find(t=>t.id===e)}getPartyCharacters(){return this.state.party.members.map(e=>this.getCharacter(e)).filter(e=>void 0!==e)}learnPhysicalAbilityForCharacter(e,t){const n=this.getCharacter(e);if(!n)return!1;return!(!this.getAvailablePhysicalAbilitiesForCharacter(e).find(e=>e.name===t)||n.knownAbilities.includes(t))&&(n.knownAbilities.push(t),this.autoSave(),!0)}learnMagicalSpellForCharacter(e,t){const n=this.getCharacter(e);if(!n)return!1;return!(!this.getAvailableMagicalSpellsForCharacter(e).find(e=>e.name===t)||n.knownSpells.includes(t))&&(n.knownSpells.push(t),this.autoSave(),!0)}getAvailablePhysicalAbilitiesForCharacter(e){const t=this.getCharacter(e);return t?this.physicalAbilities.getAvailableAbilities(t.level,t.stats,t.equipment,t.knownAbilities):[]}getAvailableMagicalSpellsForCharacter(e){const t=this.getCharacter(e);return t?this.magicalSpells.getAvailableSpells(t.level,t.stats,t.equipment,t.knownSpells):[]}calculateMaxHitPoints(e,t){const n=Math.floor((e-10)/2),r=5*(t-1);return Math.max(1,20+n+r)}calculateMaxStamina(e,t){const n=Math.floor((e-10)/2),r=3*(t-1);return Math.max(1,10+n+r)}calculateMaxEther(e,t,n){const r=Math.floor((e-10)/2),a=Math.floor((t-10)/2),i=2*(n-1);return Math.max(0,5+r+a+i)}}function Ye(e){let{engine:t,stats:n,onBack:r,cameraLocked:a,onCenterParty:i}=e;return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{style:{position:"absolute",top:"10px",left:"10px",zIndex:100,display:"flex",flexDirection:"column",gap:"10px"},children:[(0,p.jsx)("button",{onClick:r,style:{padding:"10px 16px",background:"#374151",color:"#f9fafb",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px"},children:"\u2190 Back to Menu"}),!a&&(0,p.jsx)("button",{onClick:i,style:{padding:"8px 12px",background:"#059669",color:"#f9fafb",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"12px"},children:"\ud83d\udccd Recenter on Party"})]}),(0,p.jsxs)("div",{style:{position:"absolute",bottom:"10px",left:"10px",background:"rgba(0, 0, 0, 0.8)",color:"#f9fafb",padding:"12px",borderRadius:"6px",fontSize:"12px",lineHeight:"1.4",zIndex:100},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Movement:"})," Arrow keys or WASD"]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Rest:"})," Space (1 hour, restores HP/Stamina/Ether)"]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"View:"})," Mouse drag, scroll to zoom"]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Grid:"})," G key"]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Center:"})," C key"]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Game Menu:"})," M key (Stats, Abilities, Spells, Creation)"]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Close Menu:"})," ESC or M key"]}),(0,p.jsxs)("div",{style:{marginTop:"8px"},children:[(0,p.jsxs)("div",{children:["Position: (",t.state.party.x,", ",t.state.party.y,")"]}),(0,p.jsxs)("div",{children:["Health:",(0,p.jsxs)("span",{style:{color:t.state.party.hitPoints/t.state.party.maxHitPoints>.7?"#4ade80":t.state.party.hitPoints/t.state.party.maxHitPoints>.3?"#eab308":"#ef4444",fontWeight:"bold"},children:[t.state.party.hitPoints,"/",t.state.party.maxHitPoints]})]}),(0,p.jsxs)("div",{children:["Stamina:",(0,p.jsxs)("span",{style:{color:t.state.party.stamina/t.state.party.maxStamina>.7?"#4ade80":t.state.party.stamina/t.state.party.maxStamina>.3?"#eab308":"#ef4444",fontWeight:"bold"},children:[t.state.party.stamina,"/",t.state.party.maxStamina]})]}),(0,p.jsxs)("div",{children:["Ether:",(0,p.jsxs)("span",{style:{color:t.state.party.ether/t.state.party.maxEther>.7?"#4ade80":t.state.party.ether/t.state.party.maxEther>.3?"#eab308":"#ef4444",fontWeight:"bold"},children:[t.state.party.ether,"/",t.state.party.maxEther]})]}),(0,p.jsxs)("div",{children:["Level: ",t.state.party.level," (XP: ",t.state.party.experience,")"]}),(0,p.jsxs)("div",{children:["Weather: ",t.state.weather.type," (",Math.round(100*t.state.weather.intensity),"%)"]}),(0,p.jsxs)("div",{children:["Time: ",n.gameTime]}),(0,p.jsxs)("div",{children:["Encounter Risk:",(0,p.jsxs)("span",{style:{color:t.state.encounterClock.riskLevel>.7?"#ef4444":t.state.encounterClock.riskLevel>.4?"#eab308":"#4ade80",fontWeight:"bold"},children:[Math.round(100*t.state.encounterClock.riskLevel),"%"]})]})]})]})]})}const Ke=["Human","Sylvanborn","Alloy","Draketh","Voidkin","Crystalborn","Stormcaller"],Je=["Female","Male"],Xe={Human:{automatic:[],forbidden:[],preferred:["Brave","Clever","Silver Tongue"],description:"Adaptable and versatile, humans can develop any traits through experience."},Sylvanborn:{automatic:["Nature's Friend"],forbidden:["Cunning"],preferred:["Observant","Keen Senses","Patient"],description:"Forest dwellers with an innate connection to nature."},Alloy:{automatic:["Iron Will"],forbidden:["Empathic","Silver Tongue"],preferred:["Stoic","Patient","Clever"],description:"Mechanical beings with logical minds but limited emotional range."},Draketh:{automatic:["Brave"],forbidden:["Patient"],preferred:["Swift","Silver Tongue","Stoic"],description:"Proud dragon-descendants who rarely back down from challenges."},Voidkin:{automatic:["Observant"],forbidden:["Nature's Friend"],preferred:["Clever","Iron Will","Cunning"],description:"Shadow-touched beings with enhanced perception but unnatural aura."},Crystalborn:{automatic:["Stoic"],forbidden:["Swift"],preferred:["Iron Will","Patient","Keen Senses"],description:"Living crystal beings with incredible mental fortitude."},Stormcaller:{automatic:["Swift"],forbidden:["Patient"],preferred:["Brave","Observant","Silver Tongue"],description:"Sky-born people infused with elemental storm energy."}},$e={Brave:{name:"Brave",description:"Resistant to fear and intimidation effects. +2 bonus to courage-based checks.",mechanicalEffect:"fear_resistance",bonus:{type:"courage",value:2}},Clever:{name:"Clever",description:"Quick thinking in complex situations. +2 bonus to puzzle-solving and investigation.",mechanicalEffect:"intelligence_bonus",bonus:{type:"investigation",value:2}},Cunning:{name:"Cunning",description:"Skilled at deception and misdirection. +2 bonus to stealth and deception checks.",mechanicalEffect:"deception_bonus",bonus:{type:"stealth",value:2}},Empathic:{name:"Empathic",description:"Deeply understands others' emotions. +2 bonus to persuasion and healing checks.",mechanicalEffect:"social_bonus",bonus:{type:"persuasion",value:2}},Stoic:{name:"Stoic",description:"Unshaken by pain or hardship. +2 bonus to endurance and resistance checks.",mechanicalEffect:"endurance_bonus",bonus:{type:"endurance",value:2}},Lucky:{name:"Lucky",description:"Fortune favors you. Once per encounter, reroll any failed check.",mechanicalEffect:"reroll_ability",bonus:{type:"reroll",value:1}},Observant:{name:"Observant",description:"Notice details others miss. +2 bonus to perception and awareness checks.",mechanicalEffect:"perception_bonus",bonus:{type:"perception",value:2}},"Silver Tongue":{name:"Silver Tongue",description:"Naturally persuasive speaker. +2 bonus to all social interaction checks.",mechanicalEffect:"social_master",bonus:{type:"social",value:2}},"Iron Will":{name:"Iron Will",description:"Mental fortitude against magical effects. +2 bonus to resist mental magic.",mechanicalEffect:"mental_resistance",bonus:{type:"mental_defense",value:2}},Swift:{name:"Swift",description:"Faster movement and reflexes. +2 bonus to speed and reaction checks.",mechanicalEffect:"speed_bonus",bonus:{type:"speed",value:2}},"Nature's Friend":{name:"Nature's Friend",description:"Animals and plants respond favorably. +2 bonus to nature-based interactions.",mechanicalEffect:"nature_bonus",bonus:{type:"nature",value:2}},"Keen Senses":{name:"Keen Senses",description:"Enhanced sensory perception. +2 bonus to detect hidden things or dangers.",mechanicalEffect:"detection_bonus",bonus:{type:"detection",value:2}},Patient:{name:"Patient",description:"Calm and methodical approach. +2 bonus to sustained concentration tasks.",mechanicalEffect:"concentration_bonus",bonus:{type:"concentration",value:2}},Resilient:{name:"Resilient",description:"Exceptionally tough constitution. +2 HP per level beyond normal.",mechanicalEffect:"hp_bonus",bonus:{type:"hp_per_level",value:2}},Hardy:{name:"Hardy",description:"Natural toughness and endurance. +1 HP per level beyond normal.",mechanicalEffect:"hp_bonus_small",bonus:{type:"hp_per_level",value:1}},Frail:{name:"Frail",description:"Delicate constitution, but often comes with other gifts. -2 HP per level.",mechanicalEffect:"hp_penalty",bonus:{type:"hp_per_level",value:-2}}},Qe=Object.keys($e);function Ze(e){let t=0;for(let n=9;n<=e;n++)t+=n<=14?1:n<=16?2:3;return t}function et(e){return Math.floor((e-10)/2)}function tt(e,t,n,r,a){const i=r,o=at(e.STR,"STR",t,n),s=at(e.CON,"CON",t,n),l=at(e.DEX,"DEX",t,n),c=8+et(s),d=1+Math.max(0,et(s));let u=0;u="Thorn Knight"===n||"Ashblade"===n||"Ironclad"===n||"Stormbreaker"===n||"Voidhunter"===n||"Crystal Guardian"===n?3:"Greenwarden"===n||"Guardian"===n||"Warrior"===n?2:"Ranger"===n||"Rogue"===n||"Artificer"===n?1:0;let h=0;"Alloy"===t||"Draketh"===t?h=2:"Crystalborn"===t||"Human"===t?h=1:"Voidkin"===t?h=0:"Sylvanborn"===t?h=-1:"Stormcaller"===t&&(h=0);let p=0;a.includes("Resilient")&&(p+=2),a.includes("Hardy")&&(p+=1),a.includes("Frail")&&(p-=2);const g=Math.max(1,d+u+h+p),f=c+g*(i-1);let m=0;i>=16?m+=2:i>=8&&(m+=1),"Thorn Knight"===n||"Ashblade"===n||"Ironclad"===n||"Stormbreaker"===n||"Voidhunter"===n||"Crystal Guardian"===n?i>=15?m+=2:i>=7&&(m+=1):"Greenwarden"===n||"Guardian"===n||"Warrior"===n?i>=10&&(m+=1):"Ranger"!==n&&"Rogue"!==n&&"Artificer"!==n||i>=15&&(m+=1),"Alloy"===t?i>=12&&(m+=1):"Draketh"===t?i>=15&&(m+=1):"Crystalborn"===t&&i>=15&&(m+=1),m=Math.min(m,5);return{level:i,hp:f,ac:10+et(l)+m,carry:15*o,naturalACBonus:m,totalHPPerLevel:g,classHPBonus:u,raceHPBonus:h,traitHPBonus:p}}const nt={Human:{STR:1,CHA:1,CON:-1,WIS:-1},Sylvanborn:{DEX:2,WIS:1,STR:-2,CON:-1},Alloy:{CON:2,INT:1,DEX:-2,CHA:-1},Draketh:{STR:2,CHA:1,DEX:-1,WIS:-2},Voidkin:{INT:2,WIS:1,STR:-1,CHA:-2},Crystalborn:{CON:1,INT:2,DEX:-1,CHA:-2},Stormcaller:{DEX:1,CHA:2,CON:-1,STR:-2}},rt={};function at(e,t,n,r){var a,i;let o=e;o+=(null===(a=nt[n])||void 0===a?void 0:a[t])||0;return o+=(null===(i=rt[r])||void 0===i?void 0:i[t])||0,Math.max(3,Math.min(o,22))}Object.entries(F).forEach(e=>{let[t,n]=e;rt[t]={STR:n.statModifiers.strength||0,DEX:n.statModifiers.dexterity||0,CON:n.statModifiers.constitution||0,INT:n.statModifiers.intelligence||0,WIS:n.statModifiers.wisdom||0,CHA:n.statModifiers.charisma||0}});const it=Object.keys(F),ot=["Commoner","Noble","Soldier","Scholar","Merchant","Artisan","Criminal","Folk Hero","Hermit","Entertainer"];function st(e){let{engine:t,isVisible:n,onClose:r,showGrid:a,onToggleGrid:i,cameraLocked:o,onToggleCameraLock:s,onRefresh:c,stats:d}=e;const[u,h]=(0,l.useState)("stats"),[g,f]=(0,l.useState)(null);return n?(0,p.jsxs)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(0, 0, 0, 0.95)",color:"#f9fafb",padding:"0",borderRadius:"12px",border:"2px solid #374151",width:"80vw",maxWidth:"900px",height:"80vh",maxHeight:"700px",zIndex:300,boxShadow:"0 12px 48px rgba(0, 0, 0, 0.8)",display:"flex",flexDirection:"column"},children:[(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px 24px",borderBottom:"2px solid #374151"},children:[(0,p.jsx)("h2",{style:{margin:0,color:"#f1f5f9",fontSize:"24px"},children:"\ud83c\udfae Game Menu"}),(0,p.jsx)("button",{onClick:r,style:{background:"transparent",border:"none",color:"#94a3b8",fontSize:"24px",cursor:"pointer",padding:"0",width:"32px",height:"32px"},children:"\xd7"})]}),(0,p.jsx)("div",{style:{display:"flex",borderBottom:"2px solid #374151",backgroundColor:"rgba(0, 0, 0, 0.3)"},children:[{id:"stats",label:"\ud83d\udcca Character Stats",icon:"\ud83d\udcca"},{id:"abilities",label:"\u2694\ufe0f Physical Abilities",icon:"\u2694\ufe0f"},{id:"spells",label:"\u2728 Magical Spells",icon:"\u2728"},{id:"creation",label:"\ufffd Create Character",icon:"\ufffd"},{id:"settings",label:"\u2699\ufe0f Game Settings",icon:"\u2699\ufe0f"}].map(e=>(0,p.jsxs)("button",{onClick:()=>h(e.id),style:{flex:1,padding:"12px 16px",background:u===e.id?"#374151":"transparent",color:u===e.id?"#f9fafb":"#94a3b8",border:"none",borderBottom:u===e.id?"3px solid #3b82f6":"3px solid transparent",cursor:"pointer",fontSize:"14px",fontWeight:u===e.id?"bold":"normal",transition:"all 0.2s"},children:[e.icon," ",e.label.split(" ").slice(1).join(" ")]},e.id))}),(0,p.jsxs)("div",{style:{flex:1,padding:"24px",overflowY:"auto",backgroundColor:"rgba(0, 0, 0, 0.2)"},children:["stats"===u&&(0,p.jsxs)("div",{children:[(0,p.jsx)("h3",{style:{margin:"0 0 20px 0",color:"#3b82f6"},children:"\ud83d\udcca Character Statistics"}),(0,p.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"20px"},children:[(0,p.jsxs)("div",{style:{background:"rgba(59, 130, 246, 0.1)",border:"1px solid rgba(59, 130, 246, 0.3)",borderRadius:"8px",padding:"16px"},children:[(0,p.jsx)("h4",{style:{margin:"0 0 12px 0",color:"#60a5fa"},children:"Basic Information"}),(0,p.jsxs)("div",{style:{fontSize:"14px",lineHeight:"1.6"},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Level:"})," ",t.state.party.level]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Experience:"})," ",t.state.party.experience,"/",100*t.state.party.level]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Position:"})," (",t.state.party.x,", ",t.state.party.y,")"]})]})]}),(0,p.jsxs)("div",{style:{background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",borderRadius:"8px",padding:"16px"},children:[(0,p.jsx)("h4",{style:{margin:"0 0 12px 0",color:"#4ade80"},children:"Health & Resources"}),(0,p.jsxs)("div",{style:{fontSize:"14px",lineHeight:"1.6"},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Health:"}),(0,p.jsxs)("span",{style:{color:t.state.party.hitPoints/t.state.party.maxHitPoints>.7?"#4ade80":t.state.party.hitPoints/t.state.party.maxHitPoints>.3?"#eab308":"#ef4444",fontWeight:"bold",marginLeft:"8px"},children:[t.state.party.hitPoints,"/",t.state.party.maxHitPoints]})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Stamina:"}),(0,p.jsxs)("span",{style:{color:t.state.party.stamina/t.state.party.maxStamina>.7?"#4ade80":t.state.party.stamina/t.state.party.maxStamina>.3?"#eab308":"#ef4444",fontWeight:"bold",marginLeft:"8px"},children:[t.state.party.stamina,"/",t.state.party.maxStamina]})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Ether:"}),(0,p.jsxs)("span",{style:{color:t.state.party.ether/t.state.party.maxEther>.7?"#4ade80":t.state.party.ether/t.state.party.maxEther>.3?"#eab308":"#ef4444",fontWeight:"bold",marginLeft:"8px"},children:[t.state.party.ether,"/",t.state.party.maxEther]})]})]})]}),(0,p.jsxs)("div",{style:{background:"rgba(168, 85, 247, 0.1)",border:"1px solid rgba(168, 85, 247, 0.3)",borderRadius:"8px",padding:"16px"},children:[(0,p.jsx)("h4",{style:{margin:"0 0 12px 0",color:"#a855f7"},children:"Attributes"}),(0,p.jsxs)("div",{style:{fontSize:"14px",lineHeight:"1.6",display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"8px"},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"STR:"})," ",t.state.party.stats.strength]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"DEX:"})," ",t.state.party.stats.dexterity]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"CON:"})," ",t.state.party.stats.constitution]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"INT:"})," ",t.state.party.stats.intelligence]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"WIS:"})," ",t.state.party.stats.wisdom]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"CHA:"})," ",t.state.party.stats.charisma]})]})]}),(0,p.jsxs)("div",{style:{background:"rgba(234, 179, 8, 0.1)",border:"1px solid rgba(234, 179, 8, 0.3)",borderRadius:"8px",padding:"16px"},children:[(0,p.jsx)("h4",{style:{margin:"0 0 12px 0",color:"#eab308"},children:"Equipment"}),(0,p.jsx)("div",{style:{fontSize:"14px",lineHeight:"1.6"},children:t.state.party.equipment.length>0?t.state.party.equipment.map((e,t)=>(0,p.jsx)("div",{style:{color:"#4ade80"},children:e.replace(/_/g," ")},t)):(0,p.jsx)("div",{style:{color:"#94a3b8",fontStyle:"italic"},children:"No equipment"})})]})]})]}),"abilities"===u&&(0,p.jsxs)("div",{children:[(0,p.jsx)("h3",{style:{margin:"0 0 20px 0",color:"#4ade80"},children:"\u2694\ufe0f Physical Abilities"}),(0,p.jsxs)("div",{style:{marginBottom:"24px"},children:[(0,p.jsx)("h4",{style:{margin:"0 0 12px 0",color:"#22c55e"},children:"Known Abilities"}),t.state.party.knownAbilities.length>0?(0,p.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"8px"},children:t.state.party.knownAbilities.map((e,t)=>(0,p.jsx)("div",{style:{padding:"8px 12px",background:"rgba(34, 197, 94, 0.2)",borderRadius:"6px",border:"1px solid #22c55e",fontSize:"13px"},children:e},t))}):(0,p.jsx)("div",{style:{fontSize:"14px",color:"#94a3b8",fontStyle:"italic"},children:"No physical abilities learned yet."})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("h4",{style:{margin:"0 0 12px 0",color:"#eab308"},children:"Available to Learn by School"}),(0,p.jsx)(lt,{engine:t,selectedCharacterId:g,onSelectCharacter:f}),g&&(0,p.jsx)(ct,{engine:t,characterId:g})]})]}),"spells"===u&&(0,p.jsxs)("div",{children:[(0,p.jsx)("h3",{style:{margin:"0 0 20px 0",color:"#8b5cf6"},children:"\u2728 Magical Spells"}),(0,p.jsxs)("div",{style:{marginBottom:"24px"},children:[(0,p.jsx)("h4",{style:{margin:"0 0 12px 0",color:"#a855f7"},children:"Known Spells"}),t.state.party.knownSpells.length>0?(0,p.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"8px"},children:t.state.party.knownSpells.map((e,t)=>(0,p.jsx)("div",{style:{padding:"8px 12px",background:"rgba(139, 92, 246, 0.2)",borderRadius:"6px",border:"1px solid #8b5cf6",fontSize:"13px"},children:e},t))}):(0,p.jsx)("div",{style:{fontSize:"14px",color:"#94a3b8",fontStyle:"italic"},children:"No spells learned yet."})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("h4",{style:{margin:"0 0 12px 0",color:"#06b6d4"},children:"Available to Learn by School"}),(0,p.jsx)(lt,{engine:t,selectedCharacterId:g,onSelectCharacter:f}),g&&(0,p.jsx)(dt,{engine:t,characterId:g})]})]}),"creation"===u&&(0,p.jsxs)("div",{children:[(0,p.jsx)("h3",{style:{margin:"0 0 20px 0",color:"#f59e0b"},children:"\ufffd Character Creation"}),(0,p.jsx)(ut,{engine:t})]}),"settings"===u&&(0,p.jsxs)("div",{children:[(0,p.jsx)("h3",{style:{margin:"0 0 20px 0",color:"#6b7280"},children:"\u2699\ufe0f Game Settings"}),(0,p.jsxs)("div",{style:{display:"grid",gap:"20px"},children:[(0,p.jsxs)("div",{style:{background:"rgba(107, 114, 128, 0.1)",border:"1px solid rgba(107, 114, 128, 0.3)",borderRadius:"8px",padding:"20px"},children:[(0,p.jsx)("h4",{style:{margin:"0 0 16px 0",color:"#9ca3af"},children:"Display Settings"}),(0,p.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"12px"},children:[(0,p.jsx)("label",{style:{fontSize:"14px",color:"#e2e8f0"},children:"Show Grid"}),(0,p.jsx)("button",{onClick:i,style:{padding:"6px 12px",background:a?"#059669":"#374151",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"12px"},children:a?"ON":"OFF"})]}),(0,p.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"12px"},children:[(0,p.jsx)("label",{style:{fontSize:"14px",color:"#e2e8f0"},children:"Camera Lock"}),(0,p.jsx)("button",{onClick:s,style:{padding:"6px 12px",background:o?"#059669":"#374151",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"12px"},children:o?"LOCKED":"FREE"})]})]}),(0,p.jsxs)("div",{style:{background:"rgba(107, 114, 128, 0.1)",border:"1px solid rgba(107, 114, 128, 0.3)",borderRadius:"8px",padding:"20px"},children:[(0,p.jsx)("h4",{style:{margin:"0 0 16px 0",color:"#9ca3af"},children:"Game Information"}),(0,p.jsxs)("div",{style:{fontSize:"13px",lineHeight:"1.6",color:"#cbd5e1"},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Time:"})," ",d.gameTime]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Weather:"})," ",t.state.weather.type," (",Math.round(100*t.state.weather.intensity),"%)"]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Chunks Loaded:"})," ",d.chunks.loaded||0]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Discovered Tiles:"})," ",d.discovered]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Encounter Risk:"}),(0,p.jsxs)("span",{style:{color:t.state.encounterClock.riskLevel>.7?"#ef4444":t.state.encounterClock.riskLevel>.4?"#eab308":"#4ade80",fontWeight:"bold",marginLeft:"8px"},children:[Math.round(100*t.state.encounterClock.riskLevel),"%"]})]})]})]}),(0,p.jsxs)("div",{style:{background:"rgba(59, 130, 246, 0.1)",border:"1px solid rgba(59, 130, 246, 0.3)",borderRadius:"8px",padding:"20px"},children:[(0,p.jsx)("h4",{style:{margin:"0 0 16px 0",color:"#60a5fa"},children:"\ud83d\udcbe Save & Load"}),(0,p.jsxs)("div",{style:{display:"grid",gap:"12px"},children:[(0,p.jsx)("div",{style:{fontSize:"12px",color:"#cbd5e1",marginBottom:"8px"},children:"Your game is automatically saved when you move, create characters, or learn abilities."}),(0,p.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:"8px"},children:[(0,p.jsx)("button",{onClick:()=>{try{const e=t.save(),n=new Blob([e],{type:"application/json"}),r=URL.createObjectURL(n),a=document.createElement("a");a.href=r,a.download="world-engine-save-".concat((new Date).toISOString().split("T")[0],".json"),a.click(),URL.revokeObjectURL(r),alert("Game saved to file!")}catch(e){alert("Failed to save game: "+e)}},style:{padding:"8px 12px",background:"#3b82f6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"12px",fontWeight:"bold"},children:"\ud83d\udce5 Export Save"}),(0,p.jsx)("button",{onClick:()=>{const e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=e=>{var n;const r=null===(n=e.target.files)||void 0===n?void 0:n[0];if(r){const e=new FileReader;e.onload=e=>{try{var n;const r=null===(n=e.target)||void 0===n?void 0:n.result;t.load(r)?(null===c||void 0===c||c(),alert("Game loaded successfully! Your characters and progress have been restored.")):alert("Failed to load save file. Please check the file format.")}catch(r){alert("Failed to load game: "+r)}},e.readAsText(r)}},e.click()},style:{padding:"8px 12px",background:"#059669",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"12px",fontWeight:"bold"},children:"\ud83d\udce4 Import Save"}),(0,p.jsx)("button",{onClick:()=>{confirm("Are you sure you want to start a new game? This will delete your current progress.")&&(localStorage.removeItem("world-engine-save"),alert("Save data cleared! Refresh the page to start a new game."))},style:{padding:"8px 12px",background:"#dc2626",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"12px",fontWeight:"bold"},children:"\ud83d\uddd1\ufe0f New Game"})]}),(0,p.jsxs)("div",{style:{fontSize:"11px",color:"#94a3b8",marginTop:"8px"},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Seed:"})," ",t.state.seed]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Characters:"})," ",t.state.characters.length]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Last Save:"})," Auto-saved to browser"]})]})]})]})]})]})]})]}):null}function lt(e){var t;let{engine:n,selectedCharacterId:r,onSelectCharacter:a}=e;const i=n.getPartyCharacters();return 0===i.length?(0,p.jsx)("div",{style:{padding:"16px",background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.3)",borderRadius:"8px",marginBottom:"16px",fontSize:"14px",color:"#fca5a5"},children:"\u26a0\ufe0f No characters in party. Add characters to assign abilities and spells."}):(0,p.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,p.jsx)("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:i.map(e=>(0,p.jsxs)("button",{onClick:()=>a(r===e.id?null:e.id),style:{padding:"8px 16px",background:r===e.id?"#3b82f6":"rgba(59, 130, 246, 0.2)",border:r===e.id?"2px solid #60a5fa":"1px solid rgba(59, 130, 246, 0.3)",borderRadius:"6px",color:r===e.id?"#f9fafb":"#94a3b8",cursor:"pointer",fontSize:"14px",fontWeight:r===e.id?"bold":"normal",transition:"all 0.2s"},children:["\ud83d\udc64 ",e.name," (Lv.",e.level,")"]},e.id))}),r&&(0,p.jsxs)("div",{style:{marginTop:"12px",padding:"12px",background:"rgba(59, 130, 246, 0.1)",border:"1px solid rgba(59, 130, 246, 0.3)",borderRadius:"6px",fontSize:"13px",color:"#cbd5e1"},children:["Selected: ",(0,p.jsx)("strong",{children:null===(t=i.find(e=>e.id===r))||void 0===t?void 0:t.name})]})]})}function ct(e){let{engine:t,characterId:n}=e;const[r,a]=(0,l.useState)(new Set),i=t.getCharacter(n),o=(0,l.useMemo)(()=>{if(!i)return{};try{const e=t.getAvailablePhysicalAbilitiesForCharacter(n).filter(e=>!i.knownAbilities.includes(e.name)),r={};return e.forEach(e=>{r[e.school]||(r[e.school]=[]),r[e.school].push(e)}),r}catch(e){return console.error("Error loading abilities:",e),{}}},[null===i||void 0===i?void 0:i.level,JSON.stringify(null===i||void 0===i?void 0:i.stats),JSON.stringify(null===i||void 0===i?void 0:i.knownAbilities),n]);if(!i)return(0,p.jsx)("div",{style:{fontSize:"14px",color:"#ef4444"},children:"Character not found."});const s=Object.keys(o).sort();return 0===s.length?(0,p.jsx)("div",{style:{fontSize:"14px",color:"#94a3b8",fontStyle:"italic"},children:"No new physical abilities available."}):(0,p.jsx)("div",{style:{display:"grid",gap:"8px"},children:s.map(e=>(0,p.jsxs)("div",{style:{border:"1px solid rgba(34, 197, 94, 0.3)",borderRadius:"8px",background:"rgba(34, 197, 94, 0.1)"},children:[(0,p.jsxs)("button",{onClick:()=>(e=>{const t=new Set(r);t.has(e)?t.delete(e):t.add(e),a(t)})(e),style:{width:"100%",padding:"12px 16px",background:"transparent",border:"none",color:"#4ade80",fontSize:"14px",fontWeight:"bold",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,p.jsxs)("span",{children:["\u2694\ufe0f ",e," (",o[e].length,")"]}),(0,p.jsx)("span",{style:{fontSize:"18px"},children:r.has(e)?"\u25bc":"\u25b6"})]}),r.has(e)&&(0,p.jsx)("div",{style:{padding:"0 16px 16px 16px",display:"grid",gap:"12px"},children:o[e].map((e,r)=>(0,p.jsx)("div",{style:{padding:"16px",background:"rgba(234, 179, 8, 0.2)",borderRadius:"8px",border:"1px solid #eab308"},children:(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,p.jsxs)("div",{style:{flex:1},children:[(0,p.jsx)("div",{style:{fontWeight:"bold",color:"#fbbf24",fontSize:"16px"},children:e.name}),(0,p.jsxs)("div",{style:{fontSize:"12px",color:"#e2e8f0",marginTop:"4px"},children:[e.school," \u2022 ",e.tier," \u2022 Stamina: ",e.staminaCost]}),(0,p.jsx)("div",{style:{fontSize:"13px",color:"#cbd5e1",marginTop:"8px"},children:e.description})]}),(0,p.jsx)("button",{onClick:()=>{t.learnPhysicalAbilityForCharacter(n,e.name)&&console.log("".concat(i.name," learned ").concat(e.name,"!"))},style:{marginLeft:"12px",padding:"8px 16px",background:"#059669",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"12px",fontWeight:"bold"},children:"Learn"})]})},r))})]},e))})}function dt(e){let{engine:t,characterId:n}=e;const[r,a]=(0,l.useState)(new Set),i=t.getCharacter(n),o=(0,l.useMemo)(()=>{if(!i)return{};try{const e=t.getAvailableMagicalSpellsForCharacter(n).filter(e=>!i.knownSpells.includes(e.name)),r={};return e.forEach(e=>{r[e.school]||(r[e.school]=[]),r[e.school].push(e)}),r}catch(e){return console.error("Error loading spells:",e),{}}},[null===i||void 0===i?void 0:i.level,JSON.stringify(null===i||void 0===i?void 0:i.stats),JSON.stringify(null===i||void 0===i?void 0:i.knownSpells),n]);if(!i)return(0,p.jsx)("div",{style:{fontSize:"14px",color:"#ef4444"},children:"Character not found."});return 0===Object.keys(o).sort().length?(0,p.jsx)("div",{style:{fontSize:"14px",color:"#94a3b8",fontStyle:"italic"},children:"No new magical spells available."}):(0,p.jsx)("div",{style:{display:"grid",gap:"8px"}})}function ut(e){let{engine:t}=e;const[n,r]=(0,l.useState)({name:"",gender:"Female",species:"Human",archetype:"Greenwarden",background:"Commoner",level:1,stats:{strength:10,dexterity:10,constitution:10,intelligence:10,wisdom:10,charisma:10},traits:[]}),[a,i]=(0,l.useState)(27),[o,c]=(0,l.useState)([]),d=Xe[n.species],u=(e,t)=>{const o=n.stats[e],l=Ze(t)-Ze(o);a-l>=0&&t>=8&&t<=20&&(r(n=>s(s({},n),{},{stats:s(s({},n.stats),{},{[e]:t})})),i(e=>e-l))},h=e=>Ze(e);return(0,p.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(400px, 1fr))",gap:"24px"},children:[(0,p.jsxs)("div",{style:{background:"rgba(59, 130, 246, 0.1)",border:"1px solid rgba(59, 130, 246, 0.3)",borderRadius:"8px",padding:"20px"},children:[(0,p.jsx)("h4",{style:{margin:"0 0 16px 0",color:"#60a5fa",borderBottom:"2px solid #60a5fa",paddingBottom:"8px"},children:"\ud83d\udccb Basic Information"}),(0,p.jsxs)("div",{style:{display:"grid",gap:"12px"},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{style:{display:"block",fontSize:"12px",color:"#cbd5e1",marginBottom:"4px"},children:"Character Name *"}),(0,p.jsx)("input",{type:"text",value:n.name,onChange:e=>r(t=>s(s({},t),{},{name:e.target.value})),placeholder:"Enter character name...",style:{width:"100%",padding:"8px 12px",background:"rgba(0, 0, 0, 0.3)",border:"1px solid #374151",borderRadius:"6px",color:"#f9fafb",fontSize:"14px"}})]}),(0,p.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{style:{display:"block",fontSize:"12px",color:"#cbd5e1",marginBottom:"4px"},children:"Gender"}),(0,p.jsx)("select",{value:n.gender,onChange:e=>r(t=>s(s({},t),{},{gender:e.target.value})),style:{width:"100%",padding:"8px 12px",background:"rgba(0, 0, 0, 0.3)",border:"1px solid #374151",borderRadius:"6px",color:"#f9fafb",fontSize:"14px"},children:Je.map(e=>(0,p.jsx)("option",{value:e,children:e},e))})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{style:{display:"block",fontSize:"12px",color:"#cbd5e1",marginBottom:"4px"},children:"Level"}),(0,p.jsx)("input",{type:"number",min:"1",max:"20",value:n.level,onChange:e=>r(t=>s(s({},t),{},{level:parseInt(e.target.value)||1})),style:{width:"100%",padding:"8px 12px",background:"rgba(0, 0, 0, 0.3)",border:"1px solid #374151",borderRadius:"6px",color:"#f9fafb",fontSize:"14px"}})]})]}),(0,p.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"12px"},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{style:{display:"block",fontSize:"12px",color:"#cbd5e1",marginBottom:"4px"},children:"Species"}),(0,p.jsx)("select",{value:n.species,onChange:e=>r(t=>s(s({},t),{},{species:e.target.value})),style:{width:"100%",padding:"8px 12px",background:"rgba(0, 0, 0, 0.3)",border:"1px solid #374151",borderRadius:"6px",color:"#f9fafb",fontSize:"14px"},children:Ke.map(e=>(0,p.jsx)("option",{value:e,children:e},e))}),n.species&&nt[n.species]&&(0,p.jsxs)("div",{style:{fontSize:"11px",color:"#94a3b8",marginTop:"4px"},children:["Racial modifiers: ",Object.entries(nt[n.species]).map(e=>{let[t,n]=e;return"".concat(t," ").concat(n>0?"+":"").concat(n)}).join(", ")]})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{style:{display:"block",fontSize:"12px",color:"#cbd5e1",marginBottom:"4px"},children:"Class"}),(0,p.jsx)("select",{value:n.archetype,onChange:e=>r(t=>s(s({},t),{},{archetype:e.target.value})),style:{width:"100%",padding:"8px 12px",background:"rgba(0, 0, 0, 0.3)",border:"1px solid #374151",borderRadius:"6px",color:"#f9fafb",fontSize:"14px"},children:it.map(e=>(0,p.jsx)("option",{value:e,children:e},e))}),n.archetype&&rt[n.archetype]&&(0,p.jsxs)("div",{style:{fontSize:"11px",color:"#94a3b8",marginTop:"4px"},children:["Class modifiers: ",Object.entries(rt[n.archetype]).map(e=>{let[t,n]=e;return"".concat(t," ").concat(n>0?"+":"").concat(n)}).filter(e=>!e.includes(" 0")).join(", ")||"None"]})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{style:{display:"block",fontSize:"12px",color:"#cbd5e1",marginBottom:"4px"},children:"Background"}),(0,p.jsx)("select",{value:n.background,onChange:e=>r(t=>s(s({},t),{},{background:e.target.value})),style:{width:"100%",padding:"8px 12px",background:"rgba(0, 0, 0, 0.3)",border:"1px solid #374151",borderRadius:"6px",color:"#f9fafb",fontSize:"14px"},children:ot.map(e=>(0,p.jsx)("option",{value:e,children:e},e))})]})]})]})]}),(0,p.jsxs)("div",{style:{background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",borderRadius:"8px",padding:"20px"},children:[(0,p.jsx)("h4",{style:{margin:"0 0 16px 0",color:"#4ade80",borderBottom:"2px solid #4ade80",paddingBottom:"8px"},children:"\u26a1 Ability Scores"}),(0,p.jsxs)("div",{style:{marginBottom:"16px",fontSize:"12px",color:"#cbd5e1"},children:["Points Available: ",(0,p.jsx)("strong",{style:{color:a>0?"#4ade80":"#ef4444"},children:a})]}),(0,p.jsxs)("div",{style:{marginBottom:"12px",fontSize:"11px",color:"#94a3b8",lineHeight:"1.4"},children:[(0,p.jsx)("strong",{children:"Point Cost:"})," 8-14 (1 point each), 15-16 (2 points each), 17-20 (3 points each)"]}),(0,p.jsx)("div",{style:{display:"grid",gap:"8px"},children:Object.entries(n.stats).map(e=>{let[t,r]=e;return(0,p.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[(0,p.jsx)("div",{style:{width:"80px",fontSize:"13px",color:"#e2e8f0",textTransform:"capitalize"},children:t.slice(0,3).toUpperCase()}),(0,p.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,p.jsx)("button",{onClick:()=>u(t,r-1),disabled:r<=8,style:{width:"24px",height:"24px",background:r>8?"#374151":"#1f2937",color:r>8?"#f9fafb":"#6b7280",border:"none",borderRadius:"4px",cursor:r>8?"pointer":"not-allowed",fontSize:"14px"},children:"\u2212"}),(0,p.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",minWidth:"60px"},children:[(0,p.jsx)("div",{style:{fontSize:"16px",fontWeight:"bold",color:"#f9fafb"},children:r}),(()=>{const e=at(r,t,n.species,n.archetype),a=et(e);return e!==r?(0,p.jsxs)("div",{style:{fontSize:"12px",color:e>r?"#4ade80":"#f87171"},children:[e," (",a>=0?"+":"",a,")"]}):(0,p.jsxs)("div",{style:{fontSize:"12px",color:"#94a3b8"},children:["(",a>=0?"+":"",a,")"]})})()]}),(0,p.jsx)("button",{onClick:()=>u(t,r+1),disabled:r>=20||a-(h(r+1)-h(r))<0,style:{width:"24px",height:"24px",background:r<20&&a-(h(r+1)-h(r))>=0?"#374151":"#1f2937",color:r<20&&a-(h(r+1)-h(r))>=0?"#f9fafb":"#6b7280",border:"none",borderRadius:"4px",cursor:r<20&&a-(h(r+1)-h(r))>=0?"pointer":"not-allowed",fontSize:"14px"},children:"+"})]}),(0,p.jsxs)("div",{style:{fontSize:"11px",color:"#94a3b8",display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[(0,p.jsxs)("div",{children:["Cost: ",h(r)]}),(()=>{const e=function(e,t,n){var r,a;const i=(null===(r=nt[t])||void 0===r?void 0:r[e])||0,o=(null===(a=rt[n])||void 0===a?void 0:a[e])||0;let s="";return i>0?s+=" +".concat(i," racial"):i<0&&(s+=" ".concat(i," racial")),o>0?s+=" +".concat(o," class"):o<0&&(s+=" ".concat(o," class")),s.trim()}({strength:"STR",dexterity:"DEX",constitution:"CON",intelligence:"INT",wisdom:"WIS",charisma:"CHA"}[t],n.species,n.archetype);return e?(0,p.jsx)("div",{style:{fontSize:"10px",color:"#6b7280"},children:e}):null})()]})]},t)})})]}),(0,p.jsxs)("div",{style:{marginBottom:"20px",padding:"15px",background:"rgba(55, 65, 81, 0.3)",borderRadius:"8px",border:"1px solid #374151"},children:[(0,p.jsx)("h4",{style:{margin:"0 0 15px 0",color:"#f9fafb",fontSize:"16px",borderBottom:"2px solid #374151",paddingBottom:"8px"},children:"\ud83c\udfad Character Preview"}),(0,p.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:"15px"},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("h5",{style:{margin:"0 0 10px 0",color:"#d1d5db",fontSize:"14px",fontWeight:"bold"},children:"Final Stats"}),Object.entries(n.stats).map(e=>{let[t,r]=e;const a={strength:"STR",dexterity:"DEX",constitution:"CON",intelligence:"INT",wisdom:"WIS",charisma:"CHA"}[t],i=at(r,a,n.species,n.archetype),o=et(i);return(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"12px",color:"#d1d5db",marginBottom:"2px"},children:[(0,p.jsx)("span",{children:a}),(0,p.jsxs)("span",{style:{color:i!==r?"#4ade80":"#f9fafb"},children:[i," (",o>=0?"+":"",o,")"]})]},t)})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("h5",{style:{margin:"0 0 10px 0",color:"#d1d5db",fontSize:"14px",fontWeight:"bold"},children:"Combat Stats"}),(()=>{const e={STR:n.stats.strength,DEX:n.stats.dexterity,CON:n.stats.constitution,INT:n.stats.intelligence,WIS:n.stats.wisdom,CHA:n.stats.charisma},t=[...(null===d||void 0===d?void 0:d.automatic)||[],...o],{hp:r,ac:a}=tt(e,n.species,n.archetype,n.level,t),i=et(at(n.stats.constitution,"CON",n.species,n.archetype)),s=et(at(n.stats.dexterity,"DEX",n.species,n.archetype));return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"12px",color:"#d1d5db",marginBottom:"2px"},children:[(0,p.jsx)("span",{children:"HP"}),(0,p.jsx)("span",{style:{color:"#ef4444"},children:r})]}),(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"10px",color:"#9ca3af",marginLeft:"10px",marginBottom:"4px"},children:[(0,p.jsx)("span",{children:"Base: 10 + CON mod"}),(0,p.jsxs)("span",{children:["10 + ",i>=0?"+":"",i]})]}),(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"12px",color:"#d1d5db",marginBottom:"2px"},children:[(0,p.jsx)("span",{children:"AC"}),(0,p.jsx)("span",{style:{color:"#3b82f6"},children:a})]}),(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"10px",color:"#9ca3af",marginLeft:"10px"},children:[(0,p.jsx)("span",{children:"Base: 10 + DEX mod"}),(0,p.jsxs)("span",{children:["10 + ",s>=0?"+":"",s]})]})]})})()]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("h5",{style:{margin:"0 0 10px 0",color:"#d1d5db",fontSize:"14px",fontWeight:"bold"},children:"Point Buy"}),(()=>{const e=Object.values(n.stats).reduce((e,t)=>e+h(t),0);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"12px",color:0===a?"#4ade80":a>0?"#fbbf24":"#ef4444",marginBottom:"2px"},children:[(0,p.jsx)("span",{children:"Available"}),(0,p.jsx)("span",{children:a})]}),(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"12px",color:"#d1d5db"},children:[(0,p.jsx)("span",{children:"Used"}),(0,p.jsx)("span",{children:e})]})]})})()]})]})]}),(0,p.jsxs)("div",{style:{background:"rgba(168, 85, 247, 0.1)",border:"1px solid rgba(168, 85, 247, 0.3)",borderRadius:"8px",padding:"20px"},children:[(0,p.jsxs)("h4",{style:{margin:"0 0 16px 0",color:"#a855f7",borderBottom:"2px solid #a855f7",paddingBottom:"8px"},children:["\u2728 Character Traits ",(0,p.jsxs)("small",{style:{opacity:.7,fontSize:"12px"},children:["(choose up to ",2,")"]})]}),d&&(0,p.jsxs)("div",{style:{marginBottom:"16px"},children:[d.automatic.length>0&&(0,p.jsxs)("div",{style:{marginBottom:"8px"},children:[(0,p.jsx)("span",{style:{fontSize:"12px",color:"#10b981",fontWeight:"bold"},children:"Automatic Traits: "}),d.automatic.join(", ")]}),d.forbidden.length>0&&(0,p.jsxs)("div",{style:{marginBottom:"8px"},children:[(0,p.jsx)("span",{style:{fontSize:"12px",color:"#ef4444",fontWeight:"bold"},children:"Forbidden Traits: "}),d.forbidden.join(", ")]})]}),(0,p.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"8px",maxHeight:"200px",overflowY:"auto"},children:Qe.map(e=>{const t=$e[e],n=o.includes(e),r=null===d||void 0===d?void 0:d.automatic.includes(e),a=null===d||void 0===d?void 0:d.forbidden.includes(e),i=null===d||void 0===d?void 0:d.preferred.includes(e),s=!n&&o.length>=2||a;return(0,p.jsxs)("div",{onClick:()=>{r||a||s||(n?c(t=>t.filter(t=>t!==e)):o.length<2&&c(t=>[...t,e]))},style:{padding:"8px",borderRadius:"6px",cursor:r||a||s?"not-allowed":"pointer",border:"1px solid",borderColor:r?"#10b981":a?"#ef4444":n?"#a855f7":i?"#06b6d4":"#4b5563",background:r?"rgba(16, 185, 129, 0.2)":a?"rgba(239, 68, 68, 0.2)":n?"rgba(168, 85, 247, 0.2)":i?"rgba(6, 182, 212, 0.1)":"rgba(75, 85, 99, 0.1)",opacity:a||s?.5:1},children:[(0,p.jsxs)("div",{style:{fontSize:"14px",fontWeight:"bold",color:r?"#10b981":a?"#ef4444":n?"#a855f7":"#e2e8f0",marginBottom:"4px"},children:[e,r&&" (Auto)",a&&" (Forbidden)",i&&" (Preferred)"]}),(0,p.jsx)("div",{style:{fontSize:"12px",color:"#94a3b8",lineHeight:"1.3"},children:t.description})]},e)})}),(0,p.jsx)("div",{style:{marginTop:"16px"},children:(0,p.jsxs)("div",{style:{fontSize:"14px",color:"#e2e8f0",marginBottom:"8px"},children:["Selected Traits (",o.length,"/",2,"): ",[...(null===d||void 0===d?void 0:d.automatic)||[],...o].join(", ")||"None"]})})]}),n.name&&(0,p.jsxs)("div",{style:{gridColumn:"1 / -1",background:"rgba(16, 185, 129, 0.1)",border:"1px solid rgba(16, 185, 129, 0.3)",borderRadius:"8px",padding:"20px"},children:[(0,p.jsx)("h4",{style:{margin:"0 0 16px 0",color:"#10b981",borderBottom:"2px solid #10b981",paddingBottom:"8px"},children:"\ud83c\udf1f Character Preview"}),(()=>{const e={STR:n.stats.strength,DEX:n.stats.dexterity,CON:n.stats.constitution,INT:n.stats.intelligence,WIS:n.stats.wisdom,CHA:n.stats.charisma},t=[...(null===d||void 0===d?void 0:d.automatic)||[],...o],r=tt(e,n.species,n.archetype,n.level,t);return(0,p.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"16px"},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("h5",{style:{color:"#e2e8f0",marginBottom:"12px"},children:"Basic Info"}),(0,p.jsxs)("div",{style:{fontSize:"14px",color:"#cbd5e1",lineHeight:"1.6"},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:n.name})," (",n.gender,")"]}),(0,p.jsxs)("div",{children:[n.species," ",n.archetype]}),(0,p.jsxs)("div",{children:["Level ",n.level," ",n.background]})]})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("h5",{style:{color:"#e2e8f0",marginBottom:"12px"},children:"Combat Stats"}),(0,p.jsxs)("div",{style:{fontSize:"14px",color:"#cbd5e1",lineHeight:"1.6"},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Hit Points:"})," ",r.hp]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Armor Class:"})," ",r.ac]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Carrying Capacity:"})," ",r.carry," lbs"]}),r.naturalACBonus>0&&(0,p.jsxs)("div",{style:{fontSize:"12px",opacity:.7},children:["+",r.naturalACBonus," natural AC bonus"]})]})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("h5",{style:{color:"#e2e8f0",marginBottom:"12px"},children:"Ability Scores"}),(0,p.jsxs)("div",{style:{fontSize:"14px",color:"#cbd5e1",lineHeight:"1.6",display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"4px"},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"STR:"})," ",e.STR," (",et(e.STR)>=0?"+":"",et(e.STR),")"]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"DEX:"})," ",e.DEX," (",et(e.DEX)>=0?"+":"",et(e.DEX),")"]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"CON:"})," ",e.CON," (",et(e.CON)>=0?"+":"",et(e.CON),")"]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"INT:"})," ",e.INT," (",et(e.INT)>=0?"+":"",et(e.INT),")"]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"WIS:"})," ",e.WIS," (",et(e.WIS)>=0?"+":"",et(e.WIS),")"]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"CHA:"})," ",e.CHA," (",et(e.CHA)>=0?"+":"",et(e.CHA),")"]})]})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("h5",{style:{color:"#e2e8f0",marginBottom:"12px"},children:"Traits"}),(0,p.jsx)("div",{style:{fontSize:"14px",color:"#cbd5e1",lineHeight:"1.6"},children:t.length>0?t.join(", "):"None"}),(0,p.jsxs)("div",{style:{fontSize:"12px",marginTop:"8px"},children:[(0,p.jsxs)("div",{style:{color:"#10b981"},children:["HP per level: +",r.totalHPPerLevel]}),(0,p.jsxs)("div",{style:{color:"#94a3b8"},children:["(Base: +",1+Math.max(0,et(e.CON)),", Class: +",r.classHPBonus,", Race: ",r.raceHPBonus>=0?"+":"",r.raceHPBonus,", Traits: ",r.traitHPBonus>=0?"+":"",r.traitHPBonus,")"]})]})]})]})})()]}),(0,p.jsx)("div",{style:{gridColumn:"1 / -1",display:"flex",justifyContent:"center",marginTop:"20px"},children:(0,p.jsxs)("button",{onClick:()=>{if(!n.name.trim())return void alert("Please enter a character name.");const e=t.addCharacter({name:n.name.trim(),gender:n.gender,species:n.species,archetype:n.archetype,background:n.background,level:n.level,experience:0,stats:n.stats,traits:n.traits});alert("".concat(e.name," has been added to your party!")),r({name:"",gender:"Female",species:"Human",archetype:"Fighter",background:"Commoner",level:1,stats:{strength:10,dexterity:10,constitution:10,intelligence:10,wisdom:10,charisma:10},traits:[]}),i(27)},disabled:!n.name.trim(),style:{padding:"16px 32px",background:n.name.trim()?"#059669":"#374151",color:"#f9fafb",border:"none",borderRadius:"8px",cursor:n.name.trim()?"pointer":"not-allowed",fontSize:"16px",fontWeight:"bold",transition:"all 0.2s"},children:["\ud83c\udf89 Create Character ",a>0?"(".concat(a," points remaining)"):""]})})]})}function ht(e){let{tile:t,x:n,y:r,size:a,isExplored:i}=e;if(!i)return(0,p.jsx)("div",{style:{position:"absolute",left:n*a,top:r*a,width:a,height:a,backgroundColor:"#1e293b",border:"1px solid #374151"}});const o={grass:"#16a34a",forest:"#065f46",water:"#0ea5e9",mountain:"#78716c",desert:"#eab308",snow:"#f8fafc",swamp:"#365314",road:"#a3a3a3",town:"#dc2626",dungeon:"#7c2d12",ruins:"#6b7280",cave:"#44403c",bridge:"#8b5cf6"}[t.type]||"#4b5563";return(0,p.jsxs)("div",{style:{position:"absolute",left:n*a,top:r*a,width:a,height:a,backgroundColor:o,border:"1px solid rgba(0, 0, 0, 0.2)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",color:"white",textShadow:"1px 1px 2px rgba(0, 0, 0, 0.8)"},title:"".concat(t.type," (").concat(n,", ").concat(r,")"),children:[t.features&&t.features.length>0&&(0,p.jsx)("span",{style:{fontSize:"10px"},children:t.features[0].charAt(0).toUpperCase()}),t.structure&&(0,p.jsx)("span",{style:{fontSize:"14px",fontWeight:"bold"},children:"settlement"===t.structure?"\ud83c\udfd8\ufe0f":"dungeon"===t.structure?"\ud83c\udff0":"ruins"===t.structure?"\ud83c\udfdb\ufe0f":"\u2b50"})]})}function pt(e){let{engine:t,showGrid:n,width:r,height:a,canvasRef:i}=e;const o=24,s=Math.floor(r/o),l=Math.floor(a/o),c=t.state.party.x,d=t.state.party.y,u=Math.floor(c-s/2),h=Math.floor(d-l/2),g=u+s,f=h+l,m=[];for(let b=h;b<f;b++)for(let e=u;e<g;e++){const n=t.getTile(e,b),r=t.isDiscovered(e,b);m.push((0,p.jsx)(ht,{tile:n,x:e-u,y:b-h,size:o,isExplored:r},"".concat(e,",").concat(b)))}const y=Math.floor(s/2),v=Math.floor(l/2);return(0,p.jsxs)("div",{style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",backgroundColor:"#0f172a"},children:[i&&(0,p.jsx)("canvas",{ref:i,width:r,height:a,style:{position:"absolute",top:0,left:0,pointerEvents:"none",zIndex:1}}),(0,p.jsx)("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"},children:m}),n&&(0,p.jsx)("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundImage:"\n            linear-gradient(to right, rgba(255, 255, 255, 0.1) 1px, transparent 1px),\n            linear-gradient(to bottom, rgba(255, 255, 255, 0.1) 1px, transparent 1px)\n          ",backgroundSize:"".concat(o,"px ").concat(o,"px"),pointerEvents:"none",zIndex:3}}),(0,p.jsx)("div",{style:{position:"absolute",left:y*o+12-8,top:v*o+12-8,width:16,height:16,backgroundColor:"#3b82f6",borderRadius:"50%",border:"2px solid white",zIndex:10,boxShadow:"0 0 8px rgba(59, 130, 246, 0.8)",animation:"pulse 2s infinite"}}),"Clear"!==t.state.weather.type&&(0,p.jsx)("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:(()=>{const e=t.state.weather.intensity;switch(t.state.weather.type){case"Rain":return"linear-gradient(45deg, transparent 30%, rgba(59, 130, 246, ".concat(.3*e,") 50%, transparent 70%)");case"Storm":return"linear-gradient(45deg, transparent 20%, rgba(59, 130, 246, ".concat(.5*e,") 40%, transparent 60%)");case"Snow":return"radial-gradient(circle, rgba(248, 250, 252, ".concat(.4*e,") 2px, transparent 3px)");case"Fog":return"rgba(156, 163, 175, ".concat(.6*e,")");case"Wind":return"linear-gradient(30deg, transparent 40%, rgba(234, 179, 8, ".concat(.2*e,") 60%, transparent 80%)");default:return"none"}})(),backgroundSize:"Snow"===t.state.weather.type?"20px 20px":"100% 100%",pointerEvents:"none",zIndex:5,animation:"Rain"===t.state.weather.type||"Storm"===t.state.weather.type?"rainFall 0.5s linear infinite":"Snow"===t.state.weather.type?"snowFall 3s linear infinite":"none"}}),(0,p.jsx)("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:(()=>{const e=Math.floor(t.state.time.minutes/60)%24;return e>=6&&e<18?"rgba(255, 255, 255, 0.1)":e>=18&&e<20||e>=5&&e<7?"rgba(234, 179, 8, 0.2)":"rgba(15, 23, 42, 0.6)"})(),pointerEvents:"none",zIndex:6}}),(0,p.jsx)("style",{children:"\n        @keyframes pulse {\n          0%, 100% { \n            box-shadow: 0 0 8px rgba(59, 130, 246, 0.8);\n          }\n          50% { \n            box-shadow: 0 0 16px rgba(59, 130, 246, 1);\n          }\n        }\n        \n        @keyframes rainFall {\n          0% { background-position: 0% 0%; }\n          100% { background-position: 100% 100%; }\n        }\n        \n        @keyframes snowFall {\n          0% { background-position: 0% 0%; }\n          100% { background-position: 20px 20px; }\n        }\n      "})]})}function gt(e){let{engine:t,showWorldGenModal:n,onCloseWorldGenModal:r,onWorldGenSubmit:a,showEncounterModal:i,onCloseEncounterModal:o,onEncounterAction:s,showCharacterModal:l,onCloseCharacterModal:c}=e;const d=t.getActiveEncounter();return(0,p.jsxs)(p.Fragment,{children:[n&&(0,p.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",backgroundColor:"rgba(0, 0, 0, 0.8)",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,p.jsxs)("div",{style:{backgroundColor:"#1f2937",color:"#f9fafb",padding:"32px",borderRadius:"12px",border:"2px solid #374151",maxWidth:"600px",width:"90%",maxHeight:"80vh",overflowY:"auto"},children:[(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[(0,p.jsx)("h2",{style:{margin:0,color:"#3b82f6"},children:"\ud83c\udf0d World Generation Settings"}),(0,p.jsx)("button",{onClick:r,style:{background:"transparent",border:"none",color:"#94a3b8",fontSize:"24px",cursor:"pointer"},children:"\xd7"})]}),(0,p.jsxs)("div",{style:{marginBottom:"24px"},children:[(0,p.jsx)("p",{style:{color:"#cbd5e1",marginBottom:"16px"},children:"Customize your world generation parameters. Changes will regenerate the entire world."}),(0,p.jsxs)("div",{style:{display:"grid",gap:"16px"},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{style:{display:"block",marginBottom:"8px",color:"#e2e8f0"},children:"Sea Level (0.0 = No Ocean, 1.0 = All Ocean)"}),(0,p.jsx)("input",{type:"range",min:"0",max:"1",step:"0.1",defaultValue:t.state.config.world.seaLevel,style:{width:"100%"}})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{style:{display:"block",marginBottom:"8px",color:"#e2e8f0"},children:"Continent Frequency (Lower = Larger Continents)"}),(0,p.jsx)("input",{type:"range",min:"0.0001",max:"0.01",step:"0.0001",defaultValue:t.state.config.world.continentFreq,style:{width:"100%"}})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{style:{display:"block",marginBottom:"8px",color:"#e2e8f0"},children:"Feature Frequency (Lower = Larger Features)"}),(0,p.jsx)("input",{type:"range",min:"0.001",max:"0.1",step:"0.001",defaultValue:t.state.config.world.featureFreq,style:{width:"100%"}})]})]})]}),(0,p.jsxs)("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[(0,p.jsx)("button",{onClick:r,style:{padding:"12px 24px",background:"#6b7280",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:"Cancel"}),(0,p.jsx)("button",{onClick:()=>{a({}),r()},style:{padding:"12px 24px",background:"#3b82f6",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:"Apply Changes"})]})]})}),i&&d&&(0,p.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",backgroundColor:"rgba(0, 0, 0, 0.9)",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,p.jsxs)("div",{style:{backgroundColor:"#1f2937",color:"#f9fafb",padding:"32px",borderRadius:"12px",border:"3px solid ".concat("extreme"===d.danger?"#dc2626":"high"===d.danger?"#ea580c":"medium"===d.danger?"#eab308":"low"===d.danger?"#65a30d":"#059669"),maxWidth:"700px",width:"90%",maxHeight:"80vh",overflowY:"auto",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.8)"},children:[(0,p.jsxs)("div",{style:{textAlign:"center",marginBottom:"24px"},children:[(0,p.jsx)("div",{style:{fontSize:"48px",marginBottom:"16px",filter:"drop-shadow(0 4px 8px rgba(0, 0, 0, 0.8))"},children:"combat"===d.type?"\u2694\ufe0f":"discovery"===d.type?"\ud83d\uddfa\ufe0f":"trader"===d.type?"\ud83c\udfea":"event"===d.type?"\ud83d\udcdc":"\u2753"}),(0,p.jsx)("h2",{style:{margin:"0 0 8px 0",color:"#f1f5f9",fontSize:"28px",textShadow:"2px 2px 4px rgba(0, 0, 0, 0.8)"},children:d.name}),(0,p.jsxs)("div",{style:{display:"inline-block",padding:"4px 12px",borderRadius:"20px",fontSize:"12px",fontWeight:"bold",backgroundColor:"extreme"===d.danger?"rgba(220, 38, 38, 0.3)":"high"===d.danger?"rgba(234, 88, 12, 0.3)":"medium"===d.danger?"rgba(234, 179, 8, 0.3)":"low"===d.danger?"rgba(101, 163, 13, 0.3)":"rgba(5, 150, 105, 0.3)",color:"extreme"===d.danger?"#fca5a5":"high"===d.danger?"#fdba74":"medium"===d.danger?"#fde047":"low"===d.danger?"#a3e635":"#6ee7b7",border:"1px solid ".concat("extreme"===d.danger?"#dc2626":"high"===d.danger?"#ea580c":"medium"===d.danger?"#eab308":"low"===d.danger?"#65a30d":"#059669")},children:[d.danger.toUpperCase()," RISK"]})]}),(0,p.jsx)("div",{style:{backgroundColor:"rgba(0, 0, 0, 0.3)",padding:"20px",borderRadius:"8px",marginBottom:"24px",border:"1px solid rgba(75, 85, 99, 0.5)"},children:(0,p.jsx)("p",{style:{margin:0,fontSize:"16px",lineHeight:"1.6",color:"#e2e8f0"},children:d.description})}),d.rewards&&(0,p.jsxs)("div",{style:{marginBottom:"24px"},children:[(0,p.jsx)("h4",{style:{margin:"0 0 12px 0",color:"#fbbf24"},children:"\ud83d\udcb0 Potential Rewards"}),(0,p.jsxs)("div",{style:{fontSize:"14px",color:"#cbd5e1",backgroundColor:"rgba(251, 191, 36, 0.1)",padding:"12px",borderRadius:"6px",border:"1px solid rgba(251, 191, 36, 0.3)"},children:[d.rewards.experience&&(0,p.jsxs)("div",{children:["\ud83c\udf93 Experience: ",d.rewards.experience]}),d.rewards.gold&&(0,p.jsxs)("div",{children:["\ud83d\udcb0 Gold: ",d.rewards.gold]}),d.rewards.items&&d.rewards.items.length>0&&(0,p.jsxs)("div",{children:["\ud83c\udf92 Items: ",d.rewards.items.join(", ")]})]})]}),(0,p.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:"12px"},children:["combat"===d.type&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("button",{onClick:()=>s("fight"),style:{padding:"12px 16px",background:"linear-gradient(135deg, #dc2626 0%, #991b1b 100%)",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"bold",boxShadow:"0 4px 8px rgba(220, 38, 38, 0.3)"},children:"\u2694\ufe0f Fight"}),(0,p.jsx)("button",{onClick:()=>s("flee"),style:{padding:"12px 16px",background:"linear-gradient(135deg, #eab308 0%, #ca8a04 100%)",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"bold",boxShadow:"0 4px 8px rgba(234, 179, 8, 0.3)"},children:"\ud83c\udfc3 Flee"})]}),("trader"===d.type||"event"===d.type)&&(0,p.jsx)("button",{onClick:()=>s("negotiate"),style:{padding:"12px 16px",background:"linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"bold",boxShadow:"0 4px 8px rgba(59, 130, 246, 0.3)"},children:"\ud83d\udcac Interact"}),"discovery"===d.type&&(0,p.jsx)("button",{onClick:()=>s("explore"),style:{padding:"12px 16px",background:"linear-gradient(135deg, #059669 0%, #047857 100%)",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"bold",boxShadow:"0 4px 8px rgba(5, 150, 105, 0.3)"},children:"\ud83d\udd0d Explore"}),(0,p.jsx)("button",{onClick:o,style:{padding:"12px 16px",background:"linear-gradient(135deg, #6b7280 0%, #4b5563 100%)",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"bold",boxShadow:"0 4px 8px rgba(107, 114, 128, 0.3)"},children:"\ud83d\udeaa Dismiss"})]})]})}),l&&(0,p.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",backgroundColor:"rgba(0, 0, 0, 0.8)",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,p.jsxs)("div",{style:{backgroundColor:"#1f2937",color:"#f9fafb",padding:"32px",borderRadius:"12px",border:"2px solid #374151",maxWidth:"900px",width:"95%",maxHeight:"85vh",overflowY:"auto"},children:[(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[(0,p.jsx)("h2",{style:{margin:0,color:"#3b82f6"},children:"\ufffd Party Characters"}),(0,p.jsx)("button",{onClick:c,style:{background:"transparent",border:"none",color:"#94a3b8",fontSize:"24px",cursor:"pointer"},children:"\xd7"})]}),(0,p.jsx)(ft,{engine:t})]})})]})}function ft(e){let{engine:t}=e;const n=t.getPartyCharacters();return 0===n.length?(0,p.jsxs)("div",{style:{padding:"32px",textAlign:"center",background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.3)",borderRadius:"8px",color:"#fca5a5"},children:[(0,p.jsx)("h3",{style:{margin:"0 0 16px 0"},children:"\u26a0\ufe0f No Characters in Party"}),(0,p.jsx)("p",{style:{margin:0,fontSize:"14px"},children:"Add characters to your party to view their information and manage their abilities."})]}):(0,p.jsx)("div",{style:{display:"grid",gap:"20px"},children:n.map((e,t)=>(0,p.jsxs)("div",{style:{background:"rgba(59, 130, 246, 0.1)",border:"1px solid rgba(59, 130, 246, 0.3)",borderRadius:"8px",padding:"20px"},children:[(0,p.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"auto 1fr auto",gap:"20px",alignItems:"start"},children:[(0,p.jsx)("div",{style:{width:"64px",height:"64px",background:"rgba(99, 102, 241, 0.2)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"32px"},children:"\ud83d\udc64"}),(0,p.jsxs)("div",{children:[(0,p.jsx)("h3",{style:{margin:"0 0 8px 0",color:"#60a5fa"},children:e.name}),(0,p.jsxs)("div",{style:{fontSize:"14px",color:"#cbd5e1",marginBottom:"12px"},children:["Level ",e.level," ",e.species," ",e.archetype," \u2022 ",e.gender]}),(0,p.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"12px",marginBottom:"16px"},children:[(0,p.jsxs)("div",{style:{fontSize:"12px"},children:[(0,p.jsx)("div",{style:{color:"#94a3b8"},children:"Health"}),(0,p.jsxs)("div",{style:{color:"#4ade80",fontWeight:"bold"},children:[e.hitPoints,"/",e.maxHitPoints]})]}),(0,p.jsxs)("div",{style:{fontSize:"12px"},children:[(0,p.jsx)("div",{style:{color:"#94a3b8"},children:"Stamina"}),(0,p.jsxs)("div",{style:{color:"#facc15",fontWeight:"bold"},children:[e.stamina,"/",e.maxStamina]})]}),(0,p.jsxs)("div",{style:{fontSize:"12px"},children:[(0,p.jsx)("div",{style:{color:"#94a3b8"},children:"Ether"}),(0,p.jsxs)("div",{style:{color:"#8b5cf6",fontWeight:"bold"},children:[e.ether,"/",e.maxEther]})]})]}),(0,p.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(6, 1fr)",gap:"8px",fontSize:"11px"},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("span",{style:{color:"#94a3b8"},children:"STR:"})," ",e.stats.strength]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("span",{style:{color:"#94a3b8"},children:"DEX:"})," ",e.stats.dexterity]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("span",{style:{color:"#94a3b8"},children:"CON:"})," ",e.stats.constitution]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("span",{style:{color:"#94a3b8"},children:"INT:"})," ",e.stats.intelligence]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("span",{style:{color:"#94a3b8"},children:"WIS:"})," ",e.stats.wisdom]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("span",{style:{color:"#94a3b8"},children:"CHA:"})," ",e.stats.charisma]})]})]}),(0,p.jsxs)("div",{style:{minWidth:"120px"},children:[(0,p.jsxs)("div",{style:{fontSize:"12px",color:"#94a3b8",marginBottom:"4px"},children:["XP: ",e.experience]}),(0,p.jsx)("div",{style:{width:"100%",height:"8px",background:"rgba(75, 85, 99, 0.5)",borderRadius:"4px",overflow:"hidden"},children:(0,p.jsx)("div",{style:{width:"".concat(e.experience%100,"%"),height:"100%",background:"linear-gradient(90deg, #3b82f6, #60a5fa)",borderRadius:"4px"}})})]})]}),(0,p.jsxs)("div",{style:{marginTop:"16px",display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[(0,p.jsxs)("div",{children:[(0,p.jsxs)("h4",{style:{margin:"0 0 8px 0",color:"#4ade80",fontSize:"14px"},children:["\u2694\ufe0f Abilities (",e.knownAbilities.length,")"]}),(0,p.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:"4px"},children:[e.knownAbilities.length>0?e.knownAbilities.slice(0,3).map((e,t)=>(0,p.jsx)("div",{style:{padding:"2px 6px",background:"rgba(34, 197, 94, 0.2)",borderRadius:"4px",fontSize:"10px",color:"#4ade80"},children:e},t)):(0,p.jsx)("div",{style:{fontSize:"10px",color:"#6b7280",fontStyle:"italic"},children:"None learned"}),e.knownAbilities.length>3&&(0,p.jsxs)("div",{style:{fontSize:"10px",color:"#6b7280"},children:["+",e.knownAbilities.length-3," more"]})]})]}),(0,p.jsxs)("div",{children:[(0,p.jsxs)("h4",{style:{margin:"0 0 8px 0",color:"#8b5cf6",fontSize:"14px"},children:["\u2728 Spells (",e.knownSpells.length,")"]}),(0,p.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:"4px"},children:[e.knownSpells.length>0?e.knownSpells.slice(0,3).map((e,t)=>(0,p.jsx)("div",{style:{padding:"2px 6px",background:"rgba(139, 92, 246, 0.2)",borderRadius:"4px",fontSize:"10px",color:"#8b5cf6"},children:e},t)):(0,p.jsx)("div",{style:{fontSize:"10px",color:"#6b7280",fontStyle:"italic"},children:"None learned"}),e.knownSpells.length>3&&(0,p.jsxs)("div",{style:{fontSize:"10px",color:"#6b7280"},children:["+",e.knownSpells.length-3," more"]})]})]})]})]},e.id))})}function mt(e){let{seedStr:t="world-001",onBack:n}=e;const r=(0,l.useCallback)(e=>({chunks:e.chunks,discovered:e.discovered,timeOfDay:"number"===typeof e.timeOfDay?e.timeOfDay<.25?"Night":e.timeOfDay<.5?"Morning":e.timeOfDay<.75?"Day":"Evening":e.timeOfDay,gameTime:e.gameTime}),[]),[a]=(0,l.useState)(()=>(console.log("\ud83d\ude80 Creating WorldEngine with seed:",t),new Ve(t))),[,i]=l.useReducer(e=>e+1,0),[o,s]=(0,l.useState)(!1),[c,d]=(0,l.useState)(!0),[u,h]=(0,l.useState)(()=>r(a.getStats())),[g,f]=(0,l.useState)(!1),[m,y]=(0,l.useState)(!1),[v,b]=(0,l.useState)(!1),[x,w]=(0,l.useState)(!1),[S,k]=(0,l.useState)({width:800,height:600});(0,l.useEffect)(()=>{const e=setInterval(()=>{h(r(a.getStats()))},1e3);return()=>clearInterval(e)},[a,r]),(0,l.useEffect)(()=>{a.wasLoadedFromSave()&&(console.log("Engine was loaded from save, updating React state..."),h(r(a.getStats())),i())},[a,r]),(0,l.useEffect)(()=>{a.getActiveEncounter()&&!m&&y(!0)},[a,m]),(0,l.useEffect)(()=>{const e=()=>{const e=document.querySelector(".world-container");e&&k({width:e.clientWidth,height:e.clientHeight})};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const C=(0,l.useCallback)((e,t)=>{a.tickTravel(e,t)&&h(r(a.getStats()))},[a,r]),j=(0,l.useCallback)(e=>{a.rest(e),h(r(a.getStats())),console.log("\ud83d\udca4 Rested ".concat(e,"h. HP: ").concat(a.state.party.hitPoints,"/").concat(a.state.party.maxHitPoints))},[a,r]);(0,l.useEffect)(()=>{const e=e=>{if(!(e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement||g||m||v||x))switch(e.key.toLowerCase()){case"w":case"arrowup":e.preventDefault(),C(0,-1);break;case"s":case"arrowdown":e.preventDefault(),C(0,1);break;case"a":case"arrowleft":e.preventDefault(),C(-1,0);break;case"d":case"arrowright":e.preventDefault(),C(1,0);break;case"q":e.preventDefault(),C(-1,-1);break;case"e":e.preventDefault(),C(1,-1);break;case"z":e.preventDefault(),C(-1,1);break;case"c":e.preventDefault(),C(1,1);break;case"r":e.preventDefault(),j(e.shiftKey?8:1);break;case"m":e.preventDefault(),f(!g);break;case"i":case"tab":e.preventDefault(),b(!v);break;case"g":e.preventDefault(),s(!o);break;case"l":e.preventDefault(),d(!c);break;case"escape":e.preventDefault(),g?f(!1):m?y(!1):v?b(!1):x&&w(!1)}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[C,j,g,m,v,x,o,c]);const T=(0,l.useCallback)(e=>{if(!a.getActiveEncounter())return;let t=!0;switch(e){case"fight":t=Math.random()>.3;break;case"flee":t=Math.random()>.2;break;case"negotiate":t=Math.random()>.4;break;case"explore":t=!0}a.completeEncounter(t),y(!1),h(r(a.getStats())),console.log("\ud83c\udfad Encounter: ".concat(e," -> ").concat(t?"Success!":"Failed!"))},[a,r]),E=(0,l.useCallback)(e=>{Object.keys(e).length>0&&(a.updateWorldConfig(e),h(r(a.getStats())),console.log("\ud83c\udf0d World config updated"))},[a,r]);return console.log("\ud83c\udfae Rendering WorldMapEngine with modular components"),(0,p.jsxs)("div",{style:{width:"100vw",height:"100vh",position:"relative",backgroundColor:"#0f172a",overflow:"hidden",fontFamily:"monospace"},children:[(0,p.jsx)("div",{className:"world-container",style:{width:"100%",height:"100%",position:"relative"},children:(0,p.jsx)(pt,{engine:a,showGrid:o,width:S.width,height:S.height})}),(0,p.jsx)(Ye,{engine:a,stats:u,onBack:n,cameraLocked:c,onCenterParty:()=>console.log("\ud83c\udfaf Center camera on party")}),(0,p.jsx)(st,{engine:a,isVisible:g,onClose:()=>f(!1),showGrid:o,onToggleGrid:()=>s(!o),cameraLocked:c,onToggleCameraLock:()=>d(!c),onRefresh:()=>{i(),h(r(a.getStats()))},stats:u}),(0,p.jsx)(gt,{engine:a,showWorldGenModal:x,onCloseWorldGenModal:()=>w(!1),onWorldGenSubmit:E,showEncounterModal:m,onCloseEncounterModal:()=>{a.dismissEncounter(),y(!1)},onEncounterAction:T,showCharacterModal:v,onCloseCharacterModal:()=>b(!1)}),(0,p.jsxs)("div",{style:{position:"absolute",bottom:"20px",left:"20px",backgroundColor:"rgba(0, 0, 0, 0.8)",color:"#e2e8f0",padding:"12px",borderRadius:"6px",fontSize:"11px",lineHeight:"1.4",maxWidth:"300px",border:"1px solid rgba(75, 85, 99, 0.5)"},children:[(0,p.jsx)("div",{style:{fontWeight:"bold",marginBottom:"8px",color:"#3b82f6"},children:"\ud83c\udfae Controls"}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Move:"})," WASD / Arrow Keys"]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Rest:"})," R (1hr) / Shift+R (8hr)"]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Menu:"})," M \u2022 ",(0,p.jsx)("strong",{children:"Character:"})," I/Tab"]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Grid:"})," G \u2022 ",(0,p.jsx)("strong",{children:"Camera:"})," L"]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Close:"})," ESC"]})]}),!1]})}const yt=()=>{const e=P(),t=L();return(0,p.jsxs)("div",{className:"p-8 max-w-6xl mx-auto",children:[(0,p.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Simple Portrait System Test"}),(0,p.jsxs)("div",{className:"mb-8",children:[(0,p.jsx)("button",{onClick:async()=>{console.log("\ud83c\udfad Testing simple portrait system...");const e=await R();console.log("Test result:",e)},className:"bg-blue-500 text-white px-4 py-2 rounded mr-4 hover:bg-blue-600",children:"Test Single Portrait"}),(0,p.jsx)("button",{onClick:async()=>{console.log("\ud83c\udfad Testing multiple combinations...");const e=await A();console.log("All results:",e)},className:"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600",children:"Test Multiple Combinations"})]}),(0,p.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[{gender:"male",species:"human",archetype:"greenwarden"},{gender:"female",species:"sylvanborn",archetype:"thornknight"},{gender:"male",species:"draketh",archetype:"ashblade"},{gender:"female",species:"voidkin",archetype:"voidwing"},{gender:"male",species:"crystalborn",archetype:"skyknight"},{gender:"female",species:"alloy",archetype:"cindermystic"}].map((e,t)=>(0,p.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,p.jsxs)("h3",{className:"font-semibold mb-2 capitalize",children:[e.gender," ",e.species," ",e.archetype]}),(0,p.jsx)(f,{gender:e.gender,species:e.species,archetype:e.archetype,size:"medium",showDebug:!0})]},t))}),(0,p.jsxs)("div",{className:"mt-8 grid grid-cols-2 gap-8",children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Available Species"}),(0,p.jsx)("ul",{className:"list-disc list-inside space-y-1",children:e.map(e=>(0,p.jsx)("li",{className:"capitalize",children:e},e))})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Available Archetypes"}),(0,p.jsx)("ul",{className:"list-disc list-inside space-y-1",children:t.map(e=>(0,p.jsx)("li",{className:"capitalize",children:e},e))})]})]})]})};function vt(){var e,t;const[n,r]=l.useState("menu"),[a,i]=l.useState([]),[o,c]=l.useState(null),[,d]=l.useReducer(e=>e+1,0);l.useEffect(()=>{const e=sessionStorage.getItem("world-engine-emergency-save");if(e)try{const t=JSON.parse(e);console.log("Found emergency save, attempting recovery...");const n=JSON.parse(localStorage.getItem("world-engine-campaigns")||"[]"),r=n.findIndex(e=>e.id===t.id);r>=0?n[r]=t:n.push(t),localStorage.setItem("world-engine-campaigns",JSON.stringify(n)),sessionStorage.removeItem("world-engine-emergency-save"),alert("\ud83d\udea8 Emergency save recovered from previous session!")}catch(n){console.error("Failed to recover emergency save:",n)}const t=setInterval(()=>{try{const e=JSON.parse(localStorage.getItem("world-engine-campaigns")||"[]");e.length>0&&(sessionStorage.setItem("world-engine-campaigns-session",JSON.stringify(e)),console.log("Periodic session backup completed"))}catch(n){console.error("Periodic backup failed:",n)}},3e5);return()=>clearInterval(t)},[]);const u=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"world-engine-campaigns-backup";try{const n={campaigns:e,exportDate:(new Date).toISOString(),version:"2.0",worldEngineVersion:"v1.0.0"},r=JSON.stringify(n,null,2),a=new Blob([r],{type:"application/json"}),i=URL.createObjectURL(a),o=document.createElement("a");o.href=i,o.download="".concat(t,"-").concat((new Date).toISOString().split("T")[0],".json"),document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i),console.log("Campaign backup downloaded")}catch(n){console.error("Error downloading backup:",n)}},h={state:{meta:{seed:"undefined"!==typeof window&&window.localStorage.getItem("world-seed")||void 0,presets:{list:[],loaded:"undefined"!==typeof window&&window.localStorage.getItem("world-preset")||void 0}}},applyPresetByName:e=>{console.log("applyPresetByName",e),h.state=s(s({},h.state),{},{meta:s(s({},h.state.meta),{},{presets:s(s({},h.state.meta.presets),{},{loaded:e})})});try{window.localStorage.setItem("world-preset",e)}catch(t){}d()},setSeed:e=>{console.log("setSeed",e),h.state=s(s({},h.state),{},{meta:s(s({},h.state.meta),{},{seed:e})});try{window.localStorage.setItem("world-seed",e)}catch(t){}d()},loadWorldPresets:async function(){console.log("loadWorldPresets called");const e="worlds.json";try{console.log("Fetching",e,"...");const t=await fetch(e,{cache:"no-store"});if(console.log("Fetch response:",t.status,t.statusText),!t.ok)throw new Error("HTTP ".concat(t.status));const n=await t.json();console.log("Raw JSON data:",n);const r=n&&Array.isArray(n.list)?n.list:[];h.state=s(s({},h.state),{},{meta:s(s({},h.state.meta),{},{presets:{list:r,loaded:h.state.meta.presets.loaded}})}),console.log("World presets loaded:",r.map(e=>e.name)),d()}catch(t){console.error("Failed to load world presets from",e,":",t),h.state=s(s({},h.state),{},{meta:s(s({},h.state.meta),{},{presets:{list:W,loaded:h.state.meta.presets.loaded}})}),console.warn("Using DEFAULT_WORLDS fallback (",W.length,")"),d()}}};return(0,p.jsxs)(p.Fragment,{children:["menu"===n&&(0,p.jsx)(N,{onNewCampaign:()=>{const e={id:"campaign-".concat(Date.now()),name:"Campaign ".concat(Date.now().toString().slice(-4)),worldPreset:"",seed:"",characters:[]};c(e),r("world")},onLoadCampaign:e=>{var t,n;(c(e),e.worldPreset)&&(null===(t=h.applyPresetByName)||void 0===t||t.call(h,e.worldPreset));e.seed&&(null===(n=h.setSeed)||void 0===n||n.call(h,e.seed));r("worldmap")},onNameGenerator:()=>{r("namegen")},onSpellGenerator:()=>{r("spellgen")},onSpellAssignment:()=>{r("spellassign")},onHealingSystem:()=>{r("healing")},onCharacterCreate:()=>{r("charactercreate")},onPortraitTest:()=>{r("portraittest")}}),"world"===n&&(0,p.jsx)(B,{eng:h,onNext:()=>{if(o){var e,t,n,a,i;const r=s(s({},o),{},{worldPreset:(null===h||void 0===h||null===(e=h.state)||void 0===e||null===(t=e.meta)||void 0===t||null===(n=t.presets)||void 0===n?void 0:n.loaded)||"",seed:(null===h||void 0===h||null===(a=h.state)||void 0===a||null===(i=a.meta)||void 0===i?void 0:i.seed)||""});c(r),(e=>{try{const t=(new Date).toISOString(),n=JSON.parse(localStorage.getItem("world-engine-campaigns")||"[]"),r=n.findIndex(t=>t.id===e.id),a=s(s({},e),{},{lastPlayed:t,saveVersion:"2.0"},r<0&&{createdAt:t});r>=0?n[r]=a:n.push(a),localStorage.setItem("world-engine-campaigns",JSON.stringify(n)),localStorage.setItem("world-engine-campaigns-backup",JSON.stringify({campaigns:n,backupTime:t,version:"2.0"})),sessionStorage.setItem("world-engine-campaigns-session",JSON.stringify(n)),localStorage.setItem("world-engine-campaign-".concat(e.id),JSON.stringify(a));const i=parseInt(localStorage.getItem("world-engine-save-count")||"0")+1;localStorage.setItem("world-engine-save-count",i.toString()),i%10===0&&u(n,"auto-backup-".concat(i)),console.log("Campaign saved with ".concat(n.length," total campaigns (save #").concat(i,")"))}catch(t){console.error("Error saving campaign:",t);try{sessionStorage.setItem("world-engine-emergency-save",JSON.stringify(e)),alert("Primary save failed, but emergency backup created. Please export your campaign manually.")}catch(n){console.error("Emergency save also failed:",n),alert("Critical: All save attempts failed. Please export your campaign data immediately.")}}})(r)}r("party")}}),"party"===n&&(0,p.jsx)(O,{eng:h,party:a,setParty:i,onStart:()=>r("worldmap"),onCreateNew:()=>r("worldmap")}),"namegen"===n&&(0,p.jsx)(Se,{onBack:()=>r("menu")}),"spellgen"===n&&(0,p.jsx)(Re,{onBack:()=>r("menu")}),"spellassign"===n&&(0,p.jsx)(Ae,{onBack:()=>r("menu")}),"healing"===n&&(0,p.jsx)(Ne,{onBack:()=>r("menu")}),"worldmap"===n&&(0,p.jsx)(mt,{seedStr:null===h||void 0===h||null===(e=h.state)||void 0===e||null===(t=e.meta)||void 0===t?void 0:t.seed,onBack:()=>r("menu")}),"charactercreate"===n&&(0,p.jsxs)("div",{style:{position:"relative"},children:[(0,p.jsx)("button",{onClick:()=>r("menu"),style:{position:"absolute",top:"20px",left:"20px",zIndex:1e3,background:"#374151",color:"#f8fafc",border:"none",borderRadius:"8px",padding:"10px 15px",cursor:"pointer",fontSize:"14px",fontWeight:"bold"},children:"\u2190 Back to Menu"}),(0,p.jsx)(fe,{})]}),"portraittest"===n&&(0,p.jsxs)("div",{style:{position:"relative"},children:[(0,p.jsx)("button",{onClick:()=>r("menu"),style:{position:"absolute",top:"20px",left:"20px",zIndex:1e3,background:"#374151",color:"#f8fafc",border:"none",borderRadius:"8px",padding:"10px 15px",cursor:"pointer",fontSize:"14px",fontWeight:"bold"},children:"\u2190 Back to Menu"}),(0,p.jsx)(yt,{})]})]})}(0,c.H)(document.getElementById("root")).render((0,p.jsx)(vt,{}))})();
//# sourceMappingURL=main.8ea19e8b.js.map